"use strict";(self.webpackChunkAVPlayer=self.webpackChunkAVPlayer||[]).push([[99],{50848:(t,e,a)=>{a.d(e,{A:()=>I});var i=a(134),s=a(63939),r=a(50932),n=a(77162),o=a(29170),c=a(64436),h=a(14686),d=a(4624),l=a(9705),f=a(77231),p=a(58469),u=a(44328),g=a(37837),A=a(71517),m=a(67672);class I extends c.A{constructor(...t){super(...t),(0,i.A)(this,"streamMuxConfig",void 0),(0,i.A)(this,"caches",void 0)}init(t,e){return super.init(t,e),this.caches=[],this.streamMuxConfig={profile:f.N_,sampleRate:f.N_,channels:f.N_},0}sendAVPacket(t){let e=0,a=s.f[17](t+16)||s.f[17](t+8);const i=(0,h.s3)(s.f[20](t+24),s.f[15](t+28)).slice();for(;e<i.length;){const t=p.Bq(i.subarray(e));if(m.ai(t))return d.z3("AACADTSParser parse failed","src\\avformat\\bsf\\aac\\ADTS2RawFilter.ts",81),l.LR;const c={dts:a,buffer:null,extradata:null,duration:f.N_};c.buffer=i.subarray(e+t.headerLength,e+t.headerLength+t.framePayloadLength),this.streamMuxConfig.profile=t.profile,this.streamMuxConfig.sampleRate=t.sampleRate,this.streamMuxConfig.channels=t.channels;const A=s.f[15](this.inCodecpar+48)!==this.streamMuxConfig.profile||s.f[15](this.inCodecpar+136)!==this.streamMuxConfig.sampleRate||s.f[15](this.inCodecpar+116)!==this.streamMuxConfig.channels,I=(0,u.k)(BigInt(Math.floor(1024*(t.numberOfRawDataBlocksInFrame+1)/this.streamMuxConfig.sampleRate*f.SF)),f.KR,this.inTimeBase);if(c.duration=Number(I),A){r.M[15](this.inCodecpar+48,this.streamMuxConfig.profile),r.M[15](this.inCodecpar+136,this.streamMuxConfig.sampleRate),r.M[15](this.inCodecpar+116,this.streamMuxConfig.channels);const t=(0,p.Ij)((0,o.A)(this.inCodecpar,n.A));s.f[20](this.inCodecpar+12)&&(0,g.Eb)(s.f[20](this.inCodecpar+12)),r.M[20](this.inCodecpar+12,(0,g.sY)(t.length)),(0,h.lW)(s.f[20](this.inCodecpar+12),t.length,t),r.M[15](this.inCodecpar+16,t.length),c.extradata=t}this.caches.push(c),e+=t.aacFrameLength,a+=I}return 0}receiveAVPacket(t){if(this.caches.length){(0,A.Up)(t);const e=this.caches.shift(),a=(0,g.sY)(e.buffer.length);if((0,h.lW)(a,e.buffer.length,e.buffer),(0,A.NX)(t,a,e.buffer.length),r.M[17](t+16,e.dts),r.M[17](t+8,e.dts),r.M[17](t+48,BigInt(Math.floor(e.duration))),r.M[15](t+36,1|s.f[15](t+36)),e.extradata){const a=(0,g.sY)(e.extradata.length);(0,h.lW)(a,e.extradata.length,e.extradata),(0,A.Ow)(t,1,a,e.extradata.length)}return 0}return l.LT}reset(){return 0}}},29347:(t,e,a)=>{a.d(e,{R:()=>h,u:()=>c});var i=a(37246),s=a(95073);const r=[1,2,2,2,2,3,3,4,4,5,6,6,6,7,8,8],n=[0,8e3,16e3,32e3,0,0,11025,22050,44100,0,0,12e3,24e3,48e3,96e3,192e3],o=[32e3,56e3,64e3,96e3,112e3,128e3,192e3,224e3,256e3,32e4,384e3,448e3,512e3,576e3,64e4,768e3,96e4,1024e3,1152e3,128e4,1344e3,1408e3,1411200,1472e3,1536e3,192e4,2048e3,3072e3,384e4,0,0,0],c=32;function h(t){const e=new i.A(t.length);e.appendBuffer(t);const a={syncWord:0,frameType:0,deficitSamples:0,crcFlag:0,sampleBlock:0,frameSize:0,channelIndex:0,sampleRateIndex:0,bitrateIndex:0,channels:0,sampleRate:0,bitrate:0};return a.syncWord=e.readU(32),2147385345!==a.syncWord&&4269736320!==a.syncWord?-1:(a.frameType=e.readU1(),a.deficitSamples=e.readU(5)+1,a.crcFlag=e.readU1(),a.sampleBlock=e.readU(7)+1,a.frameSize=(0,s.A)(e.readU(14)+1,4),a.channelIndex=e.readU(6),a.sampleRateIndex=e.readU(4),a.bitrateIndex=e.readU(5),a.channels=r[a.channelIndex],a.sampleRate=n[a.sampleRateIndex],a.bitrate=o[a.bitrateIndex],a)}},65451:(t,e,a)=>{a.d(e,{Ij:()=>h,XC:()=>c,kt:()=>o});var i=a(31865),s=a(729),r=a(44328);const n=[480,960,1920,2880,480,960,1920,2880,480,960,1920,2880,480,960,480,960,120,240,480,960,120,240,480,960,120,240,480,960,120,240,480,960];function o(t){let e=0,a=0,i=0;if(t.length<1)return 0;switch(e=t[0],a=n[e>>3],3&e){case 0:i=1;break;case 1:case 2:i=2;break;case 3:if(t.length<2)return 0;i=63&t[1]}return i*a}function c(t,e){if(!e&&t.sideData[1]&&(e=t.sideData[1]),e&&e.length>=19){const a=new i.A(e,!1);a.skip(9),t.codecpar.chLayout.nbChannels=a.readUint8(),t.codecpar.initialPadding=a.readUint16(),t.codecpar.sampleRate=a.readUint32(),t.codecpar.seekPreroll=Number((0,r.k)(BigInt(80),{den:1e3,num:1},{den:48e3,num:1}))}}function h(t){const e=new Uint8Array(19),a=new s.A(e,!1);return a.writeString("OpusHead"),a.writeUint8(1),a.writeUint8(t.chLayout.nbChannels),a.writeUint16(t.initialPadding),a.writeUint32(t.sampleRate),e}},85947:(t,e,a)=>{a.d(e,{A:()=>s});var i=a(134);class s{constructor(){(0,i.A)(this,"type",-1),(0,i.A)(this,"onStreamAdd",void 0)}destroy(t){}}},51660:(t,e,a)=>{a.d(e,{A:()=>o});var i=a(77231),s=a(4624),r=a(9705),n="src\\avformat\\formats\\mpegts\\function\\parsePES.ts";function o(t){const e=t.data,a=e[3],o=e[4]<<8|e[5];let c=0,h=0,d=0;if(188!==a&&190!==a&&191!==a&&240!==a&&241!==a&&255!==a&&242!==a&&248!==a){let a=i.Dh,l=i.Dh;for(;;){if(6+h>=e.length)return;if(d=e[6+h],255!==d)break;h++}if(64==(192&d)&&(h+=2,d=e[6+h]),32==(224&d))c+=5,a=a=BigInt(Math.floor(536870912*(14&e[6+h])+4194304*(255&e[7+h])+16384*(254&e[8+h])+128*(255&e[9+h])+(254&e[10+h])/2)),16&d?(l=BigInt(Math.floor(536870912*(14&e[11+h])+4194304*(255&e[12+h])+16384*(254&e[13+h])+128*(255&e[14+h])+(254&e[15+h])/2)),c+=5):l=a;else if(128==(192&d)){const t=(192&e[7+h])>>>6;c=3+e[8+h],2!==t&&3!==t||(a=BigInt(Math.floor(536870912*(14&e[9+h])+4194304*(255&e[10+h])+16384*(254&e[11+h])+128*(255&e[12+h])+(254&e[13+h])/2)),l=3===t?BigInt(Math.floor(536870912*(14&e[14+h])+4194304*(255&e[15+h])+16384*(254&e[16+h])+128*(255&e[17+h])+(254&e[18+h])/2)):a)}else{if(15!==d)return s.z3("invalid data",n,121),r.LR;c=1}t.dts=l,t.pts=a;const f=6+h+c;let p=0;if(0!==o){if(o<h+c)return void s.z3("Malformed PES: PES_packet_length < 3 + PES_header_data_length",n,133);p=o-(h+c)}else p=e.byteLength-f;t.payload=e.subarray(f,f+p)}else if((188===a||191===a||240===a||241===a||255===a||242===a||248===a)&&6===t.streamId){const a=6;let i=0;i=0!==o?o:e.byteLength-a,t.payload=e.subarray(a,a+i)}return 0}},6403:(t,e,a)=>{a.d(e,{Cd:()=>d,I4:()=>f,am:()=>c,kJ:()=>l,pi:()=>h,xf:()=>p});var i=a(134),s=a(80662),r=a.n(s),n=a(77231);class o{constructor(){(0,i.A)(this,"discontinuityIndicator",0),(0,i.A)(this,"randomAccessIndicator",0),(0,i.A)(this,"elementaryStreamPriorityIndicator",0),(0,i.A)(this,"pcrFlag",0),(0,i.A)(this,"opcrFlag",0),(0,i.A)(this,"splicingPointFlag",0),(0,i.A)(this,"transportPrivateDataFlag",0),(0,i.A)(this,"adaptationFieldExtensionFlag",0),(0,i.A)(this,"pcr",BigInt(0)),(0,i.A)(this,"opcr",BigInt(0)),(0,i.A)(this,"spliceCountDown",0),(0,i.A)(this,"transportPrivateData",null),(0,i.A)(this,"extension",null)}}class c{constructor(){(0,i.A)(this,"pos",n.Dh),(0,i.A)(this,"payloadUnitStartIndicator",0),(0,i.A)(this,"transportPriority",0),(0,i.A)(this,"pid",n.N_),(0,i.A)(this,"adaptationFieldControl",0),(0,i.A)(this,"continuityCounter",0),(0,i.A)(this,"transportScramblingControl",0),(0,i.A)(this,"adaptationFieldInfo",new o),(0,i.A)(this,"payload",null)}}class h{constructor(){(0,i.A)(this,"slices",[]),(0,i.A)(this,"totalLength",0),(0,i.A)(this,"expectedLength",n.N_),(0,i.A)(this,"randomAccessIndicator",0),(0,i.A)(this,"pid",n.N_),(0,i.A)(this,"streamType",0),(0,i.A)(this,"pos",n.Dh)}}class d{constructor(){(0,i.A)(this,"versionNumber",0),(0,i.A)(this,"networkPid",n.N_),(0,i.A)(this,"program2PmtPid",new(r()))}}class l{constructor(){(0,i.A)(this,"tag",void 0),(0,i.A)(this,"buffer",void 0)}}class f{constructor(){(0,i.A)(this,"versionNumber",0),(0,i.A)(this,"programNumber",0),(0,i.A)(this,"pcrPid",0),(0,i.A)(this,"pid2StreamType",new(r())),(0,i.A)(this,"pid2ESDescriptor",new(r()))}}class p{constructor(){(0,i.A)(this,"pid",n.N_),(0,i.A)(this,"streamType",0),(0,i.A)(this,"streamId",n.N_),(0,i.A)(this,"dts",n.Dh),(0,i.A)(this,"pts",n.Dh),(0,i.A)(this,"pos",n.Dh),(0,i.A)(this,"payload",null),(0,i.A)(this,"data",null),(0,i.A)(this,"randomAccessIndicator",0)}}},2187:(t,e,a)=>{a.d(e,{d:()=>n});var i=a(72739),s=a(44328),r=a(77231);function n(t,e,a){let n=BigInt(0);return i.__(t,(t=>{n+=t.codecpar.bitrate*(0,s.k)(e,a,r.i0)/BigInt(8e3)})),n}},52071:(t,e,a)=>{a.d(e,{A:()=>p});var i=a(63939),s=a(9599),r=a(29170),n=a(77231),o=a(44328),c=a(2187),h=a(71517),d=a(9705),l=a(4624),f="src\\avformat\\function\\seekInBytes.ts";async function p(t,e,a,p,u,g){const A=t.ioReader.getPos(),m=await t.ioReader.fileSize();let I=n.Dh,b=a;e.startTime!==n.Dh?b-=e.startTime:b-=e.firstDTS;const k=(0,o.k)(a,e.timeBase,n.i0);if(k<BigInt(1e4))return l.Yz(`seek pts is earlier then 10s, seek to first packet pos(${p}) directly`,f,63),await t.ioReader.seek(p),A;let y=(0,c.d)(t.streams,b,e.timeBase);const C=m-(0,c.d)(t.streams,BigInt(1e4),n.i0),x=(0,c.d)(t.streams,BigInt(1e4),n.i0);if(y>C&&(y=C),y<p)return await t.ioReader.seek(p),A;const w=(0,h._5)();let B=m,M=BigInt(0);for(;;){if(B-M<x){I=M;break}await t.ioReader.seek(y),await g(t);const e=t.ioReader.getPos();if(!(await u(t,w)>=0)){I=n.Dh;break}{const t=(0,o.k)(i.f[17](w+8),(0,r.A)(w+72,s.P),n.i0),a=t-k;if(l.Yz(`try to seek to pos: ${y}, got packet pts: ${i.f[17](w+8)}(${t}ms), diff: ${a}ms`,f,98),a<=BigInt(0)&&-a<BigInt(1e4)){I=e;break}a>BigInt(0)?(B=y,y=M+B>>BigInt(1)):(M=y,y=M+B>>BigInt(1))}}return(0,h.Qe)(w),I!==n.Dh?(l.Yz(`finally seek to pos ${I}`,f,126),await t.ioReader.seek(I),await g(t),A):(await t.ioReader.seek(A),BigInt(d.E$))}}}]);