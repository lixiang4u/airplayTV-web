"use strict";(self.webpackChunkAVTranscoder=self.webpackChunkAVTranscoder||[]).push([[765],{64436:(t,e,r)=>{r.d(e,{A:()=>o});var i=r(134),n=r(63939),s=r(37837),a=r(71766);class o{constructor(){(0,i.A)(this,"inCodecpar",void 0),(0,i.A)(this,"inTimeBase",void 0),(0,i.A)(this,"outCodecpar",void 0)}init(t,e){return this.inCodecpar=(0,s.Gy)(168),(0,a.Yi)(this.inCodecpar,t),this.inTimeBase={den:n.f[15](e+4),num:n.f[15](e)},0}destroy(){this.inCodecpar&&((0,a.dn)(this.inCodecpar),this.inCodecpar=0)}}},26173:(t,e,r)=>{r.d(e,{A:()=>w});var i=r(134),n=r(63939),s=r(50932),a=r(64436),o=r(71517),c=r(20620),d=r(53e3),l=r(55611),p=r(14686),u=r(9705),f=r(60264),m=r(37837),h=r(4624);class w extends a.A{constructor(...t){super(...t),(0,i.A)(this,"cache",void 0),(0,i.A)(this,"cached",void 0)}init(t,e){return super.init(t,e),this.cache=(0,o._5)(),this.cached=!1,0}destroy(){super.destroy(),(0,o.Qe)(this.cache),this.cache=0}sendAVPacket(t){const e=(0,p.JW)(n.f[20](t+24),n.f[15](t+28));if(1!==n.f[15](t+80)&&(0,f.Bs)(e)){let r;if((0,o.zu)(this.cache,t),27===n.f[15](this.inCodecpar+4)?r=c.oT(e):173===n.f[15](this.inCodecpar+4)?r=d.oT(e):196===n.f[15](this.inCodecpar+4)?r=l.oT(e):h.h2(`not support for codecId: ${n.f[15](this.inCodecpar+4)}`,"src/avformat/bsf/h2645/Annexb2AvccFilter.ts",91),s.M[15](this.cache+80,1),(0,o.NX)(this.cache,r.bufferPointer,r.length),r.key&&s.M[15](this.cache+36,1|n.f[15](this.cache+36)),r.extradata){const t=(0,m.sY)(r.extradata.length);(0,p.lW)(t,r.extradata.length,r.extradata),(0,o.Ow)(this.cache,1,t,r.extradata.length)}}else(0,o.rN)(this.cache,t);return this.cached=!0,0}receiveAVPacket(t){return this.cached?((0,o.Up)(t),(0,o.rN)(t,this.cache),this.cached=!1,0):u.LR}}},87771:(t,e,r)=>{r.d(e,{R:()=>m,j:()=>s});var i=r(14686),n=r(37246);const s=[3,4,3,7,259,263,1539,1543],a=[[64,69,96],[64,70,96],[80,87,120],[80,88,120],[96,104,144],[96,105,144],[112,121,168],[112,122,168],[128,139,192],[128,140,192],[160,174,240],[160,175,240],[192,208,288],[192,209,288],[224,243,336],[224,244,336],[256,278,384],[256,279,384],[320,348,480],[320,349,480],[384,417,576],[384,418,576],[448,487,672],[448,488,672],[512,557,768],[512,558,768],[640,696,960],[640,697,960],[768,835,1152],[768,836,1152],[896,975,1344],[896,976,1344],[1024,1114,1536],[1024,1115,1536],[1152,1253,1728],[1152,1254,1728],[1280,1393,1920],[1280,1394,1920]],o=[4,5,6,5],c=[4,6,7,6],d=[48e3,44100,32e3,0],l=[32,40,48,56,64,80,96,112,128,160,192,224,256,320,384,448,512,576,640],p=[2,1,2,3,3,4,4,5],u=[1,2,3,6],f=7;function m(t,e){const r=new n.A(e);r.appendBuffer((0,i.s3)(t,e));const m={syncWord:0,crc1:0,srCode:0,bitstreamId:0,bitstreamMode:0,channelMode:0,lfeOn:0,frameType:0,substreamId:0,centerMixLevel:0,surroundMixLevel:0,channelMap:0,numBlocks:0,dolbySurroundMode:0,srShift:0,sampleRate:0,bitRate:0,channels:0,frameSize:0,channelLayout:BigInt(0),ac3BitrateCode:0};if(m.syncWord=r.readU(16),2935!==m.syncWord)return-1;if(m.bitstreamId=31&r.readU(29),m.bitstreamId>16)return-2;if(m.numBlocks=6,m.ac3BitrateCode=-1,m.centerMixLevel=5,m.surroundMixLevel=6,m.dolbySurroundMode=0,m.bitstreamId<=10){if(m.crc1=r.readU(16),m.srCode=r.readU(2),3===m.srCode)return-3;const t=r.readU(6);if(t>37)return-4;m.ac3BitrateCode=t>>1,r.readU(5),m.bitstreamMode=r.readU(3),m.channelMode=r.readU(3),2==m.channelMode?m.dolbySurroundMode=r.readU(2):(1&m.channelMode&&1!=m.channelMode&&(m.centerMixLevel=o[r.readU(2)]),4&m.channelMode&&(m.surroundMixLevel=c[r.readU(2)])),m.lfeOn=r.readU(1),m.srShift=Math.max(m.bitstreamId,8)-8,m.sampleRate=d[m.srCode]>>m.srShift,m.bitRate=1e3*l[m.ac3BitrateCode]>>m.srShift,m.channels=p[m.channelMode]+m.lfeOn,m.frameSize=2*a[t][m.srCode],m.frameType=2,m.substreamId=0}else{if(m.crc1=0,m.frameType=r.readU(2),3==m.frameType)return-5;if(m.substreamId=r.readU(3),m.frameSize=r.readU(11)+1<<1,m.frameSize<f)return-6;if(m.srCode=r.readU(2),3==m.srCode){const t=r.readU(2);if(3==t)return-7;m.sampleRate=d[t]/2,m.srShift=1}else m.numBlocks=u[r.readU(2)],m.sampleRate=d[m.srCode],m.srShift=0;m.channelMode=r.readU(3),m.lfeOn=r.readU(1),m.bitRate=8*m.frameSize*m.sampleRate/(256*m.numBlocks),m.channels=p[m.channelMode]+m.lfeOn}return m.channelLayout=BigInt.asUintN(64,s[m.channelMode]),m.lfeOn&&(m.channelLayout|=BigInt(8)),m}},55611:(t,e,r)=>{r.d(e,{Jk:()=>S,OD:()=>I,QA:()=>A,Ui:()=>k,XC:()=>y,ci:()=>x,oT:()=>b,wf:()=>v});var i=r(63939),n=r(50932),s=r(72739),a=r(729),o=r(31865),c=r(37246),d=r(14686),l=r(60264),p=r(71517),u=r(37837),f=r(23991),m=r(83314);const h=3;function w(t){const e=t.readU(9),r=t.readU(3),i=t.readU(2),n=t.readU(2),s=t.readU(3);t.readU(5),t.readU(2);const a=t.readU(6),o=t.readU(7),c=t.readU(1),d=t.readU(8),l=t.readU(1),p=t.readU(1),u=[],f=[];if(a){for(let e=0;e<a-1;e++)u[e]=t.readU(8);u[a-1]=t.readU(6)}else t.readU(6);if(r>1){let e=0;for(let i=r-2;i>=0;--i)e|=t.readU(1)<<i;for(let e=r;e<=8&&r>1;++e)t.readU(1);for(let i=r-2;i>=0;--i)e&1<<i&&(f[i]=t.readU(8))}const m=t.readU(8),h=[];if(m)for(let e=0;e<m;e++)h.push(t.readU(8));return{olsIdx:e,numSublayers:r,bitDepthMinus8:s,chromaFormatIdc:n,constantFrameRate:i,generalProfileIdc:o,generalTierFlag:c,generalLevelIdc:d,ptlFrameOnlyConstraintFlag:l,ptlMultilayerEnabledFlag:p,generalConstraintInfo:u,sublayerLevelIdc:f,generalSubProfileIdc:h,maxPictureWidth:t.readU(16),maxPictureHeight:t.readU(16),avgFramerate:t.readU(16)}}function U(t){const e=new o.A(t,!0);if(1&e.readUint8()){const r=new c.A;r.appendBuffer(t.subarray(1)),w(r),e.skip(r.getPos())}let r=[],i=[],n=[];const s=e.readUint8();for(let t=0;t<s;t++){const t=31&e.readUint8();let s=1;13!==t&&12!==t&&(s=e.readUint16());const a=[];for(let t=0;t<s;t++){const t=e.readUint16();a.push(e.readBuffer(t))}14===t?r=a:15===t?i=a:16===t&&(n=a)}return{vpss:r,spss:i,ppss:n}}function g(t,e,r){const i=e[0];let n;if(i){const t=v(i);let e=t.generalConstraintInfo;e.length||(e=new Array(12).fill(0));const r=new m.A;if(r.writeU(9,0),r.writeU(3,t.spsMaxSublayersMinus1+1),r.writeU(2,1),r.writeU(2,t.chromaFormatIdc),r.writeU(3,t.bitDepthMinus8),r.writeU(5,31),r.writeU(2,0),r.writeU(6,e.length),r.writeU(7,t.profile),r.writeU1(t.tierFlag),r.writeU(8,t.level),r.writeU1(t.ptlFrameOnlyConstraintFlag),r.writeU1(t.ptlMultilayerEnabledFlag),e.length){for(let t=0;t<e.length-1;t++)r.writeU(8,e[t]);r.writeU(6,e[e.length-1])}else r.writeU(6,63);if(t.spsMaxSublayersMinus1+1>1){let e=0;for(let r=t.spsMaxSublayersMinus1-1;r>=0;r--)e=e<<1|t.ptlSublayerLevelPresentFlag[r];r.writeU(t.spsMaxSublayersMinus1,e);for(let e=t.spsMaxSublayersMinus1+1;e<=8&&t.spsMaxSublayersMinus1>0;++e)r.writeU1(0);for(let e=t.spsMaxSublayersMinus1-1;e>=0;e--)t.ptlSublayerLevelPresentFlag[e]&&r.writeU(8,t.sublayerLevelIdc[e])}r.writeU(8,t.generalSubProfileIdc.length);for(let e=0;e<t.generalSubProfileIdc.length;e++)r.writeU(8,t.sublayerLevelIdc[e]);r.writeU(16,t.width),r.writeU(16,t.height),r.writeU(16,0),r.padding(),n=r.getBuffer().subarray(0,r.getPointer())}let o=2+(n?n.length:0);t.length&&(o+=3,o=t.reduce(((t,e)=>t+2+e.length),o)),e.length&&(o+=3,o=e.reduce(((t,e)=>t+2+e.length),o)),r.length&&(o+=3,o=r.reduce(((t,e)=>t+2+e.length),o));const c=new Uint8Array(o),d=new a.A(c,!0);d.writeUint8(h<<1|(n?1:0)|248),n&&d.writeBuffer(n);let l=0;return t.length&&l++,e.length&&l++,r.length&&l++,d.writeUint8(l),t.length&&(d.writeUint8(142),d.writeUint16(t.length),s.__(t,(t=>{d.writeUint16(t.length),d.writeBuffer(t)}))),e.length&&(d.writeUint8(143),d.writeUint16(e.length),s.__(e,(t=>{d.writeUint16(t.length),d.writeBuffer(t)}))),r.length&&(d.writeUint8(144),d.writeUint16(r.length),s.__(r,(t=>{d.writeUint16(t.length),d.writeBuffer(t)}))),c}function b(t){let e,r=!1,i=(0,l.py)(t);if(i.length>=2){const t=[],r=[],n=[];i.forEach((e=>{const i=e[1]>>>3&31;14===i?t.push(e):15===i?r.push(e):16===i&&n.push(e)})),r.length&&n.length&&(e=g(t,r,n),i=i.filter((t=>{const e=t[1]>>>3&31;return 14!==e&&15!==e&&16!==e&&20!==e})))}const n=i.reduce(((t,e)=>t+h+1+e.length),0),o=(0,u.sY)(n),c=(0,d.s3)(o,n),p=new a.A(c);return s.__(i,(t=>{3===h?p.writeUint32(t.length):2===h?p.writeUint24(t.length):1===h?p.writeUint16(t.length):p.writeUint8(t.length),p.writeBuffer(t.subarray(0));const e=t[1]>>>3&31;8!==e&&7!==e&&9!==e&&10!==e||(r=!0)})),{bufferPointer:o,length:n,extradata:e,key:r}}function I(t,e){const r=e?e[0]>>>1&3:h;let i=[],n=[],c=[],l=!1;if(e){const t=U(e);i=t.vpss,n=t.spss,c=t.ppss,l=!0}const p=[],f=new o.A(t);for(;f.remainingSize()>0;){let t=0;t=3===r?f.readUint32():2===r?f.readUint24():1===r?f.readUint16():f.readUint8(),p.push(f.readBuffer(t))}let m=i.reduce(((t,e)=>t+4+e.length),0);m=n.reduce(((t,e)=>t+4+e.length),m),m=c.reduce(((t,e)=>t+4+e.length),m),m=p.reduce(((t,e,r)=>t+(r?3:4)+e.length),m);const w=(0,u.sY)(m+7),g=(0,d.s3)(w,m+7),b=new a.A(g);return b.writeUint8(0),b.writeUint8(0),b.writeUint8(0),b.writeUint8(1),b.writeUint8(0),b.writeUint8(160),b.writeUint8(240),s.__(i,(t=>{b.writeUint8(0),b.writeUint8(0),b.writeUint8(0),b.writeUint8(1),b.writeBuffer(t)})),s.__(n,(t=>{b.writeUint8(0),b.writeUint8(0),b.writeUint8(0),b.writeUint8(1),b.writeBuffer(t)})),s.__(c,(t=>{b.writeUint8(0),b.writeUint8(0),b.writeUint8(0),b.writeUint8(1),b.writeBuffer(t)})),s.__(p,((t,e)=>{b.writeUint8(0),b.writeUint8(0),e||b.writeUint8(0),b.writeUint8(1),b.writeBuffer(t);const r=t[1]>>>3&31;8!==r&&7!==r&&9!==r&&10!==r||(l=!0)})),{bufferPointer:w,length:m+7,key:l}}function S(t,e){var r;if(!(1&i.f[15](t+36)))return;const n=(0,p.iI)(t);if((0,l.Bs)(n))return;const s=null!==(r=e.metadata.naluLengthSizeMinusOne)&&void 0!==r?r:h;let a=[],c=[],f=[];const m=new o.A(n);for(;m.remainingSize()>0;){let t=0;t=3===s?m.readUint32():2===s?m.readUint24():1===s?m.readUint16():m.readUint8();const e=n.subarray(0|Number(0xffffffffn&m.getPos()),(0|Number(0xffffffffn&m.getPos()))+t);m.skip(t);const r=e[1]>>>3&31;15===r?c.push(e):16===r?f.push(e):14===r&&a.push(e)}if(c.length||f.length||a.length){const e=g(a,c,f),r=(0,u.sY)(e.length);(0,d.lW)(r,e.length,e),(0,p.Ow)(t,1,r,e.length)}}function x(t,e=!1){if(!(1&i.f[15](t+36)||e))return;const r=(0,p.iI)(t);if(!(0,l.Bs)(r))return;let s=(0,l.py)(r);if(s.length>2){const e=[],r=[],a=[];if(s.forEach((t=>{const i=t[1]>>>3&31;14===i?e.push(t):15===i?r.push(t):16===i&&a.push(t)})),e.length&&r.length&&a.length){const s=g(e,r,a),o=(0,u.sY)(s.length);(0,d.lW)(o,s.length,s),(0,p.Ow)(t,1,o,s.length),n.M[15](t+36,1|i.f[15](t+36))}}}function A(t,e){const{profile:r,level:i,width:n,height:s}=v(e);t.codecpar.profile=r,t.codecpar.level=i,t.codecpar.width=n,t.codecpar.height=s}function y(t,e){if(!e&&t.sideData[1]&&(e=t.sideData[1]),e&&e.length>=6){t.metadata.naluLengthSizeMinusOne=e[0]>>>1&3;const{spss:r}=U(e);r.length&&A(t,r[0])}}function v(t){if(!t||t.length<3)return;let e=0;0===t[0]&&0===t[1]&&0===t[2]&&1===t[3]&&(e=4);let r=0,i=0,n=0,s=0,a=0,o=1,d=0,p=0,u=0;const m=[],h=[],w=[],U=[],g=(0,l.BN)(t.subarray(e)),b=new c.A(g.length);b.appendBuffer(g),b.readU1(),b.readU1(),b.readU(6),b.readU(5),b.readU(3),b.readU(8);const I=b.readU(3);o=b.readU(2);const S=b.readU(2);if(b.readU(1)){if(r=b.readU(7),d=b.readU(1),i=b.readU(8),p=b.readU(1),u=b.readU(1),b.readU(1)){for(let t=0;t<8;t++)m[t]=b.readU(8);m[8]=b.readU(7);const t=b.readU(8);b.readU(t)}b.skipPadding();for(let t=I-1;t>=0;t--)h[t]=b.readU(1);b.skipPadding();for(let t=I-1;t>=0;t--)h[t]&&(w[t]=b.readU(8));const t=b.readU(8);if(t)for(let e=0;e<t;e++)U[e]=b.readU(32)}b.readU1(),b.readU1()&&b.readU1();const x=n=f.xb(b),A=s=f.xb(b);if(b.readU1()&&(f.xb(b),f.xb(b),f.xb(b),f.xb(b)),b.readU1()){const t=f.xb(b),e=S+5,r=1<<e,i=x/(1<<e),n=A/(1<<e),s=Math.ceil(Math.log2(i)),a=Math.ceil(Math.log2(n));let o=0,c=0,d=0;t>0&&(d=b.readU1(),c=b.readU1());for(let e=0;t>0&&e<=t;e++)c&&0!=e||(e>0&&x>r&&b.readU(s),e>0&&A>r&&b.readU(a),e<t&&x>r&&b.readU(s),e<t&&A>r&&b.readU(a)),d||b.readU(2);if(o=f.xb(b)+1,b.readU(1)&&b.readU(1))for(let e=0;e<=t;e++)b.readU(o)}a=f.xb(b),b.readU(1),b.readU(1);const y=b.readU(4),v=b.readU(1);let k=0;v&&(k=f.xb(b));const C=[],D=b.readU(2);for(let t=0;t<8*D;t++)C[t]=b.readU(1);return{profile:r,level:i,width:n,height:s,chromaFormatIdc:o,bitDepthMinus8:a,generalProfileSpace:0,tierFlag:d,generalConstraintInfo:m,generalSubProfileIdc:U,ptlFrameOnlyConstraintFlag:p,ptlMultilayerEnabledFlag:u,spsMaxSublayersMinus1:I,ptlSublayerLevelPresentFlag:h,sublayerLevelIdc:w,sps_log2_max_pic_order_cnt_lsb_minus4:y,sps_poc_msb_cycle_flag:v,sps_poc_msb_cycle_len_minus1:k,sps_num_extra_ph_bytes:D,sps_extra_ph_bit_present_flag:C}}function k(t){0===t[0]&&0===t[1]&&0===t[2]&&1===t[3]&&(t=function(t){let e=(0,l.py)(t);if(e.length>=2){const t=[],r=[],i=[];if(e.forEach((e=>{const n=e[1]>>>3&31;14===n?t.push(e):15===n?r.push(e):16===n&&i.push(e)})),r.length&&i.length)return g(t,r,i)}}(t));const e=new c.A;return e.appendBuffer(t),1&e.readU(8)?w(e):{}}},69765:(t,e,r)=>{r.r(e),r.d(e,{default:()=>B});var i=r(134),n=r(61499),s=r(63939),a=r(9599),o=r(29170),c=r(51597),d=r(9690),l=r(65977),p=r(75473),u=r(38106),f=r(3384),m=r(35336),h=r(72739),w=r(4624),U=r(92647),g=r(79804),b=r(77231),I=r(95335),S=r(20841),x=r(59989),A=r(44328),y=r(71517),v=r(26173),k=r(67672),C=r(87771),D="src/avformat/formats/OMovFormat.ts";const P={fragmentMode:0,movMode:0,fragment:!1,fastOpen:!1,defaultBaseIsMoof:!1};class B extends c.A{constructor(t={}){super(),(0,i.A)(this,"type",1),(0,i.A)(this,"context",void 0),(0,i.A)(this,"options",void 0),(0,i.A)(this,"annexb2AvccFilter",void 0),this.options=I.X$({},P,t),this.context=(0,d.A)()}init(t){t.ioWriter.setEndian(!0);const e=t.getStreamByMediaType(0);return e&&(this.annexb2AvccFilter=new v.A,this.annexb2AvccFilter.init(e.codecpar[n.o9],e.timeBase[n.o9])),0}destroy(t){super.destroy(t),this.annexb2AvccFilter&&(this.annexb2AvccFilter.destroy(),this.annexb2AvccFilter=null)}enableStreams(t){const e=[],r=[];for(let t=0;t<5;t++)e[t]=0,r[t]=-1;h.__(t.streams,((t,i)=>{if(-1===t.codecpar.codecType||t.codecpar.codecType>=5)return!0;r[t.codecpar.codecType]<0&&(r[t.codecpar.codecType]=i),1&t.disposition&&(e[t.codecpar.codecType]++,t.privData.flags|=1)}));for(let i=0;i<5;i++)switch(i){case 0:case 1:case 3:e[i]>1&&(t.streams[e[i]].privData.perStreamGrouping=!0),!e[i]&&r[i]>=0&&(t.streams[r[i]].privData.flags|=1)}}writeHeader(t){if(this.context.majorBrand=(0,l.A)("isom"),this.context.minorVersion=512,this.context.compatibleBrand=[(0,l.A)("isom")],this.context.timescale=1e3,this.options.fragment&&(this.context.compatibleBrand.push((0,l.A)("iso6")),this.context.fragment=!0),1===this.options.movMode&&(this.context.isom=!0,this.context.majorBrand=(0,l.A)("qt  "),this.context.compatibleBrand=[this.context.majorBrand]),1!==this.options.movMode){this.context.compatibleBrand.push((0,l.A)("iso2"));const e=t.getStreamByMediaType(0);e&&27===e.codecpar.codecId&&this.context.compatibleBrand.push((0,l.A)("avc1")),this.context.compatibleBrand.push((0,l.A)("mp41"))}if(p.l7(t.ioWriter,this.context),this.context.holdMoovPos=t.ioWriter.getPos(),this.options.fragment)this.context.currentFragment={pos:BigInt(0),currentTrack:null,sequence:1,tracks:[],size:0,firstWrote:!1},h.__(t.streams,((t,e)=>{const r=(0,u.A)();t.privData=r,r.chunkOffsets=[],r.cttsSampleCounts=[],r.cttsSampleOffsets=[],r.stscFirstChunk=[],r.stscSamplesPerChunk=[],r.stscSampleDescriptionIndex=[],r.stssSampleNumbers=[],r.sampleSizes=[],r.sttsSampleCounts=[],r.sttsSampleDeltas=[],r.alternateGroup=e;const i=(0,f.A)();i.baseIsMoof=this.options.defaultBaseIsMoof,i.streamIndex=t.index,i.trackId=this.context.nextTrackId++,r.trackId=i.trackId,i.ioWriter=new m.A,i.ioWriter.onFlush=t=>(i.buffers.push(t.slice()),0),this.context.currentFragment.tracks.push(i)})),this.enableStreams(t),p.dI(t.ioWriter,t,this.context),t.ioWriter.flush();else{h.__(t.streams,((t,e)=>{const r=(0,u.A)();t.privData=r,r.trackId=this.context.nextTrackId++,r.chunkOffsets=[],r.cttsSampleCounts=[],r.cttsSampleOffsets=[],r.stscFirstChunk=[],r.stscSamplesPerChunk=[],r.stscSampleDescriptionIndex=[],r.stssSampleNumbers=[],r.sampleSizes=[],r.sttsSampleCounts=[],r.sttsSampleDeltas=[],r.alternateGroup=e})),this.enableStreams(t);const e=t.ioWriter.getPos();t.ioWriter.writeUint32(0),t.ioWriter.writeUint32((0,l.A)("mdat")),this.context.boxsPositionInfo.push({pos:e,type:"mdat",size:0})}return 0}updateCurrentChunk(t){let e=this.context.currentChunk;if(!e.sampleCount)return;const r=t.streams.find((t=>t.index===e.streamIndex)).privData;r.chunkCount++,r.chunkOffsets.push(e.pos),r.stscFirstChunk.length?r.lastStscCount!==e.sampleCount&&(r.stscFirstChunk.push(r.chunkCount),r.stscSamplesPerChunk.push(e.sampleCount),r.stscSampleDescriptionIndex.push(1),r.lastStscCount=e.sampleCount):(r.stscFirstChunk.push(r.chunkCount),r.stscSamplesPerChunk.push(e.sampleCount),r.stscSampleDescriptionIndex.push(1),r.lastStscCount=e.sampleCount)}checkMdat(t,e){const r=this.context.boxsPositionInfo[this.context.boxsPositionInfo.length-1];if("mdat"!==r.type)return void w.z3("last box is not mdat",D,301);const i=t.ioWriter.getPos(),n=Number(i-r.pos);n+e>b.f7&&(r.size=n,t.ioWriter.writeUint32(0),t.ioWriter.writeUint32((0,l.A)("mdat")),this.context.boxsPositionInfo.push({pos:i,type:"mdat",size:0}))}updateCurrentFragment(t,e){if(this.context.currentFragment.firstWrote){h.__(this.context.currentFragment.tracks,(r=>{const i=t.streams.find((t=>t.index===r.streamIndex));if(!r.sampleCount||!i)return!0;const n=i.privData;var s;r.baseDataOffset=t.ioWriter.getPos(),r.sampleDurations.length?e&&r.sampleDurations.length===r.sampleSizes.length-1&&r.sampleDurations.push(Number(e-n.lastDts)):1===i.codecpar.codecType?e?r.sampleDurations.push(Number(e-n.lastDts)):i.codecpar.frameSize>0?r.sampleDurations.push(Number((0,A.k)(BigInt(i.codecpar.frameSize/i.codecpar.sampleRate*b.SF),b.KR,i.timeBase))):(i.codecpar.codecId,r.sampleDurations.push(Number((0,A.k)(BigInt(1024/i.codecpar.sampleRate*b.SF),b.KR,i.timeBase)))):0===i.codecpar.codecType?e?r.sampleDurations.push(Number(e-n.lastDts)):(0,A.lb)(i.codecpar.framerate)>0?r.sampleDurations.push(Number((0,A.k)(BigInt(Math.floor(1/(0,A.lb)(i.codecpar.framerate)*b.SF)),b.KR,i.timeBase))):r.sampleDurations.push(i.timeBase.den/(30*i.timeBase.num)>>>0):r.sampleDurations.push(0),n.lastDuration=r.sampleDurations[r.sampleSizes.length-1],(1===r.sampleFlags.length||(0,x.A)(r.sampleFlags,1))&&(r.firstSampleFlags=r.sampleFlags[0],r.defaultSampleFlags=null!==(s=r.sampleFlags[1])&&void 0!==s?s:r.firstSampleFlags,r.sampleFlags=[]),(1===r.sampleSizes.length||(0,x.A)(r.sampleSizes))&&(r.defaultSampleSize=r.sampleSizes[0],r.sampleSizes=[]),(1===r.sampleDurations.length||(0,x.A)(r.sampleDurations))&&(r.defaultSampleDuration=r.sampleDurations[0],r.sampleDurations=[]),1===i.codecpar.codecType?r.defaultSampleFlags=33554432:r.sampleFlags.length&&(r.defaultSampleFlags=r.sampleFlags[0]),r.sampleSizes.length&&(r.defaultSampleSize=r.sampleSizes[0]),r.sampleDurations.length&&(r.defaultSampleDuration=r.sampleDurations[0])})),t.ioWriter.flush(),p.Ro(t.ioWriter,t,this.context);let r=this.context.currentFragment.size+8;const i=[];let n=8;h.__(this.context.currentFragment.tracks,(e=>{if(!e.sampleCount)return!0;e.ioWriter.flush();const s=(0,U.A)(Uint8Array,e.buffers);e.dataOffset=r,r+=s.length,n+=s.length,i.push(s),(0,S.A)(t.ioWriter,e.dataOffsetPos,e.dataOffset,"int32"),e.buffers=[],e.sampleFlags=[],e.sampleSizes=[],e.sampleDurations=[],e.sampleCompositionTimeOffset=[],e.sampleCount=0,e.firstSampleFlags=0})),t.ioWriter.writeUint32(n),t.ioWriter.writeUint32((0,l.A)("mdat")),h.__(i,(e=>{t.ioWriter.writeBuffer(e)})),(0,g.A)(t.ioWriter,this.context),t.ioWriter.flush(),this.context.currentFragment.firstWrote=!1,this.context.currentFragment.sequence++}}handleEAC3(t,e){this.context.ac3Info||(this.context.ac3Info={done:!1,numBlocks:0,dataRate:0,ac3BitrateCode:-1,numIndSub:0,substream:[]});const r=this.context.ac3Info,i=C.R(s.f[20](t+24),s.f[15](t+28));if(k.ai(i))r.done=!0;else if(r.dataRate=Math.max(r.dataRate,i.bitRate/1e3),r.ac3BitrateCode=Math.max(r.ac3BitrateCode,i.ac3BitrateCode),!r.done){if(i.bitstreamId<=10&&0!=i.substreamId)return;if(0===i.frameType||2==i.frameType){var n;if(i.substreamId>r.numIndSub+1)return;if(i.substreamId==r.numIndSub+1)return;if(i.substreamId<r.numIndSub||0==i.substreamId&&null!==(n=r.substream[0])&&void 0!==n&&n.bsid)return void(r.done=!0)}else if(0!=i.substreamId)return;if(r.substream[i.substreamId]||(r.substream[i.substreamId]={fscod:0,bsid:0,bsmod:0,acmod:0,lfeon:0,numDepSub:0,chanLoc:0}),r.substream[i.substreamId].fscod=i.srCode,r.substream[i.substreamId].bsid=i.bitstreamId,r.substream[i.substreamId].bsmod=i.bitstreamMode,r.substream[i.substreamId].acmod=i.channelMode,r.substream[i.substreamId].lfeon=i.lfeOn,86019===e.codecpar.codecId)return void(r.done=!0)}}writeAVPacket(t,e){if(!s.f[15](e+28))return w.R8(`packet's size is 0: ${s.f[15](e+32)}, ignore it`,D,542),0;const r=t.getStreamByIndex(s.f[15](e+32));if(!r)return void w.R8(`can not found the stream width the avpacket's streamIndex: ${s.f[15](e+32)}, ignore it`,D,549);const i=r.privData,n=(0,A.k)(s.f[17](e+16),(0,o.A)(e+72,a.P),r.timeBase),c=(0,A.k)(s.f[17](e+8)<BigInt(0)?s.f[17](e+16):s.f[17](e+8),(0,o.A)(e+72,a.P),r.timeBase);if(27!==r.codecpar.codecId&&173!==r.codecpar.codecId&&196!==r.codecpar.codecId||2!==s.f[15](e+80)?86019!==r.codecpar.codecId&&86056!==r.codecpar.codecId||this.context.ac3Info&&this.context.ac3Info.done||this.handleEAC3(e,r):(this.annexb2AvccFilter.sendAVPacket(e),this.annexb2AvccFilter.receiveAVPacket(e)),this.context.fragment){const d=this.context.currentFragment.tracks.find((t=>t.streamIndex===s.f[15](e+32)));if(d){if((0===this.options.fragmentMode&&0===r.codecpar.codecType&&1&s.f[15](e+36)||1===this.options.fragmentMode)&&(1===this.context.currentFragment.tracks.length?this.updateCurrentFragment(t,n):this.updateCurrentFragment(t)),d.ioWriter.writeBuffer((0,y.iI)(e)),d.sampleSizes.length||(d.baseMediaDecodeTime=n),d.sampleSizes.length&&(!d.sampleDurations[d.sampleSizes.length-1]||d.sampleDurations[d.sampleSizes.length-1]<=0)&&(d.sampleDurations[d.sampleSizes.length-1]=Number(n-i.lastDts)),s.f[17](e+48)>0&&d.sampleDurations.push(Number((0,A.k)(s.f[17](e+48),(0,o.A)(e+72,a.P),r.timeBase))),d.sampleSizes.push(s.f[15](e+28)),0===r.codecpar.codecType){let t=0;1&s.f[15](e+36)?t|=33554432:t|=16842752,d.sampleCompositionTimeOffset.push(Number((c||n)-n)),d.sampleFlags.push(t)}d.sampleCount++,i.lastPts=c>i.lastPts?c:i.lastPts,i.lastDts=n,this.context.currentFragment.firstWrote=!0}else w.R8(`can not found track width streamIndex ${s.f[15](e+32)}, ignore it`,D,635)}else{this.checkMdat(t,s.f[15](e+28));const a=t.ioWriter.getPos();let o=this.context.currentChunk;if(o?o.streamIndex!==s.f[15](e+32)?(this.updateCurrentChunk(t),o.streamIndex=s.f[15](e+32),o.sampleCount=1,o.pos=a):o.sampleCount++:o=this.context.currentChunk={pos:a,streamIndex:s.f[15](e+32),sampleCount:1},t.ioWriter.writeBuffer((0,y.iI)(e)),i.sampleSizes.push(s.f[15](e+28)),0===r.codecpar.codecType&&1&s.f[15](e+36)&&i.stssSampleNumbers.push(i.sampleSizes.length),i.firstWrote){const t=Number(n-i.lastDts);i.sttsSampleCounts.length&&i.sttsSampleDeltas[i.sttsSampleDeltas.length-1]===t?i.sttsSampleCounts[i.sttsSampleCounts.length-1]++:(i.sttsSampleCounts.push(1),i.sttsSampleDeltas.push(t))}else i.startDts=n,i.startCT=Number((c||n)-n),i.firstWrote=!0;if(0===r.codecpar.codecType){const t=Number((c||n)-n);i.cttsSampleCounts.length&&i.cttsSampleOffsets[i.cttsSampleOffsets.length-1]===t?i.cttsSampleCounts[i.cttsSampleCounts.length-1]++:(i.cttsSampleCounts.push(1),i.cttsSampleOffsets.push(t))}i.lastPts=(c||n)>i.lastPts?c||n:i.lastPts,i.lastDts=n}return 0}writeTrailer(t){if(this.context.fragment)h.__(this.context.currentFragment.tracks,(e=>{const r=t.streams.find((t=>t.index===e.streamIndex)).privData;e.sampleCount&&(e.sampleDurations.length?e.sampleDurations.push(e.sampleDurations[e.sampleDurations.length-1]):e.sampleDurations=[r.lastDuration])})),this.updateCurrentFragment(t),t.ioWriter.writeUint32(8),t.ioWriter.writeString("mfra"),t.ioWriter.flush();else{this.updateCurrentChunk(t);let e,r=BigInt(0);h.__(t.streams,(t=>{const i=t.privData;i.sampleSizes.length&&(i.sttsSampleDeltas.length?i.sttsSampleCounts[i.sttsSampleCounts.length-1]++:(i.sttsSampleCounts=[1],i.sttsSampleDeltas=[0])),i.lastPts>r&&(r=i.lastPts,e=t.timeBase)})),r&&(this.context.duration=(0,A.k)(r,e,{den:1e3,num:1}));const i=this.context.boxsPositionInfo[this.context.boxsPositionInfo.length-1];if("mdat"!==i.type&&w.z3("last box is not mdat",D,751),i.size=Number(t.ioWriter.getPos()-i.pos),(0,g.A)(t.ioWriter,this.context),this.options.fastOpen){t.ioWriter.flush();let e=[];const r=t.ioWriter.onFlush;t.ioWriter.onFlush=t=>(e.push(t.slice()),0),p.dI(t.ioWriter,t,this.context),t.ioWriter.flush();let i=(0,U.A)(Uint8Array,e);h.__(t.streams,(t=>{const e=t.privData;if(e.chunkOffsets.length)for(let t=0;t<e.chunkOffsets.length;t++)e.chunkOffsets[t]+=BigInt(Math.floor(i.length))})),e=[],p.dI(t.ioWriter,t,this.context),t.ioWriter.flush(),i=(0,U.A)(Uint8Array,e),r&&r(i,this.context.holdMoovPos),t.ioWriter.onFlush=r}else p.dI(t.ioWriter,t,this.context),t.ioWriter.flush()}return 0}flush(t){return this.options.fragment&&(h.__(this.context.currentFragment.tracks,(e=>{const r=t.streams.find((t=>t.index===e.streamIndex)).privData;e.sampleCount&&(e.sampleDurations.length?e.sampleDurations.push(e.sampleDurations[e.sampleDurations.length-1]):e.sampleDurations=[r.lastDuration])})),this.updateCurrentFragment(t)),t.ioWriter.flush(),0}}},21071:(t,e,r)=>{r.d(e,{_l:()=>i,gQ:()=>n});const i=["hmhd","nmhd","iods","xml ","url ","bxml","ipro","mere","stts","ctts","stss","stsz","stz2","stsc","stco","co64","stsd","dref","mvhd","tkhd","mdhd","hdlr"],n=["moov","trak","edts","mdia","minf","dinf","stbl","mvex","moof","traf","vttc","tref","iref","mfra","hnti","hinf","strd","sinf","rinf","schi","trgr","udta","iprp","ipco","strk","meco"]},3384:(t,e,r)=>{function i(){return{trackId:0,baseDataOffset:BigInt(0),defaultSampleDuration:0,defaultSampleSize:0,defaultSampleFlags:0,baseMediaDecodeTime:BigInt(0),sampleCount:0,dataOffset:0,dataOffsetPos:BigInt(0),firstSampleFlags:0,sampleDurations:[],sampleSizes:[],sampleFlags:[],sampleCompositionTimeOffset:[],baseIsMoof:!1,ioWriter:null,buffers:[]}}r.d(e,{A:()=>i})},9690:(t,e,r)=>{r.d(e,{A:()=>n});var i=r(77231);function n(){return{isom:!1,timescale:i.N_,duration:i.Dh,foundMoov:!1,foundMdat:!1,majorBrand:0,minorVersion:0,compatibleBrand:[],creationTime:BigInt(0),modificationTime:BigInt(0),rate:i.N_,volume:i.N_,matrix:null,nextTrackId:1,fragment:!1,trexs:[],currentFragment:null,boxsPositionInfo:[],holdMoovPos:BigInt(0),currentChunk:null}}},38106:(t,e,r)=>{r.d(e,{A:()=>n});var i=r(77231);function n(){return{chunkOffsets:null,cttsSampleCounts:null,cttsSampleOffsets:null,stscFirstChunk:null,stscSamplesPerChunk:null,stscSampleDescriptionIndex:null,stssSampleNumbersMap:null,stssSampleNumbers:null,sampleSizes:null,sttsSampleCounts:null,sttsSampleDeltas:null,timescale:0,duration:BigInt(0),trackId:i.N_,layer:0,alternateGroup:0,volume:0,matrix:null,width:0,height:0,audioCid:0,samplesPerFrame:0,bytesPerFrame:0,currentSample:0,sampleEnd:!1,samplesIndex:[],fragIndexes:[],lastPts:BigInt(0),lastDts:BigInt(0),startDts:BigInt(0),startCT:0,lastDuration:0,chunkCount:0,firstWrote:!1,lastStscCount:0,perStreamGrouping:!1,index:0,flags:0}}},79804:(t,e,r)=>{r.d(e,{A:()=>n});var i=r(72739);function n(t,e){const r=t.getPos(),n=t.getPointer(),s=r-BigInt(Math.floor(n)),a=[];i.__(e.boxsPositionInfo,(e=>{e.pos<r&&e.pos>=s?(t.seekInline(n+Number(e.pos-r)),t.writeUint32(e.size)):a.push(e)})),i.__(a,(e=>{t.seek(e.pos),t.writeUint32(e.size)})),a.length?t.seek(r):t.seekInline(n),e.boxsPositionInfo=[]}},14202:(t,e,r)=>{r.d(e,{BB:()=>n,Ip:()=>s,Jl:()=>i});const i={1:function(t){return[{type:"tkhd"},{type:"mdia",children:[{type:"mdhd"},{type:"hdlr"},{type:"minf",children:[{type:"smhd"},t.isom?{type:"minf_hdlr"}:null,{type:"dinf",children:[{type:"dref",children:[{type:"url "}]}]},{type:"stbl",children:[{type:"stsd"},{type:"stts"},{type:"stsc"},{type:"stsz"},{type:"stco"}]}]}]}]},0:function(t){return[{type:"tkhd"},{type:"mdia",children:[{type:"mdhd"},{type:"hdlr"},{type:"minf",children:[{type:"vmhd"},t.isom?{type:"minf_hdlr"}:null,{type:"dinf",children:[{type:"dref",children:[{type:"url "}]}]},{type:"stbl",children:[{type:"stsd"},{type:"stts"},{type:"stsc"},{type:"stsz"},{type:"stco"}]}]}]}]}},n={1:function(t){return[{type:"tkhd"},{type:"edts"},{type:"mdia",children:[{type:"mdhd"},{type:"hdlr"},{type:"minf",children:[{type:"smhd"},t.isom?{type:"minf_hdlr"}:null,{type:"dinf",children:[{type:"dref",children:[{type:"url "}]}]},{type:"stbl",children:[{type:"stsd"},{type:"stts"},{type:"stsc"},{type:"stsz"},{type:"stco"}]}]}]}]},0:function(t){return[{type:"tkhd"},{type:"edts"},{type:"mdia",children:[{type:"mdhd"},{type:"hdlr"},{type:"minf",children:[{type:"vmhd"},t.isom?{type:"minf_hdlr"}:null,{type:"dinf",children:[{type:"dref",children:[{type:"url "}]}]},{type:"stbl",children:[{type:"stsd"},{type:"stts"},{type:"stss"},{type:"ctts"},{type:"stsc"},{type:"stsz"},{type:"stco"}]}]}]}]}},s=[{type:"tfhd"},{type:"tfdt"},{type:"trun"}]},6660:(t,e,r)=>{r.d(e,{Q9:()=>s,f3:()=>a,uf:()=>o,zs:()=>n});var i=r(65977);const n={86018:64,86017:105,86076:173,86028:193,86021:221,12:32,27:33,173:35,196:51,167:177,0:0},s={32:12,33:27,35:173,51:196,177:167,64:86018,102:86018,103:86018,104:86018,105:86017,107:86017,173:86076,193:86028,221:86021,0:0},a={vide:0,soun:1,clcp:3,sbtl:3,subt:3,subp:3,text:3},o={[(0,i.A)("mp4a")]:86018,1836253269:86017,[(0,i.A)("Opus")]:86076,[(0,i.A)("fLaC")]:86028,[(0,i.A)("spex")]:86051,[(0,i.A)("SPXN")]:86051,[(0,i.A)("ac-3")]:86019,[(0,i.A)("sac3")]:86019,[i.A.mp4v]:12,[(0,i.A)("av01")]:225,[(0,i.A)("vp08")]:139,[(0,i.A)("vp09")]:167,[(0,i.A)("avc1")]:27,[(0,i.A)("hev1")]:173,[(0,i.A)("hvc1")]:173,[(0,i.A)("vvc1")]:196,[(0,i.A)("vvi1")]:196,[(0,i.A)("text")]:94213,[(0,i.A)("tx3g")]:94213}},75473:(t,e,r)=>{r.d(e,{Ro:()=>u,dI:()=>p,l7:()=>d});var i=r(65977),n=r(21071),s=r(72739),a=r(80025),o=r(14202),c=r(79804);function d(t,e){t.flush();const r=t.getPointer(),n=t.getPos();t.writeUint32(0),t.writeUint32((0,i.A)("ftyp")),t.writeUint32(e.majorBrand||(0,i.A)("isom")),t.writeUint32(e.minorVersion||512),s.__(e.compatibleBrand,(e=>{t.writeUint32(e)})),function(t,e,r){const i=t.getPointer();t.seekInline(e),t.writeUint32(r),t.seekInline(i)}(t,r,Number(t.getPos()-n)),e.isom?(t.writeUint32(8),t.writeUint32((0,i.A)("wide"))):e.fragment||(t.writeUint32(8),t.writeUint32((0,i.A)("free")))}function l(t,e,r,o){s.__(e,(e=>{if(!e)return!0;if(a.A[e.type])a.A[e.type](t,r,o);else if(e.children){const n=t.getPos();t.writeUint32(0),t.writeUint32((0,i.A)(e.type)),l(t,e.children,r,o),o.boxsPositionInfo.push({pos:n,type:e.type,size:Number(t.getPos()-n)})}else!function(t,e){const r=s.zy(n._l,e);t.writeUint32(r?12:8),t.writeUint32((0,i.A)(e)),r&&t.writeUint32(0)}(t,e.type)}))}function p(t,e,r){const n=t.getPos();if(t.writeUint32(0),t.writeUint32((0,i.A)("moov")),a.A.mvhd(t,null,r),s.__(e.streams,(e=>{const n=t.getPos();t.writeUint32(0),t.writeUint32((0,i.A)("trak")),l(t,r.fragment?o.Jl[e.codecpar.codecType](r):o.BB[e.codecpar.codecType](r),e,r),r.boxsPositionInfo.push({pos:n,type:"trak",size:Number(t.getPos()-n)})})),r.fragment){const n=t.getPos();t.writeUint32(0),t.writeUint32((0,i.A)("mvex")),s.__(e.streams,(e=>{a.A.trex(t,e,r)})),r.boxsPositionInfo.push({pos:n,type:"mvex",size:Number(t.getPos()-n)})}r.boxsPositionInfo.push({pos:n,type:"moov",size:Number(t.getPos()-n)}),(0,c.A)(t,r)}function u(t,e,r){const n=t.getPos();t.writeUint32(0),t.writeUint32((0,i.A)("moof")),a.A.mfhd(t,null,r),s.__(r.currentFragment.tracks,(n=>{if(!n.sampleCount)return!0;const s=t.getPos();t.writeUint32(0),t.writeUint32((0,i.A)("traf"));const a=e.streams.find((t=>t.privData.trackId===n.trackId));l(t,o.Ip,a,r),r.boxsPositionInfo.push({pos:s,type:"traf",size:Number(t.getPos()-s)})}));const c=Number(t.getPos()-n);r.boxsPositionInfo.push({pos:n,type:"moof",size:c}),r.currentFragment.size=c}},39878:(t,e,r)=>{r.d(e,{A:()=>n});var i=r(14686);function n(t,e,r){var n;t.writeUint32(null!==(n=8+e.codecpar.extradataSize)&&void 0!==n?n:0),t.writeString("av1C"),r.fragment&&e.sideData[1]?(t.writeBuffer(e.sideData[1]),delete e.sideData[1]):e.codecpar.extradata&&t.writeBuffer((0,i.s3)(e.codecpar.extradata,e.codecpar.extradataSize))}},61600:(t,e,r)=>{r.d(e,{A:()=>n});var i=r(14686);function n(t,e,r){var n;t.writeUint32(null!==(n=8+e.codecpar.extradataSize)&&void 0!==n?n:0),t.writeString("avcC"),r.fragment&&e.sideData[1]?(t.writeBuffer(e.sideData[1]),delete e.sideData[1]):e.codecpar.extradata&&t.writeBuffer((0,i.s3)(e.codecpar.extradata,e.codecpar.extradataSize))}},93861:(t,e,r)=>{function i(t,e,r){t.writeUint32(20),t.writeString("btrt"),t.writeUint32(0),t.writeUint32(0),t.writeUint32(0)}r.d(e,{A:()=>i})},34445:(t,e,r)=>{function i(t,e,r){const i=e.privData.chunkOffsets||[];t.writeUint32(8+8*i.length),t.writeString("co64"),t.writeUint8(0),t.writeUint24(0),t.writeUint32(i.length);for(let e=0;e<i.length;e++)t.writeUint64(i[e])}r.d(e,{A:()=>i})},853:(t,e,r)=>{function i(t,e,r){const i=e.sideData[28];if(i)t.writeUint32(12+i.length),t.writeString("colr"),t.writeString("prof"),t.writeBuffer(i);else{const r=2===e.codecpar.colorRange;t.writeUint32(19),t.writeString("colr"),t.writeString("nclx"),t.writeUint16(e.codecpar.colorPrimaries),t.writeUint16(e.codecpar.colorTrc),t.writeUint16(e.codecpar.colorSpace),t.writeUint8(r?128:0)}}r.d(e,{A:()=>i})},18387:(t,e,r)=>{r.d(e,{A:()=>s});var i=r(4624),n="src/avformat/formats/mov/writing/ctts.ts";function s(t,e,r){const s=e.privData,a=s.cttsSampleCounts||[],o=s.cttsSampleOffsets||[];a.length!==o.length&&i.R8("ctts sampleCounts's length is not match sampleOffsets's length",n,39);const c=Math.min(a.length,o.length);t.writeUint32(16+8*c),t.writeString("ctts"),t.writeUint8(1),t.writeUint24(0),t.writeUint32(c);for(let e=0;e<c;e++)t.writeUint32(a[e]),t.writeInt32(o[e])}},80648:(t,e,r)=>{r.d(e,{A:()=>n});var i=r(83314);function n(t,e,r){t.writeUint32(11),t.writeString("dac3");const n=new i.A(3),s=r.ac3Info;n.writeU(2,s.substream[0].fscod),n.writeU(5,s.substream[0].bsid),n.writeU(3,s.substream[0].bsmod),n.writeU(3,s.substream[0].acmod),n.writeU(1,s.substream[0].lfeon),n.writeU(5,s.ac3BitrateCode),n.writeU(5,0),t.writeBuffer(n.getBuffer())}},55668:(t,e,r)=>{r.d(e,{A:()=>n});var i=r(83314);function n(t,e,r){const n=r.ac3Info,s=new i.A(2+(34*(n.numIndSub+1)+7>>3));s.writeU(13,n.dataRate),s.writeU(3,n.numIndSub);for(let t=0;t<n.numIndSub;t++)s.writeU(2,n.substream[t].fscod),s.writeU(5,n.substream[t].bsid),s.writeU(1,0),s.writeU(1,0),s.writeU(3,n.substream[t].bsmod),s.writeU(3,n.substream[t].acmod),s.writeU(1,n.substream[t].lfeon),s.writeU(5,0),s.writeU(4,n.substream[t].numDepSub),n.substream[t].numDepSub?s.writeU(9,n.substream[t].chanLoc):s.writeU(1,0);s.padding();const a=s.getPointer();t.writeUint32(8+a),t.writeString("dec3"),t.writeBuffer(s.getBuffer().subarray(0,a))}},47280:(t,e,r)=>{r.d(e,{A:()=>a});var i=r(14686),n=r(4624),s="src/avformat/formats/mov/writing/dfla.ts";function a(t,e,r){let a;r.fragment&&e.sideData[1]?(a=e.sideData[1],delete e.sideData[1]):e.codecpar.extradata&&(a=(0,i.s3)(e.codecpar.extradata,e.codecpar.extradataSize)),a?(t.writeUint32(a.length+16),t.writeString("dfLa"),t.writeUint8(0),t.writeUint24(0),t.writeUint8(128),t.writeUint24(a.length),t.writeBuffer(a)):n.z3("invalid extradata",s,56)}},82181:(t,e,r)=>{r.d(e,{A:()=>s});var i=r(14686),n=r(31865);function s(t,e,r){let s;if(r.fragment&&e.sideData[1]?(s=e.sideData[1],delete e.sideData[1]):e.codecpar.extradata&&(s=(0,i.s3)(e.codecpar.extradata,e.codecpar.extradataSize)),!s||s.length<19)t.writeUint32(19),t.writeString("dOps"),t.writeUint8(0),t.writeUint8(e.codecpar.chLayout.nbChannels),t.writeUint16(e.codecpar.initialPadding),t.writeUint32(e.codecpar.sampleRate),t.writeUint16(0),t.writeUint8(0);else{const e=new n.A(s,!1);t.writeUint32(s.length),t.writeString("dOps"),t.writeUint8(0),e.seek(9),t.writeUint8(e.readUint8()),t.writeUint16(e.readUint16()),t.writeUint32(e.readUint32()),t.writeUint16(e.readUint16()),t.writeBuffer(s.subarray(18))}}},12412:(t,e,r)=>{function i(t,e,r){t.writeUint32(28),t.writeString("dref"),t.writeUint32(0),t.writeUint32(1),t.writeUint32(12),t.writeString("url "),t.writeUint32(1)}r.d(e,{A:()=>i})},44473:(t,e,r)=>{r.d(e,{A:()=>s});var i=r(77231),n=r(44328);function s(t,e,r){const s=e.privData;let a=(0,n.k)(s.lastPts,e.timeBase,{den:r.timescale,num:1}),o=s.startCT;const c=(0,n.k)(s.startDts+BigInt(Math.floor(o)),e.timeBase,{den:s.timescale,num:1});let d=a<i.go?0:1;d|=c<i.go?0:1;const l=1+(c>0?1:0),p=24+l*(1===d?20:12);t.writeUint32(p),t.writeString("edts"),t.writeUint32(p-8),t.writeString("elst"),t.writeUint8(d),t.writeUint24(0),t.writeUint32(l),c>0?(1===d?(t.writeUint64(c),t.writeInt64(i.Dh)):(t.writeUint32(Number(c)),t.writeInt32(-1)),t.writeUint32(65536)):(o=-Math.min(Number(s.startDts),0),a+=c),r.fragment&&(a=BigInt(0)),1===d?(t.writeUint64(a),t.writeInt64(BigInt(Math.floor(o)))):(t.writeUint32(Number(a)),t.writeInt32(o)),t.writeUint32(65536)}},4652:(t,e,r)=>{r.d(e,{A:()=>a});var i=r(6660),n=r(14686);function s(t,e,r){t.writeUint8(e);for(let e=3;e>0;e--)t.writeUint8(r>>7*e|128);t.writeUint8(127&r)}function a(t,e,r){const a=e.privData,o=e.codecpar.extradata?5+e.codecpar.extradataSize:0,c=t.getPos();t.writeUint32(0),t.writeString("esds"),t.writeUint32(0),s(t,3,21+o+5+1),t.writeUint16(a.trackId),t.writeUint8(0),s(t,4,13+o),(86016===e.codecpar.codecId||86017===e.codecpar.codecId)&&e.codecpar.sampleRate>24e3?t.writeUint8(107):t.writeUint8(i.zs[e.codecpar.codecId]),94208===e.codecpar.codecId?t.writeUint8(225):1===e.codecpar.codecType?t.writeUint8(21):t.writeUint8(17),t.writeUint24(0),t.writeUint32(0),t.writeUint32(0),e.codecpar.extradata&&(s(t,5,e.codecpar.extradataSize),t.writeBuffer((0,n.s3)(e.codecpar.extradata,e.codecpar.extradataSize))),s(t,6,1),t.writeUint8(2),r.boxsPositionInfo.push({pos:c,type:"esds",size:Number(t.getPos()-c)})}},87384:(t,e,r)=>{function i(t,e,r,i,n,s,a){t.writeUint32(e<<16),t.writeUint32(r<<16),t.writeUint32(0),t.writeUint32(i<<16),t.writeUint32(n<<16),t.writeUint32(0),t.writeUint32(s<<16),t.writeUint32(a<<16),t.writeUint32(1073741824)}r.d(e,{A:()=>i})},17923:(t,e,r)=>{function i(t,e,r){const i=t.getPos();t.writeUint32(0),t.writeString("hdlr"),t.writeUint8(0),t.writeUint24(0);let n="dhlr",s="url ",a="DataHandler";e&&(n="mhlr",1===e.codecpar.codecType?(s="soun",a="SoundHandler"):0===e.codecpar.codecType?(s="vide",a="VideoHandler"):3===e.codecpar.codecType?(s="text",a="SubtitleHandler"):(e.metadata.handlerName&&(a=e.metadata.handlerName),e.metadata.hdlrType&&(s=e.metadata.hdlrType))),t.writeString(n),t.writeString(s),t.writeUint32(0),t.writeUint32(0),t.writeUint32(0),e&&!r.isom||t.writeUint8(a.length),t.writeString(a),e&&!r.isom&&t.writeUint8(0),r.boxsPositionInfo.push({pos:i,type:"hdlr",size:Number(t.getPos()-i)})}r.d(e,{A:()=>i})},78669:(t,e,r)=>{r.d(e,{A:()=>n});var i=r(14686);function n(t,e,r){var n;t.writeUint32(null!==(n=8+e.codecpar.extradataSize)&&void 0!==n?n:0),t.writeString("hvcC"),r.fragment&&e.sideData[1]?(t.writeBuffer(e.sideData[1]),delete e.sideData[1]):e.codecpar.extradata&&t.writeBuffer((0,i.s3)(e.codecpar.extradata,e.codecpar.extradataSize))}},6e3:(t,e,r)=>{r.d(e,{A:()=>n});var i=r(77231);function n(t,e,r){const n=e.privData.lastPts,s=e.metadata.creationTime||0,a=e.metadata.modificationTime||0,o=e.metadata.language||21956;let c=n<BigInt(i.f7)?0:1;c=s<i.f7?0:1,c=a<i.f7?0:1,t.writeUint32(1===c?44:32),t.writeString("mdhd"),t.writeUint8(c),t.writeUint24(0),1===c?(t.writeUint64(s),t.writeUint64(a)):(t.writeUint32(Number(s)),t.writeUint32(Number(a))),t.writeUint32(e.timeBase.den),1===c?t.writeUint64(n):t.writeUint32(Number(n)),t.writeUint16(o),t.writeUint16(0)}},31130:(t,e,r)=>{function i(t,e,r){t.writeUint32(16),t.writeString("mfhd"),t.writeUint8(0),t.writeUint24(0),t.writeUint32(r.currentFragment.sequence)}r.d(e,{A:()=>i})},48669:(t,e,r)=>{r.d(e,{A:()=>n});var i=r(17923);function n(t,e,r){(0,i.A)(t,null,r)}},7114:(t,e,r)=>{r.d(e,{A:()=>s});var i=r(77231),n=r(87384);function s(t,e,r){const s=r.duration,a=r.creationTime||0,o=r.modificationTime||0,c=r.timescale||0;let d=r.nextTrackId||1;r.fragment&&(d=2);let l=s<BigInt(i.f7)?0:1;l=a<i.f7?0:1,l=o<i.f7?0:1,t.writeUint32(1===l?120:108),t.writeString("mvhd"),t.writeUint8(l),t.writeUint24(0),1===l?(t.writeUint64(a),t.writeUint64(o)):(t.writeUint32(Number(a)),t.writeUint32(Number(o))),t.writeUint32(c),1===l?t.writeUint64(s):t.writeUint32(Number(s)),t.writeUint32(65536),t.writeUint16(256),t.writeUint16(0),t.writeUint32(0),t.writeUint32(0),(0,n.A)(t,1,0,0,1,0,0),t.writeUint32(0),t.writeUint32(0),t.writeUint32(0),t.writeUint32(0),t.writeUint32(0),t.writeUint32(0),t.writeUint32(d)}},65629:(t,e,r)=>{function i(t,e,r){t.writeUint32(16),t.writeString("pasp"),t.writeUint32(1),t.writeUint32(1)}r.d(e,{A:()=>i})},33954:(t,e,r)=>{function i(t,e,r){t.writeUint32(16),t.writeString("smhd"),t.writeUint32(0),t.writeUint16(0),t.writeUint16(0)}r.d(e,{A:()=>i})},2204:(t,e,r)=>{function i(t,e,r){const i=e.privData.chunkOffsets||[];t.writeUint32(16+4*i.length),t.writeString("stco"),t.writeUint8(0),t.writeUint24(0),t.writeUint32(i.length);for(let e=0;e<i.length;e++)t.writeUint32(Number(i[e]))}r.d(e,{A:()=>i})},84360:(t,e,r)=>{r.d(e,{A:()=>s});var i=r(4624),n="src/avformat/formats/mov/writing/stsc.ts";function s(t,e,r){const s=e.privData,a=s.stscFirstChunk,o=s.stscSamplesPerChunk,c=s.stscSampleDescriptionIndex;a.length===o.length&&a.length===c.length||i.R8("ctts firstChunk's length is not match samplesPerChunk's length or sampleDescriptionIndex's length",n,42);const d=Math.min(a.length,o.length,c.length);t.writeUint32(16+12*d),t.writeString("stsc"),t.writeUint8(0),t.writeUint24(0),t.writeUint32(d);for(let e=0;e<d;e++)t.writeUint32(a[e]),t.writeUint32(o[e]),t.writeUint32(c[e])}},69301:(t,e,r)=>{r.d(e,{A:()=>S});var i=r(61600),n=r(78669),s=r(1263),a=r(99193),o=r(39878),c=r(47280),d=r(82181),l=r(4652),p=r(853),u=r(65629),f=r(93861),m=r(57756),h=r(80648),w=r(55668),U=r(14686),g=r(61619);const b={27:"avc1",173:"hvc1",196:"vvc1",225:"av01",167:"vp09",86019:"ac-3",86056:"ec-3"};function I(t){if(t.codecTag)return(0,g.A)(t.codecTag);let e=b[t.codecId];return e||(e=0===t.codecType?"mp4v":1===t.codecType?86076===t.codecId?"Opus":86028===t.codecId?"fLaC":"mp4a":3===t.codecType?"text":"none"),e}function S(t,e,r){const g=t.getPos();t.writeUint32(0),t.writeString("stsd"),t.writeUint8(0),t.writeUint24(0),t.writeUint32(1),1===e.codecpar.codecType?function(t,e,r){const i=t.getPos(),n=I(e.codecpar),s=r.isom?1:0;t.writeUint32(0),t.writeString(n),t.writeUint32(0),t.writeUint16(0),t.writeUint16(1),t.writeUint16(s),t.writeUint16(0),t.writeUint32(0),r.isom?(t.writeUint16(e.codecpar.chLayout.nbChannels),65541===e.codecpar.codecId||65540===e.codecpar.codecId?t.writeUint16(8):69643===e.codecpar.codecId?t.writeUint16(e.codecpar.bitsPerCodedSample):t.writeUint16(16),t.writeUint16(-2)):(86028===e.codecpar.codecId||86032===e.codecpar.codecId||86076===e.codecpar.codecId?t.writeUint16(e.codecpar.chLayout.nbChannels):t.writeUint16(2),86028===e.codecpar.codecId||86032===e.codecpar.codecId?t.writeUint16(e.codecpar.bitsPerCodedSample):t.writeUint16(16),t.writeUint16(0)),t.writeUint16(0),86076===e.codecpar.codecId?t.writeUint16(48e3):86060===e.codecpar.codecId?t.writeUint32(e.codecpar.sampleRate):t.writeUint16(e.codecpar.sampleRate),86060!==e.codecpar.codecId&&t.writeUint16(0),1===s&&(t.writeUint32(e.codecpar.frameSize),t.writeUint32(0),t.writeUint32(0),t.writeUint32(2)),!r.isom||86018!==e.codecpar.codecId&&86019!==e.codecpar.codecId&&86056!==e.codecpar.codecId&&73728!==e.codecpar.codecId&&86032!==e.codecpar.codecId&&69638!==e.codecpar.codecId&&69633!==e.codecpar.codecId&&86035!==e.codecpar.codecId?86028===e.codecpar.codecId?(0,c.A)(t,e,r):86076===e.codecpar.codecId?(0,d.A)(t,e,r):86019===e.codecpar.codecId?(0,h.A)(t,e,r):86056===e.codecpar.codecId?(0,w.A)(t,e,r):"mp4a"==n&&(0,l.A)(t,e,r):(0,m.A)(t,e,r),r.isom||(0,f.A)(t,e,r),r.boxsPositionInfo.push({pos:i,type:n,size:Number(t.getPos()-i)})}(t,e,r):0===e.codecpar.codecType?function(t,e,r){const c=t.getPos(),d=I(e.codecpar),m=13==e.codecpar.codecId&&15==e.codecpar.format||13==e.codecpar.codecId&&1==e.codecpar.format||202==e.codecpar.codecId||203==e.codecpar.codecId||156==e.codecpar.codecId||127==e.codecpar.codecId;t.writeUint32(0),t.writeString(d),t.writeUint32(0),t.writeUint16(0),t.writeUint16(1),t.writeUint16(m?2:0),t.writeUint16(0),r.isom?(t.writeString("FFMP"),13===e.codecpar.codecId||m?(t.writeUint32(0),t.writeUint32(1024)):(t.writeUint32(512),t.writeUint32(512))):(t.writeUint32(0),t.writeUint32(0),t.writeUint32(0)),t.writeUint16(e.codecpar.width),t.writeUint16(e.codecpar.height),t.writeUint32(4718592),t.writeUint32(4718592),t.writeUint32(0),t.writeUint16(1);let h=e.metadata.compressorName||"";if(h=h.slice(0,31),t.writeUint8(h.length),t.writeString(h),h.length<31){let e=31-h.length;for(;e>0;)t.writeUint8(0),e--}r.isom&&e.codecpar.bitsPerCodedSample?t.writeUint16(e.codecpar.bitsPerCodedSample):t.writeUint16(24),t.writeUint16(65535),"mp4v"===d?(0,l.A)(t,e,r):27===e.codecpar.codecId?(0,i.A)(t,e,r):173===e.codecpar.codecId?(0,n.A)(t,e,r):196===e.codecpar.codecId?(0,s.A)(t,e,r):167===e.codecpar.codecId?(0,a.A)(t,e,r):225===e.codecpar.codecId&&(0,o.A)(t,e,r),(0,p.A)(t,e,r),(0,u.A)(t,e,r),r.isom||(0,f.A)(t,e,r),r.boxsPositionInfo.push({pos:c,type:d,size:Number(t.getPos()-c)})}(t,e,r):3===e.codecpar.codecType&&function(t,e,r){const i=t.getPos(),n=I(e.codecpar);t.writeUint32(0),t.writeString(n),t.writeUint32(0),t.writeUint16(0),t.writeUint16(1),94208===e.codecpar.codecId?(0,l.A)(t,e,r):e.codecpar.extradata&&t.writeBuffer((0,U.s3)(e.codecpar.extradata,e.codecpar.extradataSize)),r.isom||(0,f.A)(t,e,r),r.boxsPositionInfo.push({pos:i,type:n,size:Number(t.getPos()-i)})}(t,e,r),r.boxsPositionInfo.push({pos:g,type:"esds",size:Number(t.getPos()-g)})}},20184:(t,e,r)=>{function i(t,e,r){const i=e.privData.stssSampleNumbers;t.writeUint32(16+4*i.length),t.writeString("stss"),t.writeUint8(0),t.writeUint24(0),t.writeUint32(i.length);for(let e=0;e<i.length;e++)t.writeUint32(i[e])}r.d(e,{A:()=>i})},57247:(t,e,r)=>{function i(t,e,r){const i=e.privData.sampleSizes;t.writeUint32(20+4*i.length),t.writeString("stsz"),t.writeUint8(0),t.writeUint24(0),t.writeUint32(0),t.writeUint32(i.length);for(let e=0;e<i.length;e++)t.writeUint32(i[e])}r.d(e,{A:()=>i})},86051:(t,e,r)=>{r.d(e,{A:()=>s});var i=r(4624),n="src/avformat/formats/mov/writing/stts.ts";function s(t,e,r){const s=e.privData,a=s.sttsSampleCounts||[],o=s.sttsSampleDeltas||[];a.length!==o.length&&i.R8("stts sampleCounts's length is not match sampleDeltas's length",n,39);const c=Math.min(a.length,o.length);t.writeUint32(16+8*c),t.writeString("stts"),t.writeUint8(0),t.writeUint24(0),t.writeUint32(c);for(let e=0;e<c;e++)t.writeUint32(a[e]),t.writeInt32(o[e])}},11251:(t,e,r)=>{function i(t,e,r){const i=r.currentFragment.tracks.find((t=>t.trackId===e.privData.trackId)),n=i?i.baseMediaDecodeTime:BigInt(0);t.writeUint32(20),t.writeString("tfdt"),t.writeUint8(1),t.writeUint24(0),t.writeUint64(n)}r.d(e,{A:()=>i})},11903:(t,e,r)=>{function i(t,e,r){const i=r.currentFragment.tracks.find((t=>t.trackId===e.privData.trackId));let n=57;i.baseIsMoof&&(n&=-2,n|=131072);const s=t.getPos();t.writeUint32(0),t.writeString("tfhd"),t.writeUint8(0),t.writeUint24(n),t.writeUint32(i.trackId),1&n&&t.writeUint64(i.baseDataOffset),8&n&&t.writeUint32(i.defaultSampleDuration),16&n&&t.writeUint32(i.defaultSampleSize),32&n&&t.writeUint32(i.defaultSampleFlags),r.boxsPositionInfo.push({pos:s,type:"tfhd",size:Number(t.getPos()-s)})}r.d(e,{A:()=>i})},59868:(t,e,r)=>{r.d(e,{A:()=>a});var i=r(77231),n=r(87384),s=r(44328);function a(t,e,r){const a=e.privData,o=(0,s.k)(a.lastPts,e.timeBase,{den:r.timescale,num:1}),c=e.metadata.creationTime||0,d=e.metadata.modificationTime||0,l=a.layer||0,p=a.alternateGroup||0;let u=e.codecpar.width>0?e.codecpar.width:0,f=e.codecpar.height>0?e.codecpar.height:0;u<i.zg&&(u<<=16),f<i.zg&&(f<<=16);let m=o<BigInt(i.f7)?0:1;m=c<i.f7?0:1,m=d<i.f7?0:1;let h=2;1&a.flags&&(h|=1),t.writeUint32(1===m?100:92),t.writeString("tkhd"),t.writeUint8(m),t.writeUint24(h),1===m?(t.writeUint64(c),t.writeUint64(d)):(t.writeUint32(Number(c)),t.writeUint32(Number(d))),t.writeUint32(a.trackId),t.writeUint32(0),1===m?t.writeUint64(o):t.writeUint32(Number(o)),t.writeUint32(0),t.writeUint32(0),t.writeInt16(l),t.writeInt16(a.perStreamGrouping?p:e.codecpar.codecType),1===e.codecpar.codecType?t.writeInt16(256):t.writeInt16(0),t.writeInt16(0),(0,n.A)(t,1,0,0,1,0,0),t.writeUint32(u),t.writeUint32(f)}},35010:(t,e,r)=>{function i(t,e,r){var i,n,s;const a=r.currentFragment.tracks.find((t=>t.trackId===e.privData.trackId)),o=r.trexs.find((t=>{t.trackId,e.privData.trackId})),c=null!==(i=null==o?void 0:o.duration)&&void 0!==i?i:0,d=null!==(n=null==o?void 0:o.size)&&void 0!==n?n:0,l=null!==(s=null==o?void 0:o.flags)&&void 0!==s?s:0;t.writeUint32(32),t.writeString("trex"),t.writeUint8(0),t.writeUint24(0),t.writeUint32(a.trackId),t.writeUint32(1),t.writeUint32(c),t.writeUint32(d),t.writeUint32(l)}r.d(e,{A:()=>i})},48516:(t,e,r)=>{function i(t,e,r){const i=e.privData,n=r.currentFragment.tracks.find((t=>t.trackId===i.trackId)),s=n.firstSampleFlags||0,a=n.dataOffset||0,o=n.sampleDurations,c=n.sampleSizes,d=n.sampleFlags,l=n.sampleCompositionTimeOffset,p=n.sampleCount,u=o.length>0,f=c.length>0,m=d.length>0,h=l.length>0,w=0!==s;let U=1;w&&(U|=4),u&&(U|=256),f&&(U|=512),m&&(U|=1024),h&&(U|=2048);const g=t.getPos();t.writeUint32(0),t.writeString("trun"),t.writeUint8(1),t.writeUint24(U),t.writeUint32(p),n.dataOffsetPos=t.getPos(),t.writeInt32(a),w&&t.writeUint32(s);for(let e=0;e<p;e++)u&&t.writeUint32(o[e]||0),f&&t.writeUint32(c[e]||0),m&&t.writeUint32(d[e]||0),h&&t.writeInt32(l[e]||0);r.boxsPositionInfo.push({pos:g,type:"trun",size:Number(t.getPos()-g)})}r.d(e,{A:()=>i})},54012:(t,e,r)=>{function i(t,e,r){t.writeUint32(20),t.writeString("vmhd"),t.writeUint8(0),t.writeUint24(1),t.writeUint64(BigInt(0))}r.d(e,{A:()=>i})},99193:(t,e,r)=>{r.d(e,{A:()=>n});var i=r(14686);function n(t,e,r){var n;t.writeUint32(null!==(n=12+e.codecpar.extradataSize)&&void 0!==n?n:0),t.writeString("vpcC"),t.writeUint8(1),t.writeUint24(0),r.fragment&&e.sideData[1]?(t.writeBuffer(e.sideData[1]),delete e.sideData[1]):e.codecpar.extradata&&t.writeBuffer((0,i.s3)(e.codecpar.extradata,e.codecpar.extradataSize))}},1263:(t,e,r)=>{r.d(e,{A:()=>n});var i=r(14686);function n(t,e,r){var n;t.writeUint32(null!==(n=8+e.codecpar.extradataSize)&&void 0!==n?n:0),t.writeString("vvcC"),t.writeUint8(0),t.writeUint24(0),r.fragment&&e.sideData[1]?(t.writeBuffer(e.sideData[1]),delete e.sideData[1]):e.codecpar.extradata&&t.writeBuffer((0,i.s3)(e.codecpar.extradata,e.codecpar.extradataSize))}},57756:(t,e,r)=>{r.d(e,{A:()=>s});var i=r(14686),n=r(4652);function s(t,e,r){const s=t.getPos();t.writeUint32(0),t.writeString("wave"),86035!==e.codecpar.codecId&&(t.writeUint32(12),t.writeString("frma"),t.writeUint32(e.codecpar.codecTag)),86018===e.codecpar.codecId?(t.writeUint32(12),t.writeString("mp4a"),t.writeUint32(0),(0,n.A)(t,e,r)):r.fragment&&e.sideData[1]?(t.writeBuffer(e.sideData[1]),delete e.sideData[1]):e.codecpar.extradata&&t.writeBuffer((0,i.s3)(e.codecpar.extradata,e.codecpar.extradataSize)),t.writeUint32(8),t.writeUint32(0),r.boxsPositionInfo.push({pos:s,type:"wave",size:Number(t.getPos()-s)})}},80025:(t,e,r)=>{r.d(e,{A:()=>v});var i=r(86051),n=r(18387),s=r(20184),a=r(57247),o=r(84360),c=r(2204),d=r(34445),l=r(6e3),p=r(7114),u=r(59868),f=r(17923),m=r(69301),h=r(54012),w=r(44473),U=r(33954),g=r(12412),b=r(35010),I=r(31130),S=r(11903),x=r(11251),A=r(48516),y=r(48669);const v={stts:i.A,ctts:n.A,stss:s.A,stsz:a.A,stsc:o.A,stco:c.A,co64:d.A,mdhd:l.A,mvhd:p.A,tkhd:u.A,hdlr:f.A,stsd:m.A,vmhd:h.A,edts:w.A,smhd:U.A,dref:g.A,trex:b.A,mfhd:I.A,tfhd:S.A,tfdt:x.A,trun:A.A,minf_hdlr:y.A}},59989:(t,e,r)=>{function i(t,e=0){if(!t)return!1;if(t.length<2)return!0;let r=t[e],i=e+1;for(;i<t.length&&r===t[i];i++);return i===t.length}r.d(e,{A:()=>i})},61619:(t,e,r)=>{r.d(e,{A:()=>n});var i=r(67672);function n(t,e=4){let r="";for(let n=0;n<e;n++)i.ai(t)?(r=String.fromCharCode(255&t)+r,t>>>=8):(r=String.fromCharCode(Number(t&BigInt(255)))+r,t>>=BigInt(8));return r}},65977:(t,e,r)=>{r.d(e,{A:()=>s});var i=r(4624),n="src/avformat/function/mktag.ts";function s(t){4!==t.length&&i.R8(`tag length is not 4, tag: ${t}`,n,30);let e=0;for(let r=0;r<4;r++)e=e<<8|t.charCodeAt(r);return e}},20841:(t,e,r)=>{function i(t,e,r,i){const n=t.getPos(),s=t.getPointer(),a=n-BigInt(Math.floor(s));let o=!1;switch(e<n&&e>=a?(t.seekInline(s+Number(e-n)),o=!0):t.seek(e),i){case"uint8":t.writeUint8(255&r);break;case"int8":t.writeInt8(r);break;case"uint16":t.writeUint16(65535&r);break;case"int16":t.writeInt16(r);break;case"uint32":t.writeUint32(r>>>0);break;case"int32":t.writeInt32(r);break;case"uint64":t.writeUint64(BigInt.asUintN(64,r));break;case"int64":t.writeInt64(r);break;case"float":t.writeFloat(r);break;case"double":t.writeDouble(r)}o?t.seekInline(s):t.seek(n)}r.d(e,{A:()=>i})}}]);