"use strict";(self.webpackChunkAVTranscoder=self.webpackChunkAVTranscoder||[]).push([[47],{58469:(e,t,i)=>{i.d(t,{En:()=>o,Hm:()=>s,Ij:()=>c,XC:()=>l,_5:()=>d,hY:()=>n,uF:()=>r});var a=i(77231);const r={1:"Main",2:"LC",3:"LC",4:"LC",5:"HE",6:"HE"},s={96e3:0,88200:1,64e3:2,48e3:3,44100:4,32e3:5,24e3:6,22050:7,16e3:8,12e3:9,11025:10,8e3:11,7350:12},n=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350,a.N_,a.N_,a.N_],o=[a.N_,1,2,3,4,5,6,7];function d(e){let t=a.N_,i=a.N_,r=a.N_;var s,d;return e.length>=2&&(t=e[0]>>3&31,i=null!==(s=n[(7&e[0])<<1|e[1]>>7])&&void 0!==s?s:48e3,r=null!==(d=o[e[1]>>3&15])&&void 0!==d?d:2),{profile:t,sampleRate:i,channels:r}}function l(e,t){if(!t&&e.sideData[1]&&(t=e.sideData[1]),t){const{profile:i,sampleRate:a,channels:r}=d(t);e.codecpar.profile=i,e.codecpar.sampleRate=a,e.codecpar.chLayout.nbChannels=r}}function c(e){const t=s[e.sampleRate],i=e.chLayout.nbChannels,a=new Uint8Array(2);return a[0]=(31&e.profile)<<3|(14&t)>>1,a[1]=(1&t)<<7|(15&i)<<3,a}},87771:(e,t,i)=>{i.d(t,{R:()=>p,j:()=>s});var a=i(14686),r=i(37246);const s=[3,4,3,7,259,263,1539,1543],n=[[64,69,96],[64,70,96],[80,87,120],[80,88,120],[96,104,144],[96,105,144],[112,121,168],[112,122,168],[128,139,192],[128,140,192],[160,174,240],[160,175,240],[192,208,288],[192,209,288],[224,243,336],[224,244,336],[256,278,384],[256,279,384],[320,348,480],[320,349,480],[384,417,576],[384,418,576],[448,487,672],[448,488,672],[512,557,768],[512,558,768],[640,696,960],[640,697,960],[768,835,1152],[768,836,1152],[896,975,1344],[896,976,1344],[1024,1114,1536],[1024,1115,1536],[1152,1253,1728],[1152,1254,1728],[1280,1393,1920],[1280,1394,1920]],o=[4,5,6,5],d=[4,6,7,6],l=[48e3,44100,32e3,0],c=[32,40,48,56,64,80,96,112,128,160,192,224,256,320,384,448,512,576,640],f=[2,1,2,3,3,4,4,5],u=[1,2,3,6],h=7;function p(e,t){const i=new r.A(t);i.appendBuffer((0,a.s3)(e,t));const p={syncWord:0,crc1:0,srCode:0,bitstreamId:0,bitstreamMode:0,channelMode:0,lfeOn:0,frameType:0,substreamId:0,centerMixLevel:0,surroundMixLevel:0,channelMap:0,numBlocks:0,dolbySurroundMode:0,srShift:0,sampleRate:0,bitRate:0,channels:0,frameSize:0,channelLayout:BigInt(0),ac3BitrateCode:0};if(p.syncWord=i.readU(16),2935!==p.syncWord)return-1;if(p.bitstreamId=31&i.readU(29),p.bitstreamId>16)return-2;if(p.numBlocks=6,p.ac3BitrateCode=-1,p.centerMixLevel=5,p.surroundMixLevel=6,p.dolbySurroundMode=0,p.bitstreamId<=10){if(p.crc1=i.readU(16),p.srCode=i.readU(2),3===p.srCode)return-3;const e=i.readU(6);if(e>37)return-4;p.ac3BitrateCode=e>>1,i.readU(5),p.bitstreamMode=i.readU(3),p.channelMode=i.readU(3),2==p.channelMode?p.dolbySurroundMode=i.readU(2):(1&p.channelMode&&1!=p.channelMode&&(p.centerMixLevel=o[i.readU(2)]),4&p.channelMode&&(p.surroundMixLevel=d[i.readU(2)])),p.lfeOn=i.readU(1),p.srShift=Math.max(p.bitstreamId,8)-8,p.sampleRate=l[p.srCode]>>p.srShift,p.bitRate=1e3*c[p.ac3BitrateCode]>>p.srShift,p.channels=f[p.channelMode]+p.lfeOn,p.frameSize=2*n[e][p.srCode],p.frameType=2,p.substreamId=0}else{if(p.crc1=0,p.frameType=i.readU(2),3==p.frameType)return-5;if(p.substreamId=i.readU(3),p.frameSize=i.readU(11)+1<<1,p.frameSize<h)return-6;if(p.srCode=i.readU(2),3==p.srCode){const e=i.readU(2);if(3==e)return-7;p.sampleRate=l[e]/2,p.srShift=1}else p.numBlocks=u[i.readU(2)],p.sampleRate=l[p.srCode],p.srShift=0;p.channelMode=i.readU(3),p.lfeOn=i.readU(1),p.bitRate=8*p.frameSize*p.sampleRate/(256*p.numBlocks),p.channels=f[p.channelMode]+p.lfeOn}return p.channelLayout=BigInt.asUintN(64,s[p.channelMode]),p.lfeOn&&(p.channelLayout|=BigInt(8)),p}},90412:(e,t,i)=>{i.d(t,{Ui:()=>h,XC:()=>u,Yj:()=>p,k9:()=>f,zk:()=>d});var a=i(63939),r=i(37246),s=i(11573),n=i(83314),o=i(97317);const d={0:"Main",1:"High",2:"Professional"},l=[{level:20,maxResolution:2359296},{level:21,maxResolution:4460544},{level:30,maxResolution:10653696},{level:31,maxResolution:17040384},{level:40,maxResolution:21233664},{level:41,maxResolution:21233664},{level:50,maxResolution:35651584},{level:51,maxResolution:35651584},{level:52,maxResolution:35651584},{level:53,maxResolution:35651584},{level:60,maxResolution:142606336},{level:61,maxResolution:142606336},{level:62,maxResolution:142606336},{level:63,maxResolution:142606336}],c=[20,21,22,23,30,31,32,33,40,41,42,43,50,51,52,53,60,61,62,63,70,71,72,73];function f(e,t,i){const a=e*t;for(const e of l)if(a<=e.maxResolution)return e.level}function u(e,t){if(!t&&e.sideData[1]&&(t=e.sideData[1]),t&&t.length>=4){const i=h(t);e.codecpar.profile=i.profile,e.codecpar.level=i.level}}function h(e){const t=new r.A(e.length);t.appendBuffer(e),t.readU1(),t.readU(7);const i=t.readU(3),a=t.readU(5),s=t.readU1();let n=t.readU1()?10:8;return t.readU1()&&(n=12),{profile:i,level:a,tier:s,bitDepth:n,monochrome:t.readU1(),chromaSubsamplingX:t.readU1(),chromaSubsamplingY:t.readU1(),chromaSamplePosition:t.readU(2)}}function p(e,t){const i=new n.A(4);i.writeU1(1),i.writeU(7,1);const d=function(e){const t=new r.A;t.appendBuffer(e);const i=[];for(;t.remainingLength();){const a=t.getPos();t.readU1(),t.readU(4);const r=t.readU1(),n=t.readU1();t.readU1(),r&&t.readU(8);const o=n?s.v(t):e.length-1-r,d=t.getPos()-a;i.push(e.subarray(a,a+d+o)),t.skip(8*o)}return i}(t).find((e=>1==(e[0]>>>3&15)));if(d){const e=function(e){const t=new r.A(e.length);t.appendBuffer(e),t.readU1(),t.readU(4);const i=t.readU1(),a=t.readU1();t.readU1(),i&&t.readU(8),a&&s.v(t);const n=s.f(t,3),o=(s.f(t,1),s.f(t,1));let d=0,l=0,f=[0],u=[0],h=[0],p=[0],m=[0],w=[0],g=0,U=[0],b=[0],v=[0];if(o)u[0]=s.f(t,5);else{d=s.f(t,1),d?(s.f(t,32),s.f(t,32),s.f(t,1)&&s.d(t),s.f(t,1)&&(g=s.f(t,5),s.f(t,32),s.f(t,5),s.f(t,5))):l=0;let e=s.f(t,1),i=s.f(t,5);for(let a=0;a<=i;a++){if(f[a]=s.f(t,12),u[a]=s.f(t,5),u[a]>7?h[a]=s.f(t,1):h[a]=0,l){if(p[a]=s.f(t,1),p[a]){let e=g+1;U[a]=s.f(t,e),b[a]=s.f(t,e),v[a]=s.f(t,1)}}else p[a]=0;e&&(m[a]=s.f(t,1),m[a]&&(w[a]=s.f(t,4)))}}let x=s.f(t,4),z=s.f(t,4),k=x+1,A=s.f(t,k);k=z+1;let P=s.f(t,k),y=0,S=0,I=0;y=o?0:s.f(t,1),y&&(s.f(t,4),s.f(t,3)),s.f(t,1),s.f(t,1),s.f(t,1);let B=0,_=0,R=0,M=0,D=0,F=0,C=2,L=2,N=0;o||(s.f(t,1),s.f(t,1),s.f(t,1),s.f(t,1),M=s.f(t,1),M?(D=s.f(t,1),F=s.f(t,1)):(D=0,F=0),C=s.f(t,1)?2:s.f(t,1),C>0?s.f(t,1)?2:s.f(t,1):2,M&&s.f(t,3)),s.f(t,1),s.f(t,1),s.f(t,1);let $=s.f(t,1),E=0,O=0,T=0;2==n&&$?(E=s.f(t,1),O=E?12:10):n<=2&&(O=$?10:8),T=1==n?0:s.f(t,1);let W=0,Y=0,X=0;s.f(t,1)?(W=s.f(t,8),Y=s.f(t,8),X=s.f(t,8)):(W=2,Y=2,X=2);let H=0,J=0,j=0,V=0,G=0;return T?(H=s.f(t,1),J=1,j=1,V=0,G=0):1==W&&13==Y&&0==X?(H=1,J=0,j=0,G=s.f(t,1)):(H=s.f(t,1),0==n?(J=1,j=1):1==n?(J=0,j=0):12==O?(J=s.f(t,1),j=J?s.f(t,1):0):(J=1,j=0),J&&j&&(V=s.f(t,2)),G=s.f(t,1)),s.f(t,1),{width:A+1,height:P+1,profile:n,level:c[u[0]],tier:h[0],bitDepth:O,monoChrome:T,colorRange:H,colorPrimaries:W,transferCharacteristics:Y,matrixCoefficients:X,subsamplingX:J,subsamplingY:j,chromaSamplePosition:V}}(d);i.writeU(3,e.profile),i.writeU(5,e.level),i.writeU(1,e.tier),i.writeU(1,e.bitDepth>8?1:0),i.writeU(1,12===e.bitDepth?1:0),i.writeU(1,e.monoChrome),i.writeU(1,e.subsamplingX),i.writeU(1,e.subsamplingY),i.writeU(1,e.chromaSamplePosition)}else{const t=o.g[a.f[15](e+28)];i.writeU(3,a.f[15](e+48)),i.writeU(5,a.f[15](e+52)),i.writeU(1,0),i.writeU(1,t.comp[0].depth>8?1:0),i.writeU(1,12===t.comp[0].depth?1:0),i.writeU(1,0),i.writeU(1,1),i.writeU(1,1),i.writeU(1,0)}return i.writeU(8,0),i.getBuffer()}},20620:(e,t,i)=>{i.d(t,{Jk:()=>P,MB:()=>v,OD:()=>A,S1:()=>z,XC:()=>S,ci:()=>y,k9:()=>b,oT:()=>k,tZ:()=>g,wf:()=>I});var a=i(63939),r=i(50932),s=i(72739),n=i(729),o=i(31865),d=i(37246),l=i(4624),c=i(14686),f=i(71517),u=i(60264),h=i(37837),p=i(23991),m="src/avformat/codecs/h264.ts";const w=3,g={66:"Constrained Baseline",77:"Main",100:"High",110:"High10",122:"High422",244:"High444"},U=[{level:10,maxResolution:25344,maxFrameRate:15},{level:11,maxResolution:25344,maxFrameRate:30},{level:12,maxResolution:101376,maxFrameRate:30},{level:13,maxResolution:101376,maxFrameRate:30},{level:20,maxResolution:101376,maxFrameRate:30},{level:21,maxResolution:202752,maxFrameRate:30},{level:22,maxResolution:414720,maxFrameRate:30},{level:30,maxResolution:414720,maxFrameRate:30},{level:31,maxResolution:921600,maxFrameRate:30},{level:32,maxResolution:1310720,maxFrameRate:60},{level:40,maxResolution:2097152,maxFrameRate:30},{level:41,maxResolution:2097152,maxFrameRate:60},{level:42,maxResolution:2228224,maxFrameRate:60},{level:50,maxResolution:8912896,maxFrameRate:30},{level:51,maxResolution:8912896,maxFrameRate:60},{level:52,maxResolution:8912896,maxFrameRate:120},{level:60,maxResolution:35651584,maxFrameRate:30},{level:61,maxResolution:35651584,maxFrameRate:60},{level:62,maxResolution:35651584,maxFrameRate:120}];function b(e,t,i){const a=e*t;for(const e of U)if(a<=e.maxResolution&&i<=e.maxFrameRate)return e.level}function v(e){const t=new o.A(e);t.skip(5);const i=[],a=[],r=[],s=31&t.readUint8();for(let e=0;e<s;e++){const e=t.readUint16();i.push(t.readBuffer(e))}const n=t.readUint8();for(let e=0;e<n;e++){const e=t.readUint16();a.push(t.readBuffer(e))}if(t.remainingSize()>4){t.skip(3);const e=t.readUint8();if(e>0)for(let i=0;i<e;i++){const e=t.readUint16();r.push(t.readBuffer(e))}}return{spss:i,ppss:a,spsExts:r}}function x(e,t,i=[]){e.length>32&&(l.R8(`h264 metadata's sps max length is 32, but get ${e.length}`,m,210),e=e.slice(0,32)),e.length>256&&(l.R8(`h264 metadata's pps max length is 256, but get ${e.length}`,m,214),e=e.slice(0,256));let a=7;a=e.reduce(((e,t)=>e+2+t.length),a),a=t.reduce(((e,t)=>e+2+t.length),a);const r=e[0],o=I(r);66!==o.profile&&77!==o.profile&&88!==o.profile&&(a+=4,i.length&&(a=i.reduce(((e,t)=>e+2+t.length),a)));const d=new Uint8Array(a),c=new n.A(d);return c.writeUint8(1),c.writeUint8(r[1]),c.writeUint8(r[2]),c.writeUint8(r[3]),c.writeUint8(252|w),c.writeUint8(224|31&e.length),s.__(e,(e=>{c.writeUint16(e.length),c.writeBuffer(e)})),c.writeUint8(t.length),s.__(t,(e=>{c.writeUint16(e.length),c.writeBuffer(e)})),66!==o.profile&&77!==o.profile&&88!==o.profile&&(c.writeUint8(252|o.chromaFormatIdc),c.writeUint8(248|o.bitDepthLumaMinus8),c.writeUint8(248|o.bitDepthChromaMinus8),i.length&&s.__(i,(e=>{c.writeUint16(e.length),c.writeBuffer(e)}))),d}function z(e){let t=(0,u.py)(e);if(t.length>1){const e=[],i=[],a=[];if(t.forEach((t=>{const r=31&t[0];7===r?e.push(t):8===r?i.push(t):13===r&&a.push(t)})),e.length&&i.length)return x(e,i,a)}}function k(e){let t,i=(0,u.py)(e),a=!1;if(i.length>1){const e=[],a=[],r=[];i.forEach((t=>{const i=31&t[0];7===i?e.push(t):8===i?a.push(t):13===i&&r.push(t)})),e.length&&a.length&&(t=x(e,a,r)),i=i.filter((e=>{const t=31&e[0];return 9!==t&&8!==t&&7!==t&&13!==t}))}const r=i.reduce(((e,t)=>e+w+1+t.length),0),o=(0,h.sY)(r),d=(0,c.s3)(o,r),l=new n.A(d);return s.__(i,(e=>{3===w?l.writeUint32(e.length):2===w?l.writeUint24(e.length):1===w?l.writeUint16(e.length):l.writeUint8(e.length),l.writeBuffer(e.subarray(0)),5==(31&e[0])&&(a=!0)})),{bufferPointer:o,length:r,key:a,extradata:t}}function A(e,t){const i=t?3&t[4]:w;let a=[],r=[],d=[],l=!1;if(t){const e=v(t);a=e.spss,r=e.ppss,d=e.spsExts,l=!0}const f=[],u=[],p=new o.A(e);for(;p.remainingSize()>0;){let t=0;t=3===i?p.readUint32():2===i?p.readUint24():1===i?p.readUint16():p.readUint8();const a=e.subarray(0|Number(0xffffffffn&p.getPos()),(0|Number(0xffffffffn&p.getPos()))+t);p.skip(t);const r=31&a[0];6===r?u.push(a):9!==r&&f.push(a)}let m=a.reduce(((e,t)=>e+4+t.length),0);m=r.reduce(((e,t)=>e+4+t.length),m),m=d.reduce(((e,t)=>e+4+t.length),m),m=u.reduce(((e,t)=>e+4+t.length),m),m=f.reduce(((e,t,i)=>e+(i?3:4)+t.length),m);const g=(0,h.sY)(m+6),U=new n.A((0,c.s3)(g,m+6));return U.writeUint8(0),U.writeUint8(0),U.writeUint8(0),U.writeUint8(1),U.writeUint8(9),U.writeUint8(240),s.__(u,(e=>{U.writeUint8(0),U.writeUint8(0),U.writeUint8(0),U.writeUint8(1),U.writeBuffer(e)})),s.__(a,(e=>{U.writeUint8(0),U.writeUint8(0),U.writeUint8(0),U.writeUint8(1),U.writeBuffer(e)})),s.__(r,(e=>{U.writeUint8(0),U.writeUint8(0),U.writeUint8(0),U.writeUint8(1),U.writeBuffer(e)})),s.__(d,(e=>{U.writeUint8(0),U.writeUint8(0),U.writeUint8(0),U.writeUint8(1),U.writeBuffer(e)})),s.__(f,((e,t)=>{U.writeUint8(0),U.writeUint8(0),t||U.writeUint8(0),U.writeUint8(1),U.writeBuffer(e),5==(31&e[0])&&(l=!0)})),{bufferPointer:g,length:m+6,key:l}}function P(e,t){var i;if(!(1&a.f[15](e+36)))return;const r=(0,f.iI)(e);if((0,u.Bs)(r))return;const s=null!==(i=t.metadata.naluLengthSizeMinusOne)&&void 0!==i?i:w;let n=[],d=[],l=[],p=[];const m=new o.A(r);for(;m.remainingSize()>0;){let e=0;e=3===s?m.readUint32():2===s?m.readUint24():1===s?m.readUint16():m.readUint8();const t=r.subarray(0|Number(0xffffffffn&m.getPos()),(0|Number(0xffffffffn&m.getPos()))+e);m.skip(e);const i=31&t[0];7===i?n.push(t):8===i?d.push(t):13===i?l.push(t):p.push(t)}if(n.length||d.length){const t=x(n,d,l),i=(0,h.sY)(t.length);(0,c.lW)(i,t.length,t),(0,f.Ow)(e,1,i,t.length)}}function y(e,t=!1){if(!(1&a.f[15](e+36)||t))return;const i=(0,f.iI)(e);if(!(0,u.Bs)(i))return;let s=(0,u.py)(i);if(s.length>1){const t=[],i=[],n=[];if(s.forEach((e=>{const a=31&e[0];7===a?t.push(e):8===a?i.push(e):13===a&&n.push(e)})),t.length&&i.length){const s=x(t,i,n),o=(0,h.sY)(s.length);(0,c.lW)(o,s.length,s),(0,f.Ow)(e,1,o,s.length),r.M[15](e+36,1|a.f[15](e+36))}}}function S(e,t){if(!t&&e.sideData[1]&&(t=e.sideData[1]),t&&t.length>=6){e.metadata.naluLengthSizeMinusOne=3&t[4];const{spss:i}=v(t);if(i.length){const{profile:t,level:a,width:r,height:s}=I(i[0]);e.codecpar.profile=t,e.codecpar.level=a,e.codecpar.width=r,e.codecpar.height=s}}}function I(e){if(!e||e.length<3)return;let t=0;0===e[0]&&0===e[1]&&0===e[2]&&1===e[3]&&(t=4);const i=(0,u.BN)(e.subarray(t)),a=new d.A(i.length);a.appendBuffer(i),a.readU1(),a.readU(2),a.readU(5);const r=a.readU(8);a.readU1(),a.readU1(),a.readU1(),a.readU1(),a.readU1(),a.readU1(),a.readU(2);const s=a.readU(8);p.xb(a);let n=1,o=0,l=0;if((100==r||110==r||122==r||244==r||44==r||83==r||86==r||118==r||128==r||138==r||139==r||134==r||135==r)&&(n=p.xb(a),3===n&&a.readU1(),o=p.xb(a),l=p.xb(a),a.readU1(),a.readU1())){const e=new Array(8);for(let t=0;t<(3!=n?8:12);t++)e[t]=a.readU1()}const c=p.xb(a),f=p.xb(a);let h=0,m=0;if(0===f)h=p.xb(a);else if(1===f){m=a.readU1(),p.$x(a),p.$x(a);const e=p.xb(a);for(let t=0;t<e;t++)p.$x(a)}p.xb(a),a.readU1();const w=p.xb(a),g=p.xb(a),U=a.readU1();let b=16*(w+1),v=(2-U)*(g+1)*16;U||a.readU1(),a.readU1();const x=a.readU1();if(x){let e=1,t=2-x;1===n?(e=2,t=2*(2-x)):2===x&&(e=2,t=2-x),b-=e*(p.xb(a)+p.xb(a)),v-=t*(p.xb(a)+p.xb(a))}return{profile:r,level:s,width:b,height:v,chromaFormatIdc:n,bitDepthLumaMinus8:o,bitDepthChromaMinus8:l,frameMbsOnlyFlag:U,picOrderCntType:f,log2MaxPicOrderCntLsbMinus4:h,deltaPicOrderAlwaysZeroFlag:m,log2MaxFrameNumMinus4:c}}},53e3:(e,t,i)=>{i.d(t,{HL:()=>U,Jk:()=>k,OD:()=>z,S1:()=>v,XC:()=>P,ZU:()=>S,ci:()=>A,dT:()=>p,k9:()=>w,oT:()=>x,wf:()=>y});var a=i(63939),r=i(50932),s=i(72739),n=i(729),o=i(31865),d=i(37246),l=i(14686),c=i(60264),f=i(71517),u=i(37837),h=i(23991);const p={1:"Main",2:"Main10",3:"MainStillPicture",4:"Main444"},m=[{level:10,maxLumaSamplesPerSecond:552960,maxLumaPictureSize:36864,maxBitRate:{main:128,main10:150}},{level:20,maxLumaSamplesPerSecond:3686400,maxLumaPictureSize:122880,maxBitRate:{main:1500,main10:1875}},{level:21,maxLumaSamplesPerSecond:7372800,maxLumaPictureSize:245760,maxBitRate:{main:3e3,main10:3750}},{level:30,maxLumaSamplesPerSecond:16588800,maxLumaPictureSize:552960,maxBitRate:{main:6e3,main10:7500}},{level:31,maxLumaSamplesPerSecond:33177600,maxLumaPictureSize:983040,maxBitRate:{main:1e4,main10:12500}},{level:40,maxLumaSamplesPerSecond:66846720,maxLumaPictureSize:2228224,maxBitRate:{main:12e3,main10:15e3}},{level:41,maxLumaSamplesPerSecond:133693440,maxLumaPictureSize:2228224,maxBitRate:{main:2e4,main10:25e3}},{level:50,maxLumaSamplesPerSecond:267386880,maxLumaPictureSize:8912896,maxBitRate:{main:25e3,main10:4e4}},{level:51,maxLumaSamplesPerSecond:534773760,maxLumaPictureSize:8912896,maxBitRate:{main:4e4,main10:6e4}},{level:52,maxLumaSamplesPerSecond:1069547520,maxLumaPictureSize:35651584,maxBitRate:{main:6e4,main10:1e5}},{level:60,maxLumaSamplesPerSecond:1069547520,maxLumaPictureSize:35651584,maxBitRate:{main:6e4,main10:1e5}},{level:61,maxLumaSamplesPerSecond:2139095040,maxLumaPictureSize:89128960,maxBitRate:{main:12e4,main10:24e4}},{level:62,maxLumaSamplesPerSecond:4278190080,maxLumaPictureSize:356515840,maxBitRate:{main:24e4,main10:48e4}}];function w(e,t,i,a,r){r/=1e3;const s=1===e?"main":"main10",n=t*i*a;for(const e of m)if(n<=e.maxLumaSamplesPerSecond&&t*i<=e.maxLumaPictureSize&&r<=e.maxBitRate[s])return e.level}const g=3;function U(e){const t=new o.A(e,!0);t.skip(22);let i=[],a=[],r=[];const s=t.readUint8();for(let e=0;e<s;e++){const e=63&t.readUint8(),s=t.readUint16(),n=[];for(let e=0;e<s;e++){const e=t.readUint16();n.push(t.readBuffer(e))}32===e?i=n:33===e?a=n:34===e&&(r=n)}return{vpss:i,spss:a,ppss:r}}function b(e,t,i){const a=t[0];let r=23;e.length&&(r+=3,r=e.reduce(((e,t)=>e+2+t.length),r)),t.length&&(r+=3,r=t.reduce(((e,t)=>e+2+t.length),r)),i.length&&(r+=3,r=i.reduce(((e,t)=>e+2+t.length),r));const o=new Uint8Array(r),d=new n.A(o,!0),l=y(a);d.writeUint8(1),d.writeUint8(a[1]),d.writeUint8(a[2]),d.writeUint8(a[3]),d.writeUint8(a[4]),d.writeUint8(a[5]),d.writeUint8(a[6]),d.writeUint8(a[7]),d.writeUint8(a[8]),d.writeUint8(a[9]),d.writeUint8(a[10]),d.writeUint8(a[11]),d.writeUint8(l.level),d.writeUint8(1020),d.writeUint8(0),d.writeUint8(16320),d.writeUint8(16320|l.chroma_format_idc),d.writeUint8(8160|l.bit_depth_luma_minus8),d.writeUint8(8160|l.bit_depth_chroma_minus8),d.writeUint16(0),d.writeUint8(8|(1&a[0])<<2|g);let c=0;return e.length&&c++,t.length&&c++,i.length&&c++,d.writeUint8(c),e.length&&(d.writeUint8(160),d.writeUint16(e.length),s.__(e,(e=>{d.writeUint16(e.length),d.writeBuffer(e)}))),t.length&&(d.writeUint8(161),d.writeUint16(t.length),s.__(t,(e=>{d.writeUint16(e.length),d.writeBuffer(e)}))),i.length&&(d.writeUint8(162),d.writeUint16(i.length),s.__(i,(e=>{d.writeUint16(e.length),d.writeBuffer(e)}))),o}function v(e){let t=(0,c.py)(e);if(t.length>=2){const e=[],i=[],a=[];if(t.forEach((t=>{const r=t[0]>>>1&63;32===r?e.push(t):33===r?i.push(t):34===r&&a.push(t)})),i.length&&a.length)return b(e,i,a)}}function x(e){let t,i=!1,a=(0,c.py)(e);if(a.length>=2){const e=[],i=[],r=[];a.forEach((t=>{const a=t[0]>>>1&63;32===a?e.push(t):33===a?i.push(t):34===a&&r.push(t)})),i.length&&r.length&&(t=b(e,i,r),a=a.filter((e=>{const t=e[0]>>>1&63;return 32!==t&&33!==t&&34!==t&&35!==t})))}const r=a.reduce(((e,t)=>e+g+1+t.length),0),o=(0,u.sY)(r),d=(0,l.s3)(o,r),f=new n.A(d);return s.__(a,(e=>{3===g?f.writeUint32(e.length):2===g?f.writeUint24(e.length):1===g?f.writeUint16(e.length):f.writeUint8(e.length),f.writeBuffer(e.subarray(0));const t=e[0]>>>1&63;19!==t&&20!==t&&21!==t||(i=!0)})),{bufferPointer:o,length:r,extradata:t,key:i}}function z(e,t){const i=t?3&t[21]:g;let a=[],r=[],d=[],c=!1;if(t){const e=U(t);a=e.vpss,r=e.spss,d=e.ppss,c=!0}const f=[],h=new o.A(e);for(;h.remainingSize()>0;){let e=0;e=3===i?h.readUint32():2===i?h.readUint24():1===i?h.readUint16():h.readUint8(),f.push(h.readBuffer(e))}let p=a.reduce(((e,t)=>e+4+t.length),0);p=r.reduce(((e,t)=>e+4+t.length),p),p=d.reduce(((e,t)=>e+4+t.length),p),p=f.reduce(((e,t,i)=>e+(i?3:4)+t.length),p);const m=(0,u.sY)(p+7),w=(0,l.s3)(m,p+7),b=new n.A(w);return b.writeUint8(0),b.writeUint8(0),b.writeUint8(0),b.writeUint8(1),b.writeUint8(70),b.writeUint8(0),b.writeUint8(240),s.__(a,(e=>{b.writeUint8(0),b.writeUint8(0),b.writeUint8(0),b.writeUint8(1),b.writeBuffer(e)})),s.__(r,(e=>{b.writeUint8(0),b.writeUint8(0),b.writeUint8(0),b.writeUint8(1),b.writeBuffer(e)})),s.__(d,(e=>{b.writeUint8(0),b.writeUint8(0),b.writeUint8(0),b.writeUint8(1),b.writeBuffer(e)})),s.__(f,((e,t)=>{b.writeUint8(0),b.writeUint8(0),t||b.writeUint8(0),b.writeUint8(1),b.writeBuffer(e);const i=e[0]>>>1&63;19!==i&&20!==i&&21!==i||(c=!0)})),{bufferPointer:m,length:p+7,key:c}}function k(e,t){var i;if(!(1&a.f[15](e+36)))return;const r=(0,f.iI)(e);if((0,c.Bs)(r))return;const s=null!==(i=t.metadata.naluLengthSizeMinusOne)&&void 0!==i?i:g;let n=[],d=[],h=[];const p=new o.A(r);for(;p.remainingSize()>0;){let e=0;e=3===s?p.readUint32():2===s?p.readUint24():1===s?p.readUint16():p.readUint8();const t=r.subarray(0|Number(0xffffffffn&p.getPos()),(0|Number(0xffffffffn&p.getPos()))+e);p.skip(e);const i=t[0]>>>1&63;33===i?d.push(t):34===i?h.push(t):32===i&&n.push(t)}if(d.length||h.length||n.length){const t=b(n,d,h),i=(0,u.sY)(t.length);(0,l.lW)(i,t.length,t),(0,f.Ow)(e,1,i,t.length)}}function A(e,t=!1){if(!(1&a.f[15](e+36)||t))return;const i=(0,f.iI)(e);if(!(0,c.Bs)(i))return;let s=(0,c.py)(i);if(s.length>2){const t=[],i=[],n=[];if(s.forEach((e=>{const a=e[0]>>>1&63;32===a?t.push(e):33===a?i.push(e):34===a&&n.push(e)})),t.length&&i.length&&n.length){const s=b(t,i,n),o=(0,u.sY)(s.length);(0,l.lW)(o,s.length,s),(0,f.Ow)(e,1,o,s.length),r.M[15](e+36,1|a.f[15](e+36))}}}function P(e,t){if(!t&&e.sideData[1]&&(t=e.sideData[1]),t&&t.length>=6){e.metadata.naluLengthSizeMinusOne=3&t[21];const{spss:i}=U(t);if(i.length){const{profile:t,level:a,width:r,height:s}=y(i[0]);e.codecpar.profile=t,e.codecpar.level=a,e.codecpar.width=r,e.codecpar.height=s}}}function y(e){if(!e||e.length<3)return;let t=0;0===e[0]&&0===e[1]&&0===e[2]&&1===e[3]&&(t=4);let i=0,a=0,r=0,s=0,n=0,o=0,l=1,f=0,u=0,p=0,m=0;const w=(0,c.BN)(e.subarray(t)),g=new d.A(w.length);g.appendBuffer(w),g.readU1(),g.readU(6),g.readU(6),g.readU(3),g.readU(4);const U=g.readU(3);g.readU1();let b=0;if(U<=6){f=g.readU(2),u=g.readU1(),i=g.readU(5),p=g.readU(32),m=g.readU(48),a=g.readU(8);const e=new Array(6),t=new Array(6);for(let i=0;i<U;i++)e[i]=g.readU1(),t[i]=g.readU1();if(U>0)for(let e=U;e<8;e++)g.readU(2);for(let i=0;i<U;i++)e[i]&&(g.readU(2),g.readU(1),g.readU(5),g.readU(32),g.readU(1),g.readU(1),g.readU(1),g.readU(1),g.readU(44)),t[i]&&g.readU(8);h.xb(g),l=h.xb(g),3===l&&(b=g.readU(1)),r=h.xb(g),s=h.xb(g);let d=0,c=0,w=0,v=0;g.readU1()&&(d=h.xb(g),c=h.xb(g),w=h.xb(g),v=h.xb(g)),n=h.xb(g),o=h.xb(g);let x=2,z=2;0===l?x=z=0:2===l?(x=2,z=1):3===l&&(x=z=1),r-=x*(1<<n+1)*(d+c),s-=z*(1<<n+1)*(w+v)}const v=h.xb(g)+4;for(let e=g.readU1()?0:U;e<U+1;e++)h.xb(g),h.xb(g),h.xb(g);const x=h.xb(g)+3,z=h.xb(g),k=h.xb(g)+2,A=h.xb(g),P=x+z,y=x-1,S=r+(1<<P)-1>>P,I=s+(1<<P)-1>>P;return{profile:i,level:a,width:r,height:s,chroma_format_idc:l,bit_depth_luma_minus8:n,bit_depth_chroma_minus8:o,general_profile_space:f,general_tier_flag:u,general_profile_compatibility_flags:p,constraint_flags:m,separate_colour_plane_flag:b,log2_min_cb_size:x,log2_diff_max_min_coding_block_size:z,log2_min_tb_size:k,log2_diff_max_min_transform_block_size:A,log2_max_trafo_size:A+k,log2_ctb_size:P,log2_min_pu_size:y,ctb_width:S,ctb_height:I,ctb_size:S*I,min_cb_width:r>>x,min_cb_height:s>>x,min_tb_width:r>>k,min_tb_height:s>>k,min_pu_width:r>>y,min_pu_height:s>>y,log2_max_poc_lsb:v}}function S(e){if(!e||e.length<3)return;let t=0;0===e[0]&&0===e[1]&&0===e[2]&&1===e[3]&&(t=4);const i=(0,c.BN)(e.subarray(t)),a=new d.A(i.length);return a.appendBuffer(i),{pps_pic_parameter_set_id:h.xb(a),pps_seq_parameter_set_id:h.xb(a),dependent_slice_segment_flag:a.readU1(),output_flag_present_flag:a.readU1(),num_extra_slice_header_bits:a.readU(3)}}},65451:(e,t,i)=>{i.d(t,{Ij:()=>l,XC:()=>d,kt:()=>o});var a=i(31865),r=i(729),s=i(44328);const n=[480,960,1920,2880,480,960,1920,2880,480,960,1920,2880,480,960,480,960,120,240,480,960,120,240,480,960,120,240,480,960,120,240,480,960];function o(e){let t=0,i=0,a=0;if(e.length<1)return 0;switch(t=e[0],i=n[t>>3],3&t){case 0:a=1;break;case 1:case 2:a=2;break;case 3:if(e.length<2)return 0;a=63&e[1]}return a*i}function d(e,t){if(!t&&e.sideData[1]&&(t=e.sideData[1]),t&&t.length>=19){const i=new a.A(t,!1);i.skip(9),e.codecpar.chLayout.nbChannels=i.readUint8(),e.codecpar.initialPadding=i.readUint16(),e.codecpar.sampleRate=i.readUint32(),e.codecpar.seekPreroll=Number((0,s.k)(BigInt(80),{den:1e3,num:1},{den:48e3,num:1}))}}function l(e){const t=new Uint8Array(19),i=new r.A(t,!1);return i.writeString("OpusHead"),i.writeUint8(1),i.writeUint8(e.chLayout.nbChannels),i.writeUint16(e.initialPadding),i.writeUint32(e.sampleRate),t}},58919:(e,t,i)=>{i.d(t,{Ui:()=>m,XC:()=>p,Yj:()=>w,k9:()=>h,wN:()=>f});var a=i(63939),r=i(9599),s=i(29170),n=i(37246),o=i(77231),d=i(97317),l=i(44328),c=i(729);const f={0:"Profile0",1:"Profile1",2:"Profile2",3:"Profile3"},u=[{level:10,maxResolution:196608,maxFrameRate:30},{level:11,maxResolution:196608,maxFrameRate:60},{level:20,maxResolution:518400,maxFrameRate:30},{level:21,maxResolution:518400,maxFrameRate:60},{level:30,maxResolution:2073600,maxFrameRate:30},{level:31,maxResolution:2073600,maxFrameRate:60},{level:40,maxResolution:3686400,maxFrameRate:30},{level:41,maxResolution:3686400,maxFrameRate:60},{level:50,maxResolution:8294400,maxFrameRate:30},{level:51,maxResolution:8294400,maxFrameRate:60},{level:60,maxResolution:8847360,maxFrameRate:30},{level:61,maxResolution:8847360,maxFrameRate:60},{level:70,maxResolution:35389440,maxFrameRate:30},{level:71,maxResolution:35389440,maxFrameRate:60}];function h(e,t,i){const a=e*t;for(const e of u)if(a<=e.maxResolution&&i<=e.maxFrameRate)return e.level}function p(e,t){if(!t&&e.sideData[1]&&(t=e.sideData[1]),t&&t.length>=6){const i=m(t);e.codecpar.profile=i.profile,e.codecpar.level=i.level}}function m(e){const t=new n.A(e.length);return t.appendBuffer(e),{profile:t.readU(8),level:t.readU(8),bitDepth:t.readU(4),chromaSubsampling:t.readU(3),fullRangeFlag:t.readU1(),colorPrimaries:t.readU(8),colorTrc:t.readU(8),colorSpace:t.readU(8)}}function w(e){const t=new c.A(new Uint8Array(8)),i=function(e){let t=a.f[15](e+48),i=a.f[15](e+52);i===o.N_&&(i=h(a.f[15](e+56),a.f[15](e+60),(0,l.lb)((0,s.A)(e+72,r.P))));const n=d.g[a.f[15](e+28)];let c=a.f[15](e+40),f=1;n&&(c=n.comp[0].depth,1===n.log2ChromaW&&1===n.log2ChromaH?1===a.f[15](e+100)&&(f=0):1===n.log2ChromaW&&0===n.log2ChromaH?f=2:0===n.log2ChromaW&&0===n.log2ChromaH&&(f=3));const u=2===a.f[15](e+84)?1:0;return t===o.N_&&c&&(t=0==f||1==f?8==c?0:2:8==c?1:3),{profile:t,level:i,bitDepth:c,chromaSubsampling:f,fullRange:u}}(e);return t.writeUint8(i.profile),t.writeUint8(i.level),t.writeUint8(i.bitDepth<<4|i.chromaSubsampling<<1|i.fullRange),t.writeUint8(a.f[15](e+88)),t.writeUint8(a.f[15](e+92)),t.writeUint8(a.f[15](e+96)),t.writeUint16(0),t.getWroteBuffer()}},55611:(e,t,i)=>{i.d(t,{Jk:()=>x,OD:()=>v,QA:()=>k,Ui:()=>y,XC:()=>A,ci:()=>z,oT:()=>b,wf:()=>P});var a=i(63939),r=i(50932),s=i(72739),n=i(729),o=i(31865),d=i(37246),l=i(14686),c=i(60264),f=i(71517),u=i(37837),h=i(23991),p=i(83314);const m=3;function w(e){const t=e.readU(9),i=e.readU(3),a=e.readU(2),r=e.readU(2),s=e.readU(3);e.readU(5),e.readU(2);const n=e.readU(6),o=e.readU(7),d=e.readU(1),l=e.readU(8),c=e.readU(1),f=e.readU(1),u=[],h=[];if(n){for(let t=0;t<n-1;t++)u[t]=e.readU(8);u[n-1]=e.readU(6)}else e.readU(6);if(i>1){let t=0;for(let a=i-2;a>=0;--a)t|=e.readU(1)<<a;for(let t=i;t<=8&&i>1;++t)e.readU(1);for(let a=i-2;a>=0;--a)t&1<<a&&(h[a]=e.readU(8))}const p=e.readU(8),m=[];if(p)for(let t=0;t<p;t++)m.push(e.readU(8));return{olsIdx:t,numSublayers:i,bitDepthMinus8:s,chromaFormatIdc:r,constantFrameRate:a,generalProfileIdc:o,generalTierFlag:d,generalLevelIdc:l,ptlFrameOnlyConstraintFlag:c,ptlMultilayerEnabledFlag:f,generalConstraintInfo:u,sublayerLevelIdc:h,generalSubProfileIdc:m,maxPictureWidth:e.readU(16),maxPictureHeight:e.readU(16),avgFramerate:e.readU(16)}}function g(e){const t=new o.A(e,!0);if(1&t.readUint8()){const i=new d.A;i.appendBuffer(e.subarray(1)),w(i),t.skip(i.getPos())}let i=[],a=[],r=[];const s=t.readUint8();for(let e=0;e<s;e++){const e=31&t.readUint8();let s=1;13!==e&&12!==e&&(s=t.readUint16());const n=[];for(let e=0;e<s;e++){const e=t.readUint16();n.push(t.readBuffer(e))}14===e?i=n:15===e?a=n:16===e&&(r=n)}return{vpss:i,spss:a,ppss:r}}function U(e,t,i){const a=t[0];let r;if(a){const e=P(a);let t=e.generalConstraintInfo;t.length||(t=new Array(12).fill(0));const i=new p.A;if(i.writeU(9,0),i.writeU(3,e.spsMaxSublayersMinus1+1),i.writeU(2,1),i.writeU(2,e.chromaFormatIdc),i.writeU(3,e.bitDepthMinus8),i.writeU(5,31),i.writeU(2,0),i.writeU(6,t.length),i.writeU(7,e.profile),i.writeU1(e.tierFlag),i.writeU(8,e.level),i.writeU1(e.ptlFrameOnlyConstraintFlag),i.writeU1(e.ptlMultilayerEnabledFlag),t.length){for(let e=0;e<t.length-1;e++)i.writeU(8,t[e]);i.writeU(6,t[t.length-1])}else i.writeU(6,63);if(e.spsMaxSublayersMinus1+1>1){let t=0;for(let i=e.spsMaxSublayersMinus1-1;i>=0;i--)t=t<<1|e.ptlSublayerLevelPresentFlag[i];i.writeU(e.spsMaxSublayersMinus1,t);for(let t=e.spsMaxSublayersMinus1+1;t<=8&&e.spsMaxSublayersMinus1>0;++t)i.writeU1(0);for(let t=e.spsMaxSublayersMinus1-1;t>=0;t--)e.ptlSublayerLevelPresentFlag[t]&&i.writeU(8,e.sublayerLevelIdc[t])}i.writeU(8,e.generalSubProfileIdc.length);for(let t=0;t<e.generalSubProfileIdc.length;t++)i.writeU(8,e.sublayerLevelIdc[t]);i.writeU(16,e.width),i.writeU(16,e.height),i.writeU(16,0),i.padding(),r=i.getBuffer().subarray(0,i.getPointer())}let o=2+(r?r.length:0);e.length&&(o+=3,o=e.reduce(((e,t)=>e+2+t.length),o)),t.length&&(o+=3,o=t.reduce(((e,t)=>e+2+t.length),o)),i.length&&(o+=3,o=i.reduce(((e,t)=>e+2+t.length),o));const d=new Uint8Array(o),l=new n.A(d,!0);l.writeUint8(m<<1|(r?1:0)|248),r&&l.writeBuffer(r);let c=0;return e.length&&c++,t.length&&c++,i.length&&c++,l.writeUint8(c),e.length&&(l.writeUint8(142),l.writeUint16(e.length),s.__(e,(e=>{l.writeUint16(e.length),l.writeBuffer(e)}))),t.length&&(l.writeUint8(143),l.writeUint16(t.length),s.__(t,(e=>{l.writeUint16(e.length),l.writeBuffer(e)}))),i.length&&(l.writeUint8(144),l.writeUint16(i.length),s.__(i,(e=>{l.writeUint16(e.length),l.writeBuffer(e)}))),d}function b(e){let t,i=!1,a=(0,c.py)(e);if(a.length>=2){const e=[],i=[],r=[];a.forEach((t=>{const a=t[1]>>>3&31;14===a?e.push(t):15===a?i.push(t):16===a&&r.push(t)})),i.length&&r.length&&(t=U(e,i,r),a=a.filter((e=>{const t=e[1]>>>3&31;return 14!==t&&15!==t&&16!==t&&20!==t})))}const r=a.reduce(((e,t)=>e+m+1+t.length),0),o=(0,u.sY)(r),d=(0,l.s3)(o,r),f=new n.A(d);return s.__(a,(e=>{3===m?f.writeUint32(e.length):2===m?f.writeUint24(e.length):1===m?f.writeUint16(e.length):f.writeUint8(e.length),f.writeBuffer(e.subarray(0));const t=e[1]>>>3&31;8!==t&&7!==t&&9!==t&&10!==t||(i=!0)})),{bufferPointer:o,length:r,extradata:t,key:i}}function v(e,t){const i=t?t[0]>>>1&3:m;let a=[],r=[],d=[],c=!1;if(t){const e=g(t);a=e.vpss,r=e.spss,d=e.ppss,c=!0}const f=[],h=new o.A(e);for(;h.remainingSize()>0;){let e=0;e=3===i?h.readUint32():2===i?h.readUint24():1===i?h.readUint16():h.readUint8(),f.push(h.readBuffer(e))}let p=a.reduce(((e,t)=>e+4+t.length),0);p=r.reduce(((e,t)=>e+4+t.length),p),p=d.reduce(((e,t)=>e+4+t.length),p),p=f.reduce(((e,t,i)=>e+(i?3:4)+t.length),p);const w=(0,u.sY)(p+7),U=(0,l.s3)(w,p+7),b=new n.A(U);return b.writeUint8(0),b.writeUint8(0),b.writeUint8(0),b.writeUint8(1),b.writeUint8(0),b.writeUint8(160),b.writeUint8(240),s.__(a,(e=>{b.writeUint8(0),b.writeUint8(0),b.writeUint8(0),b.writeUint8(1),b.writeBuffer(e)})),s.__(r,(e=>{b.writeUint8(0),b.writeUint8(0),b.writeUint8(0),b.writeUint8(1),b.writeBuffer(e)})),s.__(d,(e=>{b.writeUint8(0),b.writeUint8(0),b.writeUint8(0),b.writeUint8(1),b.writeBuffer(e)})),s.__(f,((e,t)=>{b.writeUint8(0),b.writeUint8(0),t||b.writeUint8(0),b.writeUint8(1),b.writeBuffer(e);const i=e[1]>>>3&31;8!==i&&7!==i&&9!==i&&10!==i||(c=!0)})),{bufferPointer:w,length:p+7,key:c}}function x(e,t){var i;if(!(1&a.f[15](e+36)))return;const r=(0,f.iI)(e);if((0,c.Bs)(r))return;const s=null!==(i=t.metadata.naluLengthSizeMinusOne)&&void 0!==i?i:m;let n=[],d=[],h=[];const p=new o.A(r);for(;p.remainingSize()>0;){let e=0;e=3===s?p.readUint32():2===s?p.readUint24():1===s?p.readUint16():p.readUint8();const t=r.subarray(0|Number(0xffffffffn&p.getPos()),(0|Number(0xffffffffn&p.getPos()))+e);p.skip(e);const i=t[1]>>>3&31;15===i?d.push(t):16===i?h.push(t):14===i&&n.push(t)}if(d.length||h.length||n.length){const t=U(n,d,h),i=(0,u.sY)(t.length);(0,l.lW)(i,t.length,t),(0,f.Ow)(e,1,i,t.length)}}function z(e,t=!1){if(!(1&a.f[15](e+36)||t))return;const i=(0,f.iI)(e);if(!(0,c.Bs)(i))return;let s=(0,c.py)(i);if(s.length>2){const t=[],i=[],n=[];if(s.forEach((e=>{const a=e[1]>>>3&31;14===a?t.push(e):15===a?i.push(e):16===a&&n.push(e)})),t.length&&i.length&&n.length){const s=U(t,i,n),o=(0,u.sY)(s.length);(0,l.lW)(o,s.length,s),(0,f.Ow)(e,1,o,s.length),r.M[15](e+36,1|a.f[15](e+36))}}}function k(e,t){const{profile:i,level:a,width:r,height:s}=P(t);e.codecpar.profile=i,e.codecpar.level=a,e.codecpar.width=r,e.codecpar.height=s}function A(e,t){if(!t&&e.sideData[1]&&(t=e.sideData[1]),t&&t.length>=6){e.metadata.naluLengthSizeMinusOne=t[0]>>>1&3;const{spss:i}=g(t);i.length&&k(e,i[0])}}function P(e){if(!e||e.length<3)return;let t=0;0===e[0]&&0===e[1]&&0===e[2]&&1===e[3]&&(t=4);let i=0,a=0,r=0,s=0,n=0,o=1,l=0,f=0,u=0;const p=[],m=[],w=[],g=[],U=(0,c.BN)(e.subarray(t)),b=new d.A(U.length);b.appendBuffer(U),b.readU1(),b.readU1(),b.readU(6),b.readU(5),b.readU(3),b.readU(8);const v=b.readU(3);o=b.readU(2);const x=b.readU(2);if(b.readU(1)){if(i=b.readU(7),l=b.readU(1),a=b.readU(8),f=b.readU(1),u=b.readU(1),b.readU(1)){for(let e=0;e<8;e++)p[e]=b.readU(8);p[8]=b.readU(7);const e=b.readU(8);b.readU(e)}b.skipPadding();for(let e=v-1;e>=0;e--)m[e]=b.readU(1);b.skipPadding();for(let e=v-1;e>=0;e--)m[e]&&(w[e]=b.readU(8));const e=b.readU(8);if(e)for(let t=0;t<e;t++)g[t]=b.readU(32)}b.readU1(),b.readU1()&&b.readU1();const z=r=h.xb(b),k=s=h.xb(b);if(b.readU1()&&(h.xb(b),h.xb(b),h.xb(b),h.xb(b)),b.readU1()){const e=h.xb(b),t=x+5,i=1<<t,a=z/(1<<t),r=k/(1<<t),s=Math.ceil(Math.log2(a)),n=Math.ceil(Math.log2(r));let o=0,d=0,l=0;e>0&&(l=b.readU1(),d=b.readU1());for(let t=0;e>0&&t<=e;t++)d&&0!=t||(t>0&&z>i&&b.readU(s),t>0&&k>i&&b.readU(n),t<e&&z>i&&b.readU(s),t<e&&k>i&&b.readU(n)),l||b.readU(2);if(o=h.xb(b)+1,b.readU(1)&&b.readU(1))for(let t=0;t<=e;t++)b.readU(o)}n=h.xb(b),b.readU(1),b.readU(1);const A=b.readU(4),P=b.readU(1);let y=0;P&&(y=h.xb(b));const S=[],I=b.readU(2);for(let e=0;e<8*I;e++)S[e]=b.readU(1);return{profile:i,level:a,width:r,height:s,chromaFormatIdc:o,bitDepthMinus8:n,generalProfileSpace:0,tierFlag:l,generalConstraintInfo:p,generalSubProfileIdc:g,ptlFrameOnlyConstraintFlag:f,ptlMultilayerEnabledFlag:u,spsMaxSublayersMinus1:v,ptlSublayerLevelPresentFlag:m,sublayerLevelIdc:w,sps_log2_max_pic_order_cnt_lsb_minus4:A,sps_poc_msb_cycle_flag:P,sps_poc_msb_cycle_len_minus1:y,sps_num_extra_ph_bytes:I,sps_extra_ph_bit_present_flag:S}}function y(e){0===e[0]&&0===e[1]&&0===e[2]&&1===e[3]&&(e=function(e){let t=(0,c.py)(e);if(t.length>=2){const e=[],i=[],a=[];if(t.forEach((t=>{const r=t[1]>>>3&31;14===r?e.push(t):15===r?i.push(t):16===r&&a.push(t)})),i.length&&a.length)return U(e,i,a)}}(e));const t=new d.A;return t.appendBuffer(e),1&t.readU(8)?w(t):{}}},85947:(e,t,i)=>{i.d(t,{A:()=>r});var a=i(134);class r{constructor(){(0,a.A)(this,"type",-1),(0,a.A)(this,"onStreamAdd",void 0)}destroy(e){}}},92047:(e,t,i)=>{i.r(t),i.d(t,{default:()=>x});var a=i(134),r=i(63939),s=i(50932),n=i(4624),o=i(9705),d=i(65977),l=i(74963),c=i(85947),f=i(85428),u=i(9690),h=i(72739),p=i(14686),m=i(37837),w=i(71517),g=i(44328),U=i(77231),b=i(39381),v="src/avformat/formats/IMovFormat.ts";class x extends c.A{constructor(e={}){super(),(0,a.A)(this,"type",1),(0,a.A)(this,"context",void 0),(0,a.A)(this,"options",void 0),this.options=e,this.context=(0,u.A)()}init(e){e.ioReader&&e.ioReader.setEndian(!0)}async readHeader(e){try{let t=0,i=await e.ioReader.readUint32(),a=await e.ioReader.readUint32();if(a!==(0,d.A)("ftyp"))return n.z3("the file format is not mp4",v,83),o.LR;await l.E6(e.ioReader,this.context,{type:a,size:i-8});let r=BigInt(0);for(;!this.context.foundMoov;){const t=e.ioReader.getPos();if(i=await e.ioReader.readUint32(),a=await e.ioReader.readUint32(),i<8)return n.z3(`invalid box size ${i}`,v,100),o.LR;a===(0,d.A)("mdat")?(this.context.foundMdat||(r=t),this.context.foundMdat=!0,await e.ioReader.seek(t+BigInt(Math.floor(i)))):a===(0,d.A)("moov")?(await l.wB(e.ioReader,e,this.context,{size:i-8,type:a}),this.context.foundMoov=!0):await e.ioReader.seek(t+BigInt(Math.floor(i)))}if(!this.context.fragment&&!this.context.foundMdat){const t=await e.ioReader.peekUint64()>>BigInt(32);Number(t)===(0,d.A)("moof")&&(this.context.fragment=!0)}if(this.context.fragment&&1&e.ioReader.flags){const t=e.ioReader.getPos(),i=await e.ioReader.fileSize();if(i>BigInt(16)){await e.ioReader.seek(i-BigInt(12));let a=await e.ioReader.readUint32();if(a===(0,d.A)("mfro")){await e.ioReader.skip(4);const t=await e.ioReader.readUint32();await e.ioReader.seek(i-BigInt(Math.floor(t)));const r=await e.ioReader.readUint32();a=await e.ioReader.readUint32(),a===(0,d.A)("mfra")&&await l.t9(e.ioReader,e,this.context,{size:r-8,type:a})}await e.ioReader.seek(t)}}return!this.context.fragment&&this.context.foundMdat&&await e.ioReader.seek(r),t}catch(t){return n.z3(t.message,v,162),this.context.foundMoov||n.z3("moov not found",v,165),e.ioReader.error}}async readAVPacket_(e,t){const{sample:i,stream:a}=(0,f.G)(e,this.context);if(!i)return-1048576;{s.M[15](t+32,a.index),s.M[17](t+16,i.dts),s.M[17](t+8,i.pts),s.M[17](t+48,BigInt(Math.floor(i.duration))),s.M[15](t+36,r.f[15](t+36)|i.flags),s.M[17](t+56,i.pos),s.M[15](t+76,a.timeBase.den),s.M[15](t+72,a.timeBase.num),a.startTime===U.Dh&&(a.startTime=r.f[17](t+8)||r.f[17](t+16)),await e.ioReader.seek(r.f[17](t+56));const n=i.size,o=(0,m.sY)(n);if((0,w.NX)(t,o,n),await e.ioReader.readBuffer(n,(0,p.JW)(o,n)),27!==a.codecpar.codecId&&173!==a.codecpar.codecId&&196!==a.codecpar.codecId||s.M[15](t+80,1),94226===a.codecpar.codecId&&r.f[15](t+28)>=8){const e=b.Sg(r.f[20](t+24)+4)>>>0,i=r.f[15](t+28);if(e===(0,d.A)("vtte")&&8===i){const e=(0,m.Gy)(1);(0,w.NX)(t,e,1),s.M[15](t+28,1)}if(i>8&&(e===(0,d.A)("vtte")||e===(0,d.A)("vttc"))){let e=r.f[20](t+24)+8;const a=r.f[20](t+24)+i;for(;e<a;){const i=b.Sg(e);if(b.Sg(e+4)>>>0===(0,d.A)("payl")&&i>8){const a=(0,m.sY)(i-8);(0,p.Mr)(a,e+8,i-8),(0,w.NX)(t,a,i-8);break}e+=i}}}if(a.sideData[1]){const e=a.sideData[1].length,i=(0,m.sY)(e);(0,w.Ow)(t,1,i,e),(0,p.lW)(i,e,a.sideData[1]),delete a.sideData[1]}}return 0}async readAVPacket(e,t){try{if(this.context.fragment&&!this.context.currentFragment)for(;!this.context.currentFragment;){const t=e.ioReader.getPos(),i=await e.ioReader.readUint32(),a=await e.ioReader.readUint32();a===(0,d.A)("moof")?(this.context.currentFragment={pos:t,size:i,sequence:0,tracks:[],currentTrack:null},this.context.firstMoof||(this.context.firstMoof=t),await l.wZ(e.ioReader,e,this.context,{type:a,size:i-8})):a===(0,d.A)("moov")?await l.wB(e.ioReader,e,this.context,{size:i-8,type:a}):await e.ioReader.skip(i-8)}return await this.readAVPacket_(e,t)}catch(t){return-1048576!==e.ioReader.error&&n.z3(t.message,v,298),e.ioReader.error}}async seek(e,t,i,a){const r=i,s=t.privData,n=()=>{this.context.currentFragment=null,e.streams.forEach((e=>{e.privData.samplesIndex.length=0}))};if(16&a&&this.context.fragment){const a=(0,g.k)(i,t.timeBase,U.i0);return await e.ioReader.seek(a,!0),n(),BigInt(0)}if(this.context.fragment){if(s.fragIndexes.length){let t=h.El(s.fragIndexes,(e=>e.time>r?-1:e.time===r?0:1));if(t>-1)return await e.ioReader.seek(s.fragIndexes[t].pos,!0),n(),BigInt(0)}return r===BigInt(0)&&this.context.firstMoof?(await e.ioReader.seek(this.context.firstMoof),n(),BigInt(0)):BigInt(o.E$)}let d=h.El(s.samplesIndex,(e=>e.pts>r?-1:e.pts===r?0:1));if(d>-1&&0===t.codecpar.codecType){let e=d;for(;e>=0;e--)if(1&s.samplesIndex[e].flags){d=e;break}e<0&&(d=-1)}return d>-1?(s.currentSample=d,s.sampleEnd=!1,h.__(e.streams,(e=>{if(e!==t){const i=e.privData;let a=!1,r=(0,g.k)(s.samplesIndex[s.currentSample].pts,t.timeBase,e.timeBase);h.__(i.samplesIndex,((e,t)=>{if(e.pts>=r)return i.currentSample=t,a=!0,!1})),a?i.sampleEnd=!1:(i.sampleEnd=!0,i.currentSample=i.samplesIndex.length)}})),BigInt(0)):BigInt(o.LR)}getAnalyzeStreamsCount(){return 0}}},21071:(e,t,i)=>{i.d(t,{_l:()=>a,gQ:()=>r});const a=["hmhd","nmhd","iods","xml ","url ","bxml","ipro","mere","stts","ctts","stss","stsz","stz2","stsc","stco","co64","stsd","dref","mvhd","tkhd","mdhd","hdlr"],r=["moov","trak","edts","mdia","minf","dinf","stbl","mvex","moof","traf","vttc","tref","iref","mfra","hnti","hinf","strd","sinf","rinf","schi","trgr","udta","iprp","ipco","strk","meco"]},61179:(e,t,i)=>{function a(e,t,i,a=0){const r=e.privData,s=i.trexs.find((e=>e.trackId===t.trackId));let n=t.baseDataOffset+BigInt(Math.floor(t.dataOffset));t.baseIsMoof&&(n+=i.currentFragment.pos);let o=t.baseMediaDecodeTime;const d=t.sampleSizes,l=t.sampleDurations,c=t.sampleFlags,f=t.sampleCompositionTimeOffset;if(!d.length)for(let e=0;e<t.sampleCount;e++)d.push(t.defaultSampleSize||s.size);if(!l.length)for(let e=0;e<t.sampleCount;e++)l.push(t.defaultSampleDuration||s.duration);if(!c.length)for(let e=0;e<t.sampleCount;e++)c.push(t.defaultSampleFlags||s.flags);if(!f.length)for(let e=0;e<t.sampleCount;e++)f.push(0);const u=[];for(let e=0;e<t.sampleCount;e++){const i={dts:o,pts:o+BigInt(Math.floor(f[e])),pos:n,size:d[e],duration:l[e],flags:0};o+=BigInt(Math.floor(i.duration)),n+=BigInt(Math.floor(i.size));let r=c[e];0===e&&t.firstSampleFlags&&(r=t.firstSampleFlags),16842752&r||(i.flags|=1),0===e&&d.length>1&&2&a&&(i.flags|=1),u.push(i)}r.samplesIndex=u}i.d(t,{p:()=>a})},98859:(e,t,i)=>{function a(e){const t=e.privData,i=t.chunkOffsets,a=t.sampleSizes,r=t.cttsSampleCounts,s=t.cttsSampleOffsets,n=t.stscFirstChunk,o=t.stscSamplesPerChunk,d=t.stssSampleNumbersMap,l=t.sttsSampleCounts,c=t.sttsSampleDeltas;if(!i.length)return;let f=0,u=0,h=0,p=0,m=0,w=0,g=BigInt(0),U=0,b=BigInt(0);const v=[];for(let t=0;t<i.length;t++)for(g=i[t],f<n.length-1&&n[f+1]===t+1&&f++,w=o[f];w>0;){const t={dts:b,pts:b,pos:g,size:a[U],duration:0,flags:0};(d&&d.has(U+1)||1===e.codecpar.codecType)&&(t.flags|=1),s&&(t.pts=t.dts+BigInt(Math.floor(s[p])),m++,m===r[p]&&(p++,m=0)),U&&(v[U-1].duration=Number(t.dts-v[U-1].dts)),g+=BigInt(Math.floor(t.size)),b+=BigInt(Math.floor(c[u])),h++,h===l[u]&&(u++,h=0),U++,v.push(t),w--}v.length>1&&(v[U-1].duration=v[U-2].duration),t.samplesIndex=v}i.d(t,{X:()=>a})},3384:(e,t,i)=>{function a(){return{trackId:0,baseDataOffset:BigInt(0),defaultSampleDuration:0,defaultSampleSize:0,defaultSampleFlags:0,baseMediaDecodeTime:BigInt(0),sampleCount:0,dataOffset:0,dataOffsetPos:BigInt(0),firstSampleFlags:0,sampleDurations:[],sampleSizes:[],sampleFlags:[],sampleCompositionTimeOffset:[],baseIsMoof:!1,ioWriter:null,buffers:[]}}i.d(t,{A:()=>a})},9690:(e,t,i)=>{i.d(t,{A:()=>r});var a=i(77231);function r(){return{isom:!1,timescale:a.N_,duration:a.Dh,foundMoov:!1,foundMdat:!1,majorBrand:0,minorVersion:0,compatibleBrand:[],creationTime:BigInt(0),modificationTime:BigInt(0),rate:a.N_,volume:a.N_,matrix:null,nextTrackId:1,fragment:!1,trexs:[],currentFragment:null,boxsPositionInfo:[],holdMoovPos:BigInt(0),currentChunk:null}}},38106:(e,t,i)=>{i.d(t,{A:()=>r});var a=i(77231);function r(){return{chunkOffsets:null,cttsSampleCounts:null,cttsSampleOffsets:null,stscFirstChunk:null,stscSamplesPerChunk:null,stscSampleDescriptionIndex:null,stssSampleNumbersMap:null,stssSampleNumbers:null,sampleSizes:null,sttsSampleCounts:null,sttsSampleDeltas:null,timescale:0,duration:BigInt(0),trackId:a.N_,layer:0,alternateGroup:0,volume:0,matrix:null,width:0,height:0,audioCid:0,samplesPerFrame:0,bytesPerFrame:0,currentSample:0,sampleEnd:!1,samplesIndex:[],fragIndexes:[],lastPts:BigInt(0),lastDts:BigInt(0),startDts:BigInt(0),startCT:0,lastDuration:0,chunkCount:0,firstWrote:!1,lastStscCount:0,perStreamGrouping:!1,index:0,flags:0}}},85428:(e,t,i)=>{i.d(t,{G:()=>s});var a=i(77231),r=i(44328);function s(e,t){let i,s,n,o,d,l,c=BigInt(0);if(e.streams.forEach((e=>{const t=e.privData;if(!t.samplesIndex||!t.samplesIndex.length)return t.sampleEnd=!0,!0;t.sampleEnd||n&&!(t.samplesIndex[t.currentSample].pos<n.pos)||(n=t.samplesIndex[t.currentSample],o=e),t.sampleEnd||d&&!((0,r.k)(t.samplesIndex[t.currentSample].dts,e.timeBase,a.KR)<c)||(d=t.samplesIndex[t.currentSample],c=(0,r.k)(d.dts,e.timeBase,a.KR),l=e)})),n&&d){const t=(0,r.k)(n.dts,o.timeBase,a.KR),c=(0,r.k)(d.dts,l.timeBase,a.KR);Math.abs(Number(t-c))<1e6||2&e.ioReader.flags?(i=n,s=o):(i=d,s=l)}else n?(i=n,s=o):d&&(i=d,s=l);if(s&&(s.privData.currentSample++,s.privData.currentSample>=s.privData.samplesIndex.length&&(s.privData.sampleEnd=!0)),t.fragment){const i=!!e.streams.find((e=>!1===e.privData.sampleEnd));i||(t.currentFragment=null)}return{sample:i,stream:s}}},74963:(e,t,i)=>{i.d(t,{E6:()=>m,t9:()=>b,wB:()=>g,wZ:()=>U});var a=i(65977),r=i(21071),s=i(68361),n=i(4624),o=i(61179),d=i(98859),l=i(3384),c=i(38106),f=i(37837),u=i(14686),h=i(77231),p="src/avformat/formats/mov/imov.ts";async function m(e,t,i){const r=e.getPos()+BigInt(Math.floor(i.size));for(t.majorBrand=await e.readUint32(),t.minorVersion=await e.readUint32(),t.majorBrand===(0,a.A)("qt  ")&&(t.isom=!0);e.getPos()<r;)t.compatibleBrand.push(await e.readUint32())}async function w(e,t,i,o){const d=e.getPos()+BigInt(Math.floor(i.size));for(;e.getPos()<d;){const i=await e.readUint32(),d=await e.readUint32();if(i<8)return void n.z3(`invalid box size ${i}`,p,76);s.A[d]?await s.A[d](e,t,{type:d,size:i-8},o):r.gQ.some((e=>(0,a.A)(e)===d))?await w(e,t,{type:d,size:i-8},o):await e.skip(i-8)}}async function g(e,t,i,r){const o=e.getPos()+BigInt(Math.floor(r.size));for(;e.getPos()<o;){const r=await e.readUint32(),o=await e.readUint32();if(r<8)return void n.z3(`invalid box, type: ${o}, size ${r}`,p,124);if(s.A[o])await s.A[o](e,null,{type:o,size:r-8},i);else if(o===(0,a.A)("trak"))if(!i.foundMoov||i.fragment){const a=t.createStream();if(a.privData=(0,c.A)(),await w(e,a,{type:o,size:r-8},i),i.fragment){const e=a.privData,i=t.streams.find((t=>{const i=t.privData;if(t.index!==a.index&&i.trackId===e.trackId)return!0}));i?(a.sideData[1]&&(i.sideData[1]=a.sideData[1],i.codecpar.extradata&&(0,f.Eb)(i.codecpar.extradata),i.codecpar.extradataSize=i.sideData[1].length,i.codecpar.extradata=(0,f.sY)(i.codecpar.extradataSize),(0,u.lW)(i.codecpar.extradata,i.codecpar.extradataSize,i.sideData[1]),a.codecpar.width===h.N_&&e.width>0&&(i.codecpar.width=e.width),a.codecpar.width===h.N_&&e.height>0&&(i.codecpar.height=e.height)),t.removeStream(a),t.streamIndex--):(a.codecpar.width===h.N_&&e.width>0&&(a.codecpar.width=e.width),a.codecpar.width===h.N_&&e.height>0&&(a.codecpar.height=e.height))}else(0,d.X)(a)}else await e.skip(r-8);else o===(0,a.A)("mvex")?(i.fragment=!0,await w(e,null,{type:o,size:r-8},i)):await e.skip(r-8)}}async function U(e,t,i,r){const d=e.getPos()+BigInt(Math.floor(r.size));for(;e.getPos()<d;){const r=await e.readUint32(),d=await e.readUint32();if(r<8)return void n.z3(`invalid box, type: ${d}, size ${r}`,p,229);if(s.A[d])await s.A[d](e,null,{type:d,size:r-8},i);else if(d===(0,a.A)("traf")){const a=(0,l.A)();i.currentFragment.currentTrack=a,await w(e,null,{type:d,size:r-8},i),i.currentFragment.tracks.push(a),i.currentFragment.currentTrack=null;const s=t.streams.find((e=>e.privData.trackId===a.trackId));if(s){const e=s.privData;a.streamIndex=s.index,(0,o.p)(s,a,i,t.ioReader.flags),e.currentSample=0,e.sampleEnd=!1}}else await e.skip(r-8)}}async function b(e,t,i,r){const s=e.getPos()+BigInt(Math.floor(r.size));for(;e.getPos()<s;){const r=e.getPos(),s=await e.readUint32();if(await e.readUint32()===(0,a.A)("tfra")){const r=await e.readUint8();await e.skip(3);const s=await e.readUint32(),n=await e.readUint32(),o=await e.readUint32(),d=t.streams.find((e=>e.privData.trackId===s));if(d){const s=d.privData;let l,c;for(let t=0;t<o;t++){1===r?(l=await e.readUint64(),c=await e.readUint64()):(l=BigInt(Math.floor(await e.readUint32())),c=BigInt(Math.floor(await e.readUint32()))),s.fragIndexes.push({pos:c,time:l});for(let t=0;t<1+(n>>4&3);t++)await e.skip(1);for(let t=0;t<1+(n>>2&3);t++)await e.skip(1);for(let t=0;t<1+(3&n);t++)await e.skip(1)}if(s.fragIndexes.length){await e.seek(s.fragIndexes[s.fragIndexes.length-1].pos);const r=await e.readUint32(),n=await e.readUint32();if(n===(0,a.A)("moof")&&(i.currentFragment={pos:BigInt(0),size:r,sequence:0,tracks:[],currentTrack:null},await U(e,t,i,{size:r,type:n}),s.samplesIndex.length)){const e=s.samplesIndex[s.samplesIndex.length-1];d.duration=e.pts+BigInt(Math.floor(e.duration)),s.samplesIndex.length=0}}}}await e.seek(r+BigInt(Math.floor(s)),!1,!1)}i.currentFragment=null}},6660:(e,t,i)=>{i.d(t,{Q9:()=>s,f3:()=>n,uf:()=>o,zs:()=>r});var a=i(65977);const r={86018:64,86017:105,86076:173,86028:193,86021:221,12:32,27:33,173:35,196:51,167:177,0:0},s={32:12,33:27,35:173,51:196,177:167,64:86018,102:86018,103:86018,104:86018,105:86017,107:86017,173:86076,193:86028,221:86021,0:0},n={vide:0,soun:1,clcp:3,sbtl:3,subt:3,subp:3,text:3},o={[(0,a.A)("mp4a")]:86018,1836253269:86017,[(0,a.A)("Opus")]:86076,[(0,a.A)("fLaC")]:86028,[(0,a.A)("spex")]:86051,[(0,a.A)("SPXN")]:86051,[(0,a.A)("ac-3")]:86019,[(0,a.A)("sac3")]:86019,[a.A.mp4v]:12,[(0,a.A)("av01")]:225,[(0,a.A)("vp08")]:139,[(0,a.A)("vp09")]:167,[(0,a.A)("avc1")]:27,[(0,a.A)("hev1")]:173,[(0,a.A)("hvc1")]:173,[(0,a.A)("vvc1")]:196,[(0,a.A)("vvi1")]:196,[(0,a.A)("text")]:94213,[(0,a.A)("tx3g")]:94213}},38582:(e,t,i)=>{i.d(t,{A:()=>d});var a=i(4624),r=i(14686),s=i(37837),n=i(90412),o="src/avformat/formats/mov/parsing/av1c.ts";async function d(e,t,i,d){const l=e.getPos();if(t.codecpar.codecId=225,i.size<=0)return;const c=(0,s.sY)(i.size),f=await e.readBuffer(i.size,(0,r.JW)(c,i.size));d.foundMoov?(t.sideData[1]=f.slice(),(0,s.Eb)(c)):(t.codecpar.extradata=c,t.codecpar.extradataSize=i.size,t.sideData[1]=f.slice()),n.XC(t,t.sideData[1]);const u=i.size-Number(e.getPos()-l);u>0?await e.skip(u):u<0&&a.z3(`read avcc error, size: ${i.size}, read: ${i.size-u}`,o,67)}},73840:(e,t,i)=>{i.d(t,{A:()=>d});var a=i(37837),r=i(14686),s=i(4624),n=i(20620),o="src/avformat/formats/mov/parsing/avcc.ts";async function d(e,t,i,d){const l=e.getPos();if(t.codecpar.codecId=27,i.size<=0)return;const c=(0,a.sY)(i.size),f=await e.readBuffer(i.size,(0,r.JW)(c,i.size));d.foundMoov?(t.sideData[1]=f.slice(),(0,a.Eb)(c)):(t.codecpar.extradata=c,t.codecpar.extradataSize=i.size,t.sideData[1]=f.slice()),n.XC(t,t.sideData[1]);const u=i.size-Number(e.getPos()-l);u>0?await e.skip(u):u<0&&s.z3(`read avcc error, size: ${i.size}, read: ${i.size-u}`,o,67)}},37213:(e,t,i)=>{i.d(t,{A:()=>s});var a=i(4624),r="src/avformat/formats/mov/parsing/co64.ts";async function s(e,t,i,s){const n=e.getPos(),o=await e.readUint8();await e.skip(3);const d=[],l=await e.readUint32();if(0===o)for(let t=0;t<l;t++)d.push(await e.readUint64());t.privData.chunkOffsets=d;const c=i.size-Number(e.getPos()-n);c>0?await e.skip(c):c<0&&a.z3(`read co64 error, size: ${i.size}, read: ${i.size-c}`,r,56)}},12869:(e,t,i)=>{i.d(t,{A:()=>s});var a=i(4624),r="src/avformat/formats/mov/parsing/colr.ts";async function s(e,t,i,s){const n=e.getPos();let o=await e.readString(4);if("nclx"===o||"nclc"===o||"prof"===o)if("prof"===o){const a=await e.readBuffer(i.size-4);t.sideData[28]=a}else{let i=await e.readUint16(),a=await e.readUint16(),r=await e.readUint16();if("nclx"===o){const i=await e.readUint8()>>7;t.codecpar.colorRange=i?2:1}i>=23&&(i=2),a>=19&&(a=2),r>=15&&(r=2),t.codecpar.colorPrimaries=i,t.codecpar.colorTrc=a,t.codecpar.colorSpace=r}else a.R8(`unsupported color_parameter_type: ${o}`,r,79);const d=i.size-Number(e.getPos()-n);d>0?await e.skip(d):d<0&&a.z3(`read vpcc error, size: ${i.size}, read: ${i.size-d}`,r,87)}},59299:(e,t,i)=>{i.d(t,{A:()=>s});var a=i(4624),r="src/avformat/formats/mov/parsing/ctts.ts";async function s(e,t,i,s){const n=e.getPos(),o=t.privData;await e.skip(4);const d=[],l=[],c=await e.readUint32();for(let t=0;t<c;t++)d.push(await e.readUint32()),l.push(await e.readInt32());o.cttsSampleCounts=d,o.cttsSampleOffsets=l;const f=i.size-Number(e.getPos()-n);f>0?await e.skip(f):f<0&&a.z3(`read ctts error, size: ${i.size}, read: ${i.size-f}`,r,59)}},7320:(e,t,i)=>{i.d(t,{A:()=>f});var a=i(61499),r=i(63939),s=i(50932),n=i(4624),o=i(71517),d=i(87771),l=i(99991),c="src/avformat/formats/mov/parsing/dac3.ts";async function f(e,t,i,f){const u=e.getPos();if(t.codecpar.codecId=86019,i.size<=0)return;const h=(0,o.E4)(t.codecpar[a.o9]+20,t.codecpar[a.o9]+24,7,4),p=r.f[20](h),m=await e.readUint24(),w=m>>14&7,g=m>>11&7,U=m>>10&1;let b=d.j[g];U&&(b|=8),l.bl(t.codecpar[a.o9]+112),l.ML(t.codecpar[a.o9]+112,b),s.M[15](p,w);const v=i.size-Number(e.getPos()-u);v>0?await e.skip(v):v<0&&n.z3(`read avcc error, size: ${i.size}, read: ${i.size-v}`,c,77)}},36868:(e,t,i)=>{i.d(t,{A:()=>f});var a=i(61499),r=i(63939),s=i(50932),n=i(4624),o=i(71517),d=i(87771),l=i(99991),c="src/avformat/formats/mov/parsing/dec3.ts";async function f(e,t,i,f){const u=e.getPos();if(t.codecpar.codecId=86056,i.size<=0)return;const h=(0,o.E4)(t.codecpar[a.o9]+20,t.codecpar[a.o9]+24,7,4),p=r.f[20](h);await e.skip(2);const m=await e.readUint24(),w=m>>12&31,g=m>>9&7,U=m>>8&1;let b=d.j[g];U&&(b|=8),l.bl(t.codecpar[a.o9]+112),l.ML(t.codecpar[a.o9]+112,b),s.M[15](p,w),t.codecpar.chLayout.nbChannels>1&&7==w&&s.M[15](p,8);const v=i.size-Number(e.getPos()-u);v>0?await e.skip(v):v<0&&n.z3(`read avcc error, size: ${i.size}, read: ${i.size-v}`,c,82)}},86528:(e,t,i)=>{i.d(t,{A:()=>o});var a=i(4624),r=i(37837),s=i(14686),n="src/avformat/formats/mov/parsing/dfla.ts";async function o(e,t,i,o){const d=e.getPos();t.codecpar.codecId=86028,await e.skip(1),await e.skip(3);const l=await e.readUint8(),c=128&l,f=127&l,u=await e.readUint24();if(0===f&&34===u){const i=(0,r.sY)(u),a=await e.readBuffer(u,(0,s.JW)(i,u));o.foundMoov?(t.sideData[1]=a.slice(),(0,r.Eb)(i)):(t.codecpar.extradata=i,t.codecpar.extradataSize=u)}else a.z3("streaminfo must be first FLACMetadataBlock",n,67);c||a.R8("non streaminfo FLACMetadataBlock(s) ignored",n,71);const h=i.size-Number(e.getPos()-d);h>0?await e.skip(h):h<0&&a.z3(`read vpcc error, size: ${i.size}, read: ${i.size-h}`,n,79)}},41781:(e,t,i)=>{i.d(t,{A:()=>c});var a=i(4624),r=i(37837),s=i(14686),n=i(65451),o=i(31865),d=i(729),l="src/avformat/formats/mov/parsing/dops.ts";async function c(e,t,i,c){const f=e.getPos();t.codecpar.codecId=86076,await e.skip(1);const u=(0,r.sY)(i.size+8),h=(0,s.JW)(u,i.size+8),p=new o.A(h),m=new d.A(h,!1);m.writeString("OpusHead"),m.writeUint8(1),await e.readBuffer(i.size-1,(0,s.JW)(u+9,i.size-1)),p.seek(10),m.seek(10),m.writeUint16(p.readUint16()),m.writeUint32(p.readUint32()),m.writeUint16(p.readUint16()),c.foundMoov?(t.sideData[1]=h.slice(),(0,r.Eb)(u)):(t.codecpar.extradata=u,t.codecpar.extradataSize=h.length,n.XC(t,h.slice()));const w=i.size-Number(e.getPos()-f);w>0?await e.skip(w):w<0&&a.z3(`read dops error, size: ${i.size}, read: ${i.size-w}`,l,81)}},28412:(e,t,i)=>{i.d(t,{A:()=>f});var a=i(4624),r=i(6660),s=i(37837),n=i(14686),o=i(58469),d=i(65451),l="src/avformat/formats/mov/parsing/esds.ts";async function c(e){let t=0;for(let i=0;i<4;i++){const i=await e.readUint8();if(t=t<<7|127&i,!(128&i))break}return t}async function f(e,t,i,f){const u=e.getPos();await e.skip(4);let h=e.getPos()+BigInt(Math.floor(i.size-4));for(;e.getPos()<h;){let i=await e.readUint8(),u=await c(e);if(0!==u)if(3===i){let h=e.getPos()+BigInt(Math.floor(u));if(await e.skip(2),await e.skip(1),i=await e.readUint8(),u=await c(e),0===u){a.R8("esds invalid ES descriptor size 0, skip",l,85),await e.skip(Number(h-e.getPos()));continue}if(4===i)if(t.codecpar.codecId=r.Q9[await e.readUint8()],await e.skip(1),await e.skip(3),await e.skip(4),await e.skip(4),e.getPos()<h-BigInt(5))if(i=await e.readUint8(),u=await c(e),5===i){const i=(0,s.sY)(u),a=await e.readBuffer(u,(0,n.JW)(i,u));f.foundMoov?(t.sideData[1]=a.slice(),(0,s.Eb)(i)):(t.codecpar.extradata=i,t.codecpar.extradataSize=u,86018===t.codecpar.codecId?o.XC(t,a.slice()):86076===t.codecpar.codecId&&d.XC(t,a.slice()))}else await e.skip(Number(h-e.getPos()));else await e.skip(Number(h-e.getPos()));else await e.skip(Math.min(u,Number(h-e.getPos())))}else await e.skip(Math.min(u,Number(h-e.getPos())));else a.R8("esds invalid descriptor size 0, skip",l,68),await e.skip(Number(h-e.getPos()))}const p=i.size-Number(e.getPos()-u);p>0?await e.skip(p):p<0&&a.z3(`read vpcc error, size: ${i.size}, read: ${i.size-p}`,l,153)}},40179:(e,t,i)=>{i.d(t,{A:()=>o});var a=i(4624),r=i(34677),s=i(6660),n="src/avformat/formats/mov/parsing/hdlr.ts";async function o(e,t,i,o){const d=e.getPos(),l=await e.readUint8();if(await e.skip(3),0===l){await e.skip(4);const a=await e.readString(4),n=s.f3[a];(0,r.A)(n)&&(t.codecpar.codecType=n),await e.skip(4),await e.skip(4),await e.skip(4);const d=i.size-24;if(d>0){const i=!o.isom&&await e.peekUint8()===d-1;i&&await e.skip(1),t.metadata.handlerName=await e.readString(d-(i?1:0))}}const c=i.size-Number(e.getPos()-d);c>0?await e.skip(c):c<0&&a.z3(`read hdlr error, size: ${i.size}, read: ${i.size-c}`,n,77)}},31421:(e,t,i)=>{i.d(t,{A:()=>d});var a=i(37837),r=i(14686),s=i(4624),n=i(53e3),o="src/avformat/formats/mov/parsing/hvcc.ts";async function d(e,t,i,d){const l=e.getPos();if(t.codecpar.codecId=173,i.size<=0)return;const c=(0,a.sY)(i.size),f=await e.readBuffer(i.size,(0,r.JW)(c,i.size));d.foundMoov?(t.sideData[1]=f.slice(),(0,a.Eb)(c)):(t.codecpar.extradata=c,t.codecpar.extradataSize=i.size,t.sideData[1]=f.slice()),n.XC(t,t.sideData[1]);const u=i.size-Number(e.getPos()-l);u>0?await e.skip(u):u<0&&s.z3(`read hevc error, size: ${i.size}, read: ${i.size-u}`,o,67)}},45248:(e,t,i)=>{i.d(t,{A:()=>s});var a=i(4624),r="src/avformat/formats/mov/parsing/mdhd.ts";async function s(e,t,i,s){const n=e.getPos(),o=await e.readUint8();await e.skip(3);let d=BigInt(0),l=BigInt(0),c=0,f=BigInt(0);1===o?(d=await e.readUint64(),l=await e.readUint64(),c=await e.readUint32(),f=await e.readUint64()):(d=BigInt(Math.floor(await e.readUint32())),l=BigInt(Math.floor(await e.readUint32())),c=await e.readUint32(),f=BigInt(Math.floor(await e.readUint32()))),t.duration=f,t.timeBase.den=c,t.timeBase.num=1,t.metadata.creationTime=d,t.metadata.modificationTime=l;const u=await e.readUint16(),h=[];h[0]=u>>10&31,h[1]=u>>5&31,h[2]=31&u;const p=String.fromCharCode(h[0]+96,h[1]+96,h[2]+96);t.metadata.language=u,t.metadata.languageString=p,await e.skip(2);const m=i.size-Number(e.getPos()-n);m>0?await e.skip(m):m<0&&a.z3(`read mdhd error, size: ${i.size}, read: ${i.size-m}`,r,83)}},7018:(e,t,i)=>{i.d(t,{A:()=>s});var a=i(4624),r="src/avformat/formats/mov/parsing/mfhd.ts";async function s(e,t,i,s){const n=e.getPos();await e.readUint8(),await e.skip(3),s.currentFragment.sequence=await e.readUint32();const o=i.size-Number(e.getPos()-n);o>0?await e.skip(o):o<0&&a.z3(`read vpcc error, size: ${i.size}, read: ${i.size-o}`,r,49)}},19354:(e,t,i)=>{i.d(t,{A:()=>s});var a=i(4624),r="src/avformat/formats/mov/parsing/mvhd.ts";async function s(e,t,i,s){const n=e.getPos(),o=await e.readUint8();await e.skip(3),1===o?(s.creationTime=await e.readUint64(),s.modificationTime=await e.readUint64(),s.timescale=await e.readUint32(),s.duration=await e.readUint64()):(s.creationTime=BigInt(Math.floor(await e.readUint32())),s.modificationTime=BigInt(Math.floor(await e.readUint32())),s.timescale=await e.readUint32(),s.duration=BigInt(Math.floor(await e.readUint32()))),s.rate=await e.readUint32(),s.volume=await e.readUint16()>>>8,await e.skip(10),s.matrix=new Uint32Array(9);for(let t=0;t<9;t++)s.matrix[t]=await e.readUint32();await e.skip(24),s.nextTrackId=await e.readUint32();const d=i.size-Number(e.getPos()-n);d>0?await e.skip(d):d<0&&a.z3(`read mvhd error, size: ${i.size}, read: ${i.size-d}`,r,70)}},68361:(e,t,i)=>{i.d(t,{A:()=>z});var a=i(91635),r=i(59299),s=i(63080),n=i(62831),o=i(6570),d=i(34136),l=i(15692),c=i(37213),f=i(45248),u=i(19354),h=i(27436),p=i(40179),m=i(35173),w=i(25778),g=i(7018),U=i(61807),b=i(67523),v=i(58996),x=i(65977);const z={[(0,x.A)("stts")]:a.A,[(0,x.A)("ctts")]:r.A,[(0,x.A)("stss")]:s.A,[(0,x.A)("stsz")]:n.A,[(0,x.A)("stz2")]:o.A,[(0,x.A)("stsc")]:d.A,[(0,x.A)("stco")]:l.A,[(0,x.A)("co64")]:c.A,[(0,x.A)("mdhd")]:f.A,[(0,x.A)("mvhd")]:u.A,[(0,x.A)("tkhd")]:h.A,[(0,x.A)("hdlr")]:p.A,[(0,x.A)("stsd")]:m.A,[(0,x.A)("trex")]:w.A,[(0,x.A)("mfhd")]:g.A,[(0,x.A)("tfhd")]:U.A,[(0,x.A)("tfdt")]:b.A,[(0,x.A)("trun")]:v.A}},15692:(e,t,i)=>{i.d(t,{A:()=>s});var a=i(4624),r="src/avformat/formats/mov/parsing/stco.ts";async function s(e,t,i,s){const n=e.getPos(),o=await e.readUint8();await e.skip(3);const d=[],l=await e.readUint32();if(0===o)for(let t=0;t<l;t++)d.push(BigInt(Math.floor(await e.readUint32())));t.privData.chunkOffsets=d;const c=i.size-Number(e.getPos()-n);c>0?await e.skip(c):c<0&&a.z3(`read stco error, size: ${i.size}, read: ${i.size-c}`,r,56)}},34136:(e,t,i)=>{i.d(t,{A:()=>s});var a=i(4624),r="src/avformat/formats/mov/parsing/stsc.ts";async function s(e,t,i,s){const n=e.getPos(),o=await e.readUint8();await e.skip(3);const d=t.privData,l=[],c=[],f=[],u=await e.readUint32();if(0===o)for(let t=0;t<u;t++)l.push(await e.readUint32()),c.push(await e.readUint32()),f.push(await e.readUint32());d.stscFirstChunk=l,d.stscSamplesPerChunk=c,d.stscSampleDescriptionIndex=f;const h=i.size-Number(e.getPos()-n);h>0?await e.skip(h):h<0&&a.z3(`read stsc error, size: ${i.size}, read: ${i.size-h}`,r,65)}},35173:(e,t,i)=>{i.d(t,{A:()=>b});var a=i(4624),r=i(65977),s=i(6660),n=i(73840),o=i(31421),d=i(60703),l=i(83561),c=i(38582),f=i(28412),u=i(28460),h=i(86528),p=i(41781),m=i(12869),w=i(7320),g=i(36868),U="src/avformat/formats/mov/parsing/stsd.ts";async function b(e,t,i,b){const v=e.getPos(),x=await e.readUint8();await e.skip(3);const z=t.privData,k=await e.readUint32();for(let i=0;i<k;i++){const i=await e.readUint32(),v=await e.readUint32(),k=e.getPos()+BigInt(Math.floor(i-8));if(s.uf[v]&&(t.codecpar.codecId=s.uf[v]),0===i){a.R8("stsd entry invalid box size 0, skip",U,73),await e.skip(Number(k-e.getPos()));break}if(i>=16?(await e.skip(6),await e.skip(2)):i<=7&&a.h2(`invalid size: ${i} in stsd`,U,86),0===t.codecpar.codecType){await e.skip(2),await e.skip(2),t.metadata.vendorId=await e.readString(4),await e.skip(4),await e.skip(4),t.codecpar.width=await e.readUint16(),t.codecpar.height=await e.readUint16(),await e.skip(4),await e.skip(4),await e.skip(4),await e.skip(2);let i=await e.readUint8();for(i>31&&(i=31),t.metadata.encoder=await e.readString(i),i<31&&await e.skip(31-i),await e.skip(2),await e.skip(2);e.getPos()<k;){const i=await e.readUint32(),s=await e.readUint32();0!==i?s===(0,r.A)("avcC")?await(0,n.A)(e,t,{type:s,size:i-8},b):s===(0,r.A)("hvcC")?await(0,o.A)(e,t,{type:s,size:i-8},b):s===(0,r.A)("vvcC")?await(0,d.A)(e,t,{type:s,size:i-8},b):s===(0,r.A)("av1C")?await(0,c.A)(e,t,{type:s,size:i-8},b):s===(0,r.A)("vpcC")?await(0,l.A)(e,t,{type:s,size:i-8},b):s===(0,r.A)("esds")?await(0,f.A)(e,t,{type:s,size:i-8},b):s===(0,r.A)("wave")?await(0,u.A)(e,t,{type:s,size:i-8},b):s===(0,r.A)("colr")?await(0,m.A)(e,t,{type:s,size:i-8},b):await e.skip(Math.min(i-8,Number(k-e.getPos()))):(a.R8("stsd video invalid box size 0, skip",U,135),await e.skip(Number(k-e.getPos())))}}else if(1===t.codecpar.codecType){const i=await e.readUint16();for(await e.skip(2),t.metadata.vendorId=await e.readString(4),t.codecpar.chLayout.nbChannels=await e.readUint16(),t.codecpar.bitsPerCodedSample=await e.readUint16(),z.audioCid=await e.readUint16(),await e.skip(2),t.codecpar.sampleRate=await e.readUint32()>>>16,(!b.isom||0===x&&i>0)&&(1===i?(z.samplesPerFrame=await e.readUint32(),await e.skip(4),z.bytesPerFrame=await e.readUint32(),await e.skip(4)):2===i&&(await e.skip(4),t.codecpar.sampleRate=Number(await e.readUint64()),t.codecpar.chLayout.nbChannels=await e.readUint32(),await e.skip(4),t.codecpar.bitsPerCodedSample=await e.readUint32(),await e.skip(4),z.bytesPerFrame=await e.readUint32(),z.samplesPerFrame=await e.readUint32()));e.getPos()<k;){const i=await e.readUint32(),s=await e.readUint32();0!==i?s===(0,r.A)("esds")?await(0,f.A)(e,t,{type:s,size:i-8},b):s===(0,r.A)("dfLa")?await(0,h.A)(e,t,{type:s,size:i-8},b):s===(0,r.A)("dOps")?await(0,p.A)(e,t,{type:s,size:i-8},b):s===(0,r.A)("wave")?await(0,u.A)(e,t,{type:s,size:i-8},b):s===(0,r.A)("dac3")?await(0,w.A)(e,t,{type:s,size:i-8},b):s===(0,r.A)("dec3")?await(0,g.A)(e,t,{type:s,size:i-8},b):await e.skip(Math.min(i-8,Number(k-e.getPos()))):(a.R8("stsd audio invalid box size 0, skip",U,282),await e.skip(Number(k-e.getPos())))}}else 3===t.codecpar.codecType?(v===(0,r.A)("stpp")?t.codecpar.codecId=94232:v===(0,r.A)("wvtt")?t.codecpar.codecId=94226:v===(0,r.A)("tx3g")||v===(0,r.A)("text")?t.codecpar.codecId=94213:v===(0,r.A)("c608")&&(t.codecpar.codecId=94218),await e.skip(Math.min(i-8,Number(k-e.getPos())))):await e.skip(Math.min(i-8,Number(k-e.getPos())))}const A=i.size-Number(e.getPos()-v);A>0?await e.skip(A):A<0&&a.z3(`read stsd error, size: ${i.size}, read: ${i.size-A}`,U,383)}},63080:(e,t,i)=>{i.d(t,{A:()=>o});var a=i(80662),r=i.n(a),s=i(4624),n="src/avformat/formats/mov/parsing/stss.ts";async function o(e,t,i,a){const o=e.getPos(),d=await e.readUint8();await e.skip(3);const l=new(r()),c=await e.readUint32();if(0===d)for(let t=0;t<c;t++)l.set(await e.readUint32(),!0);t.privData.stssSampleNumbersMap=l;const f=i.size-Number(e.getPos()-o);f>0?await e.skip(f):f<0&&s.z3(`read stss error, size: ${i.size}, read: ${i.size-f}`,n,57)}},62831:(e,t,i)=>{i.d(t,{A:()=>s});var a=i(4624),r="src/avformat/formats/mov/parsing/stsz.ts";async function s(e,t,i,s){const n=e.getPos(),o=await e.readUint8();await e.skip(3);const d=[];let l=0,c=0;if(0===o){l=await e.readUint32(),c=await e.readUint32();for(let t=0;t<c;t++)0===l?d.push(await e.readUint32()):d[t]=l}t.privData.sampleSizes=d;const f=i.size-Number(e.getPos()-n);f>0?await e.skip(f):f<0&&a.z3(`read stsz error, size: ${i.size}, read: ${i.size-f}`,r,65)}},91635:(e,t,i)=>{i.d(t,{A:()=>s});var a=i(4624),r="src/avformat/formats/mov/parsing/stts.ts";async function s(e,t,i,s){const n=e.getPos(),o=await e.readUint8();await e.skip(3);const d=t.privData,l=[],c=[],f=await e.readUint32();let u=1;if(0===o)for(let t=0;t<f;t++)l.push(await e.readUint32()),u=await e.readInt32(),u<0&&a.R8("File uses negative stts sample delta, using value 1 instead, sync may be lost!",r,53),c.push(u);d.sttsSampleCounts=l,d.sttsSampleDeltas=c;const h=i.size-Number(e.getPos()-n);h>0?await e.skip(h):h<0&&a.z3(`read stts error, size: ${i.size}, read: ${i.size-h}`,r,67)}},6570:(e,t,i)=>{i.d(t,{A:()=>s});var a=i(4624),r="src/avformat/formats/mov/parsing/stz2.ts";async function s(e,t,i,s){const n=e.getPos(),o=await e.readUint8();await e.skip(3);const d=[];let l=0,c=0;if(0===o)if(await e.skip(3),c=await e.readUint8(),l=await e.readUint32(),4===c)for(let t=0;t<l;t+=2){const i=await e.readUint8();d[t]=i>>4&15,d[t+1]=15&i}else if(8===c)for(let t=0;t<l;t++)d[t]=await e.readUint8();else if(16===c)for(let t=0;t<l;t++)d[t]=await e.readUint16();else a.z3("Error in length field in stz2 box",r,67);t.privData.sampleSizes=d;const f=i.size-Number(e.getPos()-n);f>0?await e.skip(f):f<0&&a.z3(`read stz2 error, size: ${i.size}, read: ${i.size-f}`,r,78)}},67523:(e,t,i)=>{i.d(t,{A:()=>s});var a=i(4624),r="src/avformat/formats/mov/parsing/tfdt.ts";async function s(e,t,i,s){const n=e.getPos(),o=await e.readUint8();await e.skip(3);const d=s.currentFragment.currentTrack;d&&(d.baseMediaDecodeTime=1===o?await e.readUint64():BigInt(Math.floor(await e.readUint32())));const l=i.size-Number(e.getPos()-n);l>0?await e.skip(l):l<0&&a.z3(`read vpcc error, size: ${i.size}, read: ${i.size-l}`,r,57)}},61807:(e,t,i)=>{i.d(t,{A:()=>s});var a=i(4624),r="src/avformat/formats/mov/parsing/tfhd.ts";async function s(e,t,i,s){const n=e.getPos(),o=(await e.readUint8(),await e.readUint24()),d=await e.readUint32(),l=s.currentFragment.currentTrack;l.trackId=d,l&&(1&o&&(l.baseDataOffset=await e.readUint64()),2&o&&await e.skip(4),8&o&&(l.defaultSampleDuration=await e.readUint32()),16&o&&(l.defaultSampleSize=await e.readUint32()),32&o&&(l.defaultSampleFlags=await e.readUint32()),131072&o&&(l.baseIsMoof=!0));const c=i.size-Number(e.getPos()-n);c>0?await e.skip(c):c<0&&a.z3(`read vpcc error, size: ${i.size}, read: ${i.size-c}`,r,75)}},27436:(e,t,i)=>{i.d(t,{A:()=>s});var a=i(4624),r="src/avformat/formats/mov/parsing/tkhd.ts";async function s(e,t,i,s){const n=t.privData,o=e.getPos(),d=await e.readUint8();n.flags=await e.readUint24(),1&n.flags&&(t.disposition|=1),1===d?(t.metadata.creationTime=await e.readUint64(),t.metadata.modificationTime=await e.readUint64(),n.trackId=await e.readUint32(),await e.skip(4),n.duration=await e.readUint64()):(t.metadata.creationTime=BigInt(Math.floor(await e.readUint32())),t.metadata.modificationTime=BigInt(Math.floor(await e.readUint32())),n.trackId=await e.readUint32(),await e.skip(4),n.duration=BigInt(Math.floor(await e.readUint32()))),await e.skip(8),n.layer=await e.readInt16(),n.alternateGroup=await e.readInt16(),n.volume=await e.readInt16()>>8,await e.skip(2),n.matrix=new Uint32Array(9);for(let t=0;t<9;t++)n.matrix[t]=await e.readUint32();n.width=await e.readUint32()>>16,n.height=await e.readUint32()>>16;const l=i.size-Number(e.getPos()-o);l>0?await e.skip(l):l<0&&a.z3(`read tkhd error, size: ${i.size}, read: ${i.size-l}`,r,82)}},25778:(e,t,i)=>{i.d(t,{A:()=>s});var a=i(4624),r="src/avformat/formats/mov/parsing/trex.ts";async function s(e,t,i,s){const n=e.getPos();await e.readUint8(),await e.skip(3);const o=await e.readUint32();await e.skip(4);const d=await e.readUint32(),l=await e.readUint32(),c=await e.readUint32();s.trexs.push({trackId:o,duration:d,size:l,flags:c});const f=i.size-Number(e.getPos()-n);f>0?await e.skip(f):f<0&&a.z3(`read trex error, size: ${i.size}, read: ${i.size-f}`,r,61)}},58996:(e,t,i)=>{i.d(t,{A:()=>s});var a=i(4624),r="src/avformat/formats/mov/parsing/trun.ts";async function s(e,t,i,s){const n=e.getPos(),o=await e.readUint8(),d=await e.readUint24(),l=s.currentFragment.currentTrack;if(l){l.sampleCount=await e.readUint32(),1&d&&(l.dataOffset=await e.readInt32()),4&d&&(l.firstSampleFlags=await e.readUint32());for(let t=0;t<l.sampleCount;t++)256&d&&l.sampleDurations.push(await e.readUint32()),512&d&&l.sampleSizes.push(await e.readUint32()),1024&d&&l.sampleFlags.push(await e.readUint32()),2048&d&&(0===o?l.sampleCompositionTimeOffset.push(await e.readUint32()):l.sampleCompositionTimeOffset.push(await e.readInt32()))}const c=i.size-Number(e.getPos()-n);c>0?await e.skip(c):c<0&&a.z3(`read vpcc error, size: ${i.size}, read: ${i.size-c}`,r,79)}},83561:(e,t,i)=>{i.d(t,{A:()=>d});var a=i(37837),r=i(14686),s=i(4624),n=i(58919),o="src/avformat/formats/mov/parsing/vpcc.ts";async function d(e,t,i,d){const l=e.getPos();if(await e.readUint8(),await e.skip(3),t.codecpar.codecId=167,i.size-4<=0)return;const c=(0,a.sY)(i.size-4),f=await e.readBuffer(i.size-4,(0,r.JW)(c,i.size-4));d.foundMoov?(t.sideData[1]=f.slice(),(0,a.Eb)(c)):(t.codecpar.extradata=c,t.codecpar.extradataSize=i.size-4,t.sideData[1]=f.slice()),n.XC(t,t.sideData[1]);const u=i.size-Number(e.getPos()-l);u>0?await e.skip(u):u<0&&s.z3(`read vpcc error, size: ${i.size}, read: ${i.size-u}`,o,71)}},60703:(e,t,i)=>{i.d(t,{A:()=>d});var a=i(37837),r=i(14686),s=i(4624),n=i(55611),o="src/avformat/formats/mov/parsing/vvcc.ts";async function d(e,t,i,d){const l=e.getPos();if(await e.readUint8(),await e.skip(3),t.codecpar.codecId=196,i.size-4<=0)return;const c=(0,a.sY)(i.size-4),f=await e.readBuffer(i.size-4,(0,r.JW)(c,i.size-4));d.foundMoov?(t.sideData[1]=f.slice(),(0,a.Eb)(c)):(t.codecpar.extradata=c,t.codecpar.extradataSize=i.size-4,t.sideData[1]=f.slice()),n.XC(t,t.sideData[1]);const u=i.size-Number(e.getPos()-l);u>0?await e.skip(u):u<0&&s.z3(`read vvcc error, size: ${i.size}, read: ${i.size-u}`,o,71)}},28460:(e,t,i)=>{i.d(t,{A:()=>o});var a=i(4624),r=i(65977),s=i(28412),n="src/avformat/formats/mov/parsing/wave.ts";async function o(e,t,i,o){const d=e.getPos(),l=d+BigInt(Math.floor(i.size));for(;e.getPos()<l;){const i=await e.readUint32(),d=await e.readUint32();0!==i?d===(0,r.A)("esds")?await(0,s.A)(e,t,{type:d,size:i-8},o):await e.skip(Math.min(i-8,Number(l-e.getPos()))):(a.R8("wave invalid box size 0, skip",n,47),await e.skip(Number(l-e.getPos())))}const c=i.size-Number(e.getPos()-d);c>0?await e.skip(c):c<0&&a.z3(`read vpcc error, size: ${i.size}, read: ${i.size-c}`,n,73)}},65977:(e,t,i)=>{i.d(t,{A:()=>s});var a=i(4624),r="src/avformat/function/mktag.ts";function s(e){4!==e.length&&a.R8(`tag length is not 4, tag: ${e}`,r,30);let t=0;for(let i=0;i<4;i++)t=t<<8|e.charCodeAt(i);return t}},11573:(e,t,i)=>{function a(e,t){let i=0;for(let a=0;a<t;a++)i=2*i+e.readU1();return i}function r(e){let t=0;for(;!a(e,1);)t++;return t>=32?0:a(e,t)+(1<<t)-1}function s(e){let t=0,i=0;for(let r=0;r<8;r++){let s=a(e,8);if(t|=(127&s)<<7*r,i+=1,!(128&s))break}return t}i.d(t,{d:()=>r,f:()=>a,v:()=>s})},23991:(e,t,i)=>{function a(e){let t=0,i=0;for(;i<32&&0===e.readU1();)i++;return t=e.readU(i),t+=(1<<i)-1,t}function r(e){let t=a(e);return t=1&t?(t+1)/2:-t/2,t}i.d(t,{$x:()=>r,xb:()=>a})},39381:(e,t,i)=>{i.d(t,{E3:()=>s,Sg:()=>d,Y0:()=>o});var a=i(63939);function r(e){return a.f[2](e)}function s(e){return r(e+1)<<8|r(e)}function n(e){return r(e)<<8|r(e+1)}function o(e){return s(e+2)<<16|s(e)}function d(e){return n(e)<<16|n(e+2)}},60264:(e,t,i)=>{function a(e){return e.length>4&&0===e[0]&&0===e[1]&&(1===e[2]||0===e[2]&&1===e[3])}function r(e,t){let i=0;for(let a=t;a<e.length;a++)switch(e[a]){case 0:i++;break;case 1:if(i>=2)return{offset:a-Math.min(i,3),startCode:Math.min(i+1,4)};i=0;break;default:i=0}return{offset:-1,startCode:0}}function s(e){const t=[];let i=r(e,0),a={offset:-1,startCode:0};for(;a=r(e,i.offset+i.startCode),a.offset>-1;)t.push(e.subarray(i.offset+i.startCode,a.offset,!0)),i=a;return t.push(e.subarray(i.offset+i.startCode,void 0,!0)),t}function n(e,t=0,i){i||(i=e.length);const a=new Uint8Array(e.length);let r=0,s=0;for(let n=0;n<e.length;n++){if(n>=t&&n<i)if(0===e[n])r++;else if(3===e[n]&&2===r&&n+1<e.length&&e[n+1]<=3){if(n++,n===e.length)break;r=0===e[n]?1:0}else r=0;a[s++]=e[n]}return a.slice(0,s)}i.d(t,{BN:()=>n,Bs:()=>a,Ky:()=>r,py:()=>s})},37246:(e,t,i)=>{i.d(t,{A:()=>s});var a=i(134),r=i(4624);class s{constructor(e=1048576){(0,a.A)(this,"buffer",void 0),(0,a.A)(this,"pointer",void 0),(0,a.A)(this,"bitsLeft",void 0),(0,a.A)(this,"size",void 0),(0,a.A)(this,"endPointer",void 0),(0,a.A)(this,"error",void 0),(0,a.A)(this,"onFlush",void 0),this.pointer=0,this.bitsLeft=8,this.size=e,this.endPointer=0,this.error=0,this.buffer=new Uint8Array(this.size)}peekU1(){let e=0;(this.remainingLength()<1||1===this.remainingLength()&&0===this.bitsLeft)&&this.flush();let t=this.pointer,i=this.bitsLeft;return 0===i&&(t++,i=8),e=this.buffer[t]>>i-1&1,e}readU1(){let e=0;return(this.remainingLength()<1||1===this.remainingLength()&&0===this.bitsLeft)&&this.flush(),this.bitsLeft--,e=this.buffer[this.pointer]>>this.bitsLeft&1,0===this.bitsLeft&&(this.pointer++,this.bitsLeft=8),e}readU(e){let t=0;for(let i=0;i<e;i++)t|=this.readU1()<<e-i-1;return t}remainingLength(){return this.endPointer-this.pointer}getPos(){return this.pointer}skip(e){const t=(e-e%8)/8;this.pointer+=t;const i=e%8;this.bitsLeft<=i?(this.pointer++,this.bitsLeft=8-(i-this.bitsLeft)):this.bitsLeft-=i}flush(){if(!this.onFlush)throw this.error=-1048574,Error("IOReader error, flush failed because of no flush callback");if(0===this.bitsLeft&&this.pointer++,!(this.size-this.remainingLength()<=0))if(this.pointer<this.endPointer){this.buffer.set(this.buffer.subarray(this.pointer,this.endPointer),0);const e=this.onFlush(this.buffer.subarray(this.endPointer-this.pointer,this.size));if(e<0)throw this.error=e,Error("IOReader error, flush failed");this.endPointer=this.endPointer-this.pointer+e,this.pointer=0}else{const e=this.onFlush(this.buffer);if(this.endPointer=e,this.pointer=0,this.bitsLeft=8,e<0)throw this.error=e,Error("IOReader error, flush failed")}}getBuffer(){return this.buffer}appendBuffer(e){if(this.size-this.endPointer>=e.length)this.buffer.set(e,this.endPointer),this.endPointer+=e.length;else if(this.buffer.set(this.buffer.subarray(this.pointer,this.endPointer),0),this.endPointer=this.endPointer-this.pointer,this.pointer=0,this.size-this.endPointer>=e.length)this.buffer.set(e,this.endPointer),this.endPointer+=e.length;else{const t=Math.min(this.size-this.endPointer,e.length);this.buffer.set(e.subarray(0,t),this.endPointer),this.endPointer+=t,r.R8("BSReader, call appendBuffer but the buffer's size is lagger then the remaining size","src/common/io/BitReader.ts",190)}}clear(){this.pointer=this.endPointer=0,this.bitsLeft=8,this.error=0}skipPadding(){this.bitsLeft<8&&(this.bitsLeft=8,this.pointer++)}}},83314:(e,t,i)=>{i.d(t,{A:()=>r});var a=i(134);class r{constructor(e=1048576){(0,a.A)(this,"buffer",void 0),(0,a.A)(this,"pointer",void 0),(0,a.A)(this,"bitPointer",void 0),(0,a.A)(this,"size",void 0),(0,a.A)(this,"error",void 0),(0,a.A)(this,"onFlush",void 0),this.pointer=0,this.bitPointer=0,this.size=e,this.error=0,this.buffer=new Uint8Array(this.size)}writeU1(e){(this.remainingLength()<1||1===this.remainingLength()&&this.bitPointer>=8)&&this.flush(),1&e?this.buffer[this.pointer]|=1<<7-this.bitPointer:this.buffer[this.pointer]&=~(1<<7-this.bitPointer),this.bitPointer++,8===this.bitPointer&&(this.pointer++,this.bitPointer=0)}writeU(e,t){for(let i=0;i<e;i++)this.writeU1(t>>e-i-1&1)}remainingLength(){return this.size-this.pointer}flush(){if(!this.onFlush)throw this.error=-1048574,Error("BSWriter error, flush failed because of no flush callback");if(this.pointer)if(this.bitPointer&&this.pointer>1){const e=this.onFlush(this.buffer.subarray(0,this.pointer-1));if(0!==e)throw this.error=e,Error("BSWriter error, flush failed");this.buffer[0]=this.buffer[this.pointer]}else if(0===this.bitPointer){const e=this.onFlush(this.buffer.subarray(0,this.pointer));if(0!==e)throw this.error=e,Error("BSWriter error, flush failed")}this.pointer=0}padding(){for(;0!==this.bitPointer;)this.writeU1(0)}clear(){this.pointer=0,this.bitPointer=0,this.error=0}getBuffer(){return this.buffer}getPointer(){return this.pointer}}},729:(e,t,i)=>{i.d(t,{A:()=>n});var a=i(134),r=i(4624),s=i(50011);class n{constructor(e,t=!0){(0,a.A)(this,"data",void 0),(0,a.A)(this,"buffer",void 0),(0,a.A)(this,"byteStart",void 0),(0,a.A)(this,"pos",void 0),(0,a.A)(this,"size",void 0),(0,a.A)(this,"littleEndian",void 0),this.buffer=e,this.data=e instanceof Uint8Array?new DataView(e.buffer):e.view,this.byteStart=e instanceof Uint8Array?e.byteOffset:0,this.pos=0,this.size=e.byteLength,this.littleEndian=!t}writeUint8(e){this.data.setUint8(this.pos+++this.byteStart,e)}writeUint16(e){this.data.setUint16(this.pos+this.byteStart,e,this.littleEndian),this.pos+=2}writeUint24(e){const t=3840&e,i=240&e,a=15&e;this.littleEndian?(this.writeUint8(a),this.writeUint8(i),this.writeUint8(t)):(this.writeUint8(t),this.writeUint8(i),this.writeUint8(a))}writeUint32(e){this.data.setUint32(this.pos+this.byteStart,e,this.littleEndian),this.pos+=4}writeUint64(e){const t=e&BigInt(4294967295),i=(e&BigInt(4294967295)<<BigInt(32))>>BigInt(32);this.littleEndian?(this.writeUint32(Number(t)),this.writeUint32(Number(i))):(this.writeUint32(Number(i)),this.writeUint32(Number(t)))}writeInt8(e){this.data.setInt8(this.pos+++this.byteStart,e)}writeInt16(e){this.data.setInt16(this.pos+this.byteStart,e,this.littleEndian),this.pos+=2}writeInt32(e){this.data.setInt32(this.pos+this.byteStart,e,this.littleEndian),this.pos+=4}writeInt64(e){const t=e&BigInt(4294967295),i=(e&BigInt(4294967295)<<BigInt(32))>>BigInt(32);this.littleEndian?(this.writeInt32(Number(t)),this.writeInt32(Number(i))):(this.writeInt32(Number(i)),this.writeInt32(Number(t)))}writeFloat(e){this.data.setFloat32(this.pos+this.byteStart,e,this.littleEndian),this.pos+=4}writeDouble(e){this.data.setFloat64(this.pos+this.byteStart,e,this.littleEndian),this.pos+=8}getPos(){return this.pos}seek(e){e>this.size&&(e=this.size),this.pos=Math.max(0,e)}skip(e){this.seek(this.pos+e)}back(e){this.seek(this.pos-e)}remainingSize(){return this.size-this.pos}writeBuffer(e){let t=e.length;this.remainingSize()<t&&(t=this.remainingSize(),r.R8(`the remaining buffer size is smaller then the wrote buffer, hope set ${e.length}, but set ${t}`,"src/common/io/BufferWriter.ts",211)),this.buffer.set(e,this.pos),this.pos+=e.length}writeString(e){const t=s.encode(e);return this.writeBuffer(t),t.length}getWroteBuffer(){return this.buffer.subarray(0,this.pos)}resetBuffer(e,t=!0){this.buffer=e,this.data=e instanceof Uint8Array?new DataView(e.buffer):e.view,this.byteStart=e instanceof Uint8Array?e.byteOffset:0,this.pos=0,this.size=e.byteLength,this.littleEndian=!t}}}}]);