"use strict";(self.webpackChunkAVPlayer=self.webpackChunkAVPlayer||[]).push([[531],{58469:(a,e,t)=>{t.d(e,{Bq:()=>f,Ij:()=>p,XC:()=>c,f7:()=>l,uF:()=>r});var i=t(77231),s=t(37246);const r={1:"Main",2:"LC",3:"LC",4:"LC",5:"HE",6:"HE"},n={96e3:0,88200:1,64e3:2,48e3:3,44100:4,32e3:5,24e3:6,22050:7,16e3:8,12e3:9,11025:10,8e3:11,7350:12},o=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350,i.N_,i.N_,i.N_],d=[i.N_,1,2,3,4,5,6,7];function c(a,e){if(!e&&a.sideData[1]&&(e=a.sideData[1]),e){const{profile:t,sampleRate:s,channels:r}=function(a){let e=i.N_,t=i.N_,s=i.N_;var r,n;return a.length>=2&&(e=a[0]>>3&31,t=null!==(r=o[(7&a[0])<<1|a[1]>>7])&&void 0!==r?r:48e3,s=null!==(n=d[a[1]>>3&15])&&void 0!==n?n:2),{profile:e,sampleRate:t,channels:s}}(e);a.codecpar.profile=t,a.codecpar.sampleRate=s,a.codecpar.chLayout.nbChannels=r}}function p(a){const e=n[a.sampleRate],t=a.chLayout.nbChannels,i=new Uint8Array(2);return i[0]=(31&a.profile)<<3|(14&e)>>1,i[1]=(1&e)<<7|(15&t)<<3,i}function f(a){if(a.length<7)return-1;const e=a[0]<<4|a[1]>>4;if(4095!==e)return-1;const t=1&a[1],i=(192&a[2])>>>6,s=(60&a[2])>>>2,r=(1&a[2])<<2|(192&a[3])>>>6,n=(3&a[3])<<11|a[4]<<3|(224&a[5])>>>5,c=3&a[6];let p=1===t?7:9,f=n-p;return{syncWord:e,profile:i+1,sampleRate:o[s],channels:d[r],aacFrameLength:n,numberOfRawDataBlocksInFrame:c,headerLength:p,framePayloadLength:f}}function l(a,e){function t(){const a=e.readU(2);let t=0;for(let i=0;i<=a;i++)t<<=8,t|=e.readU(8);return t}e||(e=new s.A).appendBuffer(a);const i=e.getPointer(),r={syncWord:0,profile:0,sampleRate:0,channels:0,useSameStreamMux:!1,headerLength:0,framePayloadLength:0,muxLengthBytes:0},n=e.readU(11);if(695!==n)return-1;r.syncWord=n,r.muxLengthBytes=e.readU(13);const c=1===e.readU1();if(r.useSameStreamMux=c,!c){const a=1===e.readU1();if(a&&1===e.readU1())return-1;if(a&&t(),1!==e.readU1())return-1;if(0!==e.readU(6))return-1;if(0!==e.readU(4))return-1;if(0!==e.readU(3))return-1;let i=a?t():0;const s=e.readU(5);i-=5;const n=e.readU(4);i-=4;const c=e.readU(4);if(i-=4,e.readU(3),i-=3,i>0&&e.readU(i),0!==e.readU(3))return-1;if(e.readU(8),1===e.readU1())if(a)t();else{let a=0;for(;;){a<<=8;const t=1===e.readU1();if(a+=e.readU(8),!t)break}}1===e.readU1()&&e.readU(8),r.profile=s+1,r.sampleRate=o[n],r.channels=d[c]}let p=0;for(;;){const a=e.readU(8);if(p+=a,255!==a)break}return r.framePayloadLength=p,r.headerLength=e.getPointer()-i+(8===e.getBitLeft()?0:1),r}},87771:(a,e,t)=>{t.d(e,{R:()=>m,j:()=>s});var i=t(37246);const s=[3,4,3,7,259,263,1539,1543],r=[[64,69,96],[64,70,96],[80,87,120],[80,88,120],[96,104,144],[96,105,144],[112,121,168],[112,122,168],[128,139,192],[128,140,192],[160,174,240],[160,175,240],[192,208,288],[192,209,288],[224,243,336],[224,244,336],[256,278,384],[256,279,384],[320,348,480],[320,349,480],[384,417,576],[384,418,576],[448,487,672],[448,488,672],[512,557,768],[512,558,768],[640,696,960],[640,697,960],[768,835,1152],[768,836,1152],[896,975,1344],[896,976,1344],[1024,1114,1536],[1024,1115,1536],[1152,1253,1728],[1152,1254,1728],[1280,1393,1920],[1280,1394,1920]],n=[4,5,6,5],o=[4,6,7,6],d=[48e3,44100,32e3,0],c=[32,40,48,56,64,80,96,112,128,160,192,224,256,320,384,448,512,576,640],p=[2,1,2,3,3,4,4,5],f=[1,2,3,6],l=7;function m(a){const e=new i.A(a.length);e.appendBuffer(a);const t={syncWord:0,crc1:0,srCode:0,bitstreamId:0,bitstreamMode:0,channelMode:0,lfeOn:0,frameType:0,substreamId:0,centerMixLevel:0,surroundMixLevel:0,channelMap:0,numBlocks:0,dolbySurroundMode:0,srShift:0,sampleRate:0,bitrate:0,channels:0,frameSize:0,channelLayout:BigInt(0),ac3BitrateCode:0};if(t.syncWord=e.readU(16),2935!==t.syncWord)return-1;if(t.bitstreamId=31&e.peekU(29),t.bitstreamId>16)return-2;if(t.numBlocks=6,t.ac3BitrateCode=-1,t.centerMixLevel=5,t.surroundMixLevel=6,t.dolbySurroundMode=0,t.bitstreamId<=10){if(t.crc1=e.readU(16),t.srCode=e.readU(2),3===t.srCode)return-3;const a=e.readU(6);if(a>37)return-4;t.ac3BitrateCode=a>>1,e.readU(5),t.bitstreamMode=e.readU(3),t.channelMode=e.readU(3),2==t.channelMode?t.dolbySurroundMode=e.readU(2):(1&t.channelMode&&1!=t.channelMode&&(t.centerMixLevel=n[e.readU(2)]),4&t.channelMode&&(t.surroundMixLevel=o[e.readU(2)])),t.lfeOn=e.readU(1),t.srShift=Math.max(t.bitstreamId,8)-8,t.sampleRate=d[t.srCode]>>t.srShift,t.bitrate=1e3*c[t.ac3BitrateCode]>>t.srShift,t.channels=p[t.channelMode]+t.lfeOn,t.frameSize=2*r[a][t.srCode],t.frameType=2,t.substreamId=0}else{if(t.crc1=0,t.frameType=e.readU(2),3==t.frameType)return-5;if(t.substreamId=e.readU(3),t.frameSize=e.readU(11)+1<<1,t.frameSize<l)return-6;if(t.srCode=e.readU(2),3==t.srCode){const a=e.readU(2);if(3==a)return-7;t.sampleRate=d[a]/2,t.srShift=1}else t.numBlocks=f[e.readU(2)],t.sampleRate=d[t.srCode],t.srShift=0;t.channelMode=e.readU(3),t.lfeOn=e.readU(1),t.bitrate=8*t.frameSize*t.sampleRate/(256*t.numBlocks),t.channels=p[t.channelMode]+t.lfeOn}return t.channelLayout=BigInt(s[t.channelMode]),t.lfeOn&&(t.channelLayout|=BigInt(8)),t}},90412:(a,e,t)=>{t.d(e,{Ui:()=>n,XC:()=>r,zk:()=>s});var i=t(37246);const s={0:"Main",1:"High",2:"Professional"};function r(a,e){if(!e&&a.sideData[1]&&(e=a.sideData[1]),e&&e.length>=4){const t=n(e);a.codecpar.profile=t.profile,a.codecpar.level=t.level}}function n(a){const e=new i.A(a.length);e.appendBuffer(a),e.readU1(),e.readU(7);const t=e.readU(3),s=e.readU(5),r=e.readU1();let n=e.readU1()?10:8;return e.readU1()&&(n=12),{profile:t,level:s,tier:r,bitDepth:n,monochrome:e.readU1(),chromaSubsamplingX:e.readU1(),chromaSubsamplingY:e.readU1(),chromaSamplePosition:e.readU(2)}}},65451:(a,e,t)=>{t.d(e,{Ij:()=>c,XC:()=>d,kt:()=>o});var i=t(31865),s=t(729),r=t(44328);const n=[480,960,1920,2880,480,960,1920,2880,480,960,1920,2880,480,960,480,960,120,240,480,960,120,240,480,960,120,240,480,960,120,240,480,960];function o(a){let e=0,t=0,i=0;if(a.length<1)return 0;switch(e=a[0],t=n[e>>3],3&e){case 0:i=1;break;case 1:case 2:i=2;break;case 3:if(a.length<2)return 0;i=63&a[1]}return i*t}function d(a,e){if(!e&&a.sideData[1]&&(e=a.sideData[1]),e&&e.length>=19){const t=new i.A(e,!1);t.skip(9),a.codecpar.chLayout.nbChannels=t.readUint8(),a.codecpar.initialPadding=t.readUint16(),a.codecpar.sampleRate=t.readUint32(),a.codecpar.seekPreroll=Number((0,r.k)(BigInt(80),{den:1e3,num:1},{den:48e3,num:1}))}}function c(a){const e=new Uint8Array(19),t=new s.A(e,!1);return t.writeString("OpusHead"),t.writeUint8(1),t.writeUint8(a.chLayout.nbChannels),t.writeUint16(a.initialPadding),t.writeUint32(a.sampleRate),e}},58919:(a,e,t)=>{t.d(e,{Ui:()=>n,XC:()=>r,wN:()=>s});var i=t(37246);const s={0:"Profile0",1:"Profile1",2:"Profile2",3:"Profile3"};function r(a,e){if(!e&&a.sideData[1]&&(e=a.sideData[1]),e&&e.length>=6){const t=n(e);a.codecpar.profile=t.profile,a.codecpar.level=t.level}}function n(a){const e=new i.A(a.length);return e.appendBuffer(a),{profile:e.readU(8),level:e.readU(8),bitDepth:e.readU(4),chromaSubsampling:e.readU(3),fullRangeFlag:e.readU1(),colorPrimaries:e.readU(8),colorTrc:e.readU(8),colorSpace:e.readU(8)}}},85947:(a,e,t)=>{t.d(e,{A:()=>s});var i=t(134);class s{constructor(){(0,i.A)(this,"type",-1),(0,i.A)(this,"onStreamAdd",void 0)}destroy(a){}}},92047:(a,e,t)=>{t.r(e),t.d(e,{default:()=>k});var i=t(134),s=t(63939),r=t(50932),n=t(4624),o=t(9705),d=t(65977),c=t(74963),p=t(85947),f=t(85428),l=t(9690),m=t(72739),u=t(14686),w=t(37837),g=t(71517),h=t(44328),z=t(77231),v=t(39381),U="src\\avformat\\formats\\IMovFormat.ts";class k extends p.A{constructor(a={}){super(),(0,i.A)(this,"type",1),(0,i.A)(this,"context",void 0),(0,i.A)(this,"options",void 0),this.options=a,this.context=(0,l.A)()}init(a){a.ioReader&&a.ioReader.setEndian(!0)}async readHeader(a){try{const e=await a.ioReader.fileSize();let t=0,i=await a.ioReader.readUint32(),s=await a.ioReader.readUint32();s===(0,d.A)("ftyp")?await c.E6(a.ioReader,this.context,{type:s,size:i-8}):(!e||i<e)&&await a.ioReader.skip(i-8);let r=BigInt(0);for(;!this.context.foundMoov;){const t=a.ioReader.getPos();if(t===e)return n.z3("the file format is not mp4",U,100),o.LR;if(i=await a.ioReader.readUint32(),s=await a.ioReader.readUint32(),i<8||e&&t+BigInt(Math.floor(i))>e)return n.z3(`invalid box size ${i}`,U,108),o.LR;s===(0,d.A)("mdat")?(this.context.foundMdat||(r=t),this.context.foundMdat=!0,await a.ioReader.seek(t+BigInt(Math.floor(i)))):s===(0,d.A)("moov")?(await c.wB(a.ioReader,a,this.context,{size:i-8,type:s}),this.context.foundMoov=!0):await a.ioReader.seek(t+BigInt(Math.floor(i)))}if(!this.context.fragment&&!this.context.foundMdat){const e=await a.ioReader.peekUint64()>>BigInt(32);Number(e)===(0,d.A)("moof")&&(this.context.fragment=!0)}if(this.context.fragment&&1&a.ioReader.flags){const e=a.ioReader.getPos(),t=await a.ioReader.fileSize();if(t>BigInt(16)){await a.ioReader.seek(t-BigInt(12));let i=await a.ioReader.readUint32();if(i===(0,d.A)("mfro")){await a.ioReader.skip(4);const e=await a.ioReader.readUint32();await a.ioReader.seek(t-BigInt(Math.floor(e)));const s=await a.ioReader.readUint32();i=await a.ioReader.readUint32(),i===(0,d.A)("mfra")&&await c.t9(a.ioReader,a,this.context,{size:s-8,type:i})}await a.ioReader.seek(e)}}return!this.context.fragment&&this.context.foundMdat&&await a.ioReader.seek(r),t}catch(e){return n.z3(e.message,U,170),this.context.foundMoov||n.z3("moov not found",U,173),a.ioReader.error}}async readAVPacket_(a,e){const{sample:t,stream:i}=(0,f.G)(a,this.context);if(!t)return-1048576;{r.M[15](e+32,i.index),r.M[17](e+16,t.dts),r.M[17](e+8,t.pts),r.M[17](e+48,BigInt(Math.floor(t.duration))),r.M[15](e+36,s.f[15](e+36)|t.flags),r.M[17](e+56,t.pos),r.M[15](e+76,i.timeBase.den),r.M[15](e+72,i.timeBase.num),i.startTime===z.Dh&&(i.startTime=s.f[17](e+8)||s.f[17](e+16)),await a.ioReader.seek(s.f[17](e+56));const n=t.size,o=(0,w.sY)(n);if((0,g.NX)(e,o,n),await a.ioReader.readBuffer(n,(0,u.JW)(o,n)),27!==i.codecpar.codecId&&173!==i.codecpar.codecId&&196!==i.codecpar.codecId||r.M[15](e+80,1),94226===i.codecpar.codecId&&s.f[15](e+28)>=8){const a=v.Sg(s.f[20](e+24)+4)>>>0,t=s.f[15](e+28);if(a===(0,d.A)("vtte")&&8===t){const a=(0,w.Gy)(1);(0,g.NX)(e,a,1),r.M[15](e+28,1)}if(t>8&&(a===(0,d.A)("vtte")||a===(0,d.A)("vttc"))){let a=s.f[20](e+24)+8;const i=s.f[20](e+24)+t;for(;a<i;){const t=v.Sg(a);if(v.Sg(a+4)>>>0===(0,d.A)("payl")&&t>8){const i=(0,w.sY)(t-8);(0,u.Mr)(i,a+8,t-8),(0,g.NX)(e,i,t-8);break}a+=t}}}if(i.sideData[1]){const a=i.sideData[1].length,t=(0,w.sY)(a);(0,g.Ow)(e,1,t,a),(0,u.lW)(t,a,i.sideData[1]),delete i.sideData[1]}}return 0}async readAVPacket(a,e){try{if(this.context.fragment&&!this.context.currentFragment)for(;!this.context.currentFragment;){const e=a.ioReader.getPos(),t=await a.ioReader.readUint32(),i=await a.ioReader.readUint32();i===(0,d.A)("moof")?(this.context.currentFragment={pos:e,size:t,sequence:0,tracks:[],currentTrack:null},this.context.firstMoof||(this.context.firstMoof=e),await c.wZ(a.ioReader,a,this.context,{type:i,size:t-8})):i===(0,d.A)("moov")?await c.wB(a.ioReader,a,this.context,{size:t-8,type:i}):await a.ioReader.skip(t-8)}return await this.readAVPacket_(a,e)}catch(e){return-1048576!==a.ioReader.error?(n.z3(`read packet error, ${e}`,U,306),o.LR):a.ioReader.error}}async seek(a,e,t,i){const s=t,r=e.privData,n=()=>{this.context.currentFragment=null,a.streams.forEach((a=>{a.privData.samplesIndex.length=0}))};if(16&i&&this.context.fragment){const i=(0,h.k)(t,e.timeBase,z.i0);return await a.ioReader.seek(i,!0),n(),BigInt(0)}if(this.context.fragment){if(r.fragIndexes.length){let e=m.El(r.fragIndexes,(a=>a.time>s?-1:a.time===s?0:1));if(e>-1)return await a.ioReader.seek(r.fragIndexes[e].pos,!0),n(),BigInt(0)}return s===BigInt(0)&&this.context.firstMoof?(await a.ioReader.seek(this.context.firstMoof),n(),BigInt(0)):BigInt(o.E$)}let d=m.El(r.samplesIndex,(a=>a.pts>s?-1:a.pts===s?0:1));if(d>-1&&0===e.codecpar.codecType){let a=d;for(;a>=0;a--)if(1&r.samplesIndex[a].flags){d=a;break}a<0&&(d=-1)}return d>-1?(r.currentSample=d,r.sampleEnd=!1,m.__(a.streams,(a=>{if(a!==e){const t=a.privData;let i=!1,s=(0,h.k)(r.samplesIndex[r.currentSample].pts,e.timeBase,a.timeBase);m.__(t.samplesIndex,((a,e)=>{if(a.pts>=s)return t.currentSample=e,i=!0,!1})),i?t.sampleEnd=!1:(t.sampleEnd=!0,t.currentSample=t.samplesIndex.length)}})),BigInt(0)):BigInt(o.LR)}getAnalyzeStreamsCount(){return 0}}},21071:(a,e,t)=>{t.d(e,{_l:()=>i,gQ:()=>s});const i=["hmhd","nmhd","iods","xml ","url ","bxml","ipro","mere","stts","ctts","stss","stsz","stz2","stsc","stco","co64","stsd","dref","mvhd","tkhd","mdhd","hdlr"],s=["moov","trak","edts","mdia","minf","dinf","stbl","mvex","moof","traf","vttc","tref","iref","mfra","hnti","hinf","strd","sinf","rinf","schi","trgr","udta","iprp","ipco","strk","meco"]},61179:(a,e,t)=>{function i(a,e,t,i=0){const s=a.privData,r=t.trexs.find((a=>a.trackId===e.trackId));let n=e.baseDataOffset+BigInt(Math.floor(e.dataOffset));e.baseIsMoof&&(n+=t.currentFragment.pos);let o=e.baseMediaDecodeTime;const d=e.sampleSizes,c=e.sampleDurations,p=e.sampleFlags,f=e.sampleCompositionTimeOffset;if(!d.length)for(let a=0;a<e.sampleCount;a++)d.push(e.defaultSampleSize||r.size);if(!c.length)for(let a=0;a<e.sampleCount;a++)c.push(e.defaultSampleDuration||r.duration);if(!p.length)for(let a=0;a<e.sampleCount;a++)p.push(e.defaultSampleFlags||r.flags);if(!f.length)for(let a=0;a<e.sampleCount;a++)f.push(0);const l=[];for(let a=0;a<e.sampleCount;a++){const t={dts:o,pts:o+BigInt(Math.floor(f[a])),pos:n,size:d[a],duration:c[a],flags:0};o+=BigInt(Math.floor(t.duration)),n+=BigInt(Math.floor(t.size));let s=p[a];0===a&&e.firstSampleFlags&&(s=e.firstSampleFlags),16842752&s||(t.flags|=1),0===a&&d.length>1&&2&i&&(t.flags|=1),l.push(t)}s.samplesIndex=l}t.d(e,{p:()=>i})},98859:(a,e,t)=>{function i(a){const e=a.privData,t=e.chunkOffsets,i=e.sampleSizes,s=e.cttsSampleCounts,r=e.cttsSampleOffsets,n=e.stscFirstChunk,o=e.stscSamplesPerChunk,d=e.stssSampleNumbersMap,c=e.sttsSampleCounts,p=e.sttsSampleDeltas;if(!t.length)return;let f=0,l=0,m=0,u=0,w=0,g=0,h=BigInt(0),z=0,v=BigInt(0);const U=[];for(let e=0;e<t.length;e++)for(h=t[e],f<n.length-1&&n[f+1]===e+1&&f++,g=o[f];g>0;){const e={dts:v,pts:v,pos:h,size:i[z],duration:0,flags:0};(d&&d.has(z+1)||1===a.codecpar.codecType)&&(e.flags|=1),r&&(e.pts=e.dts+BigInt(Math.floor(r[u])),w++,w===s[u]&&(u++,w=0)),z&&(U[z-1].duration=Number(e.dts-U[z-1].dts)),h+=BigInt(Math.floor(e.size)),v+=BigInt(Math.floor(p[l])),m++,m===c[l]&&(l++,m=0),z++,U.push(e),g--}U.length>1&&(U[z-1].duration=U[z-2].duration),e.samplesIndex=U}t.d(e,{X:()=>i})},3384:(a,e,t)=>{function i(){return{trackId:0,baseDataOffset:BigInt(0),defaultSampleDuration:0,defaultSampleSize:0,defaultSampleFlags:0,baseMediaDecodeTime:BigInt(0),sampleCount:0,dataOffset:0,dataOffsetPos:BigInt(0),firstSampleFlags:0,sampleDurations:[],sampleSizes:[],sampleFlags:[],sampleCompositionTimeOffset:[],baseIsMoof:!1,ioWriter:null,buffers:[]}}t.d(e,{A:()=>i})},9690:(a,e,t)=>{t.d(e,{A:()=>s});var i=t(77231);function s(){return{isom:!1,timescale:i.N_,duration:i.Dh,foundMoov:!1,foundMdat:!1,majorBrand:0,minorVersion:0,compatibleBrand:[],creationTime:BigInt(0),modificationTime:BigInt(0),rate:i.N_,volume:i.N_,matrix:null,nextTrackId:1,fragment:!1,trexs:[],currentFragment:null,boxsPositionInfo:[],holdMoovPos:BigInt(0),currentChunk:null}}},38106:(a,e,t)=>{t.d(e,{A:()=>s});var i=t(77231);function s(){return{chunkOffsets:null,cttsSampleCounts:null,cttsSampleOffsets:null,stscFirstChunk:null,stscSamplesPerChunk:null,stscSampleDescriptionIndex:null,stssSampleNumbersMap:null,stssSampleNumbers:null,sampleSizes:null,sttsSampleCounts:null,sttsSampleDeltas:null,timescale:0,duration:BigInt(0),trackId:i.N_,layer:0,alternateGroup:0,volume:0,matrix:null,width:0,height:0,audioCid:0,samplesPerFrame:0,bytesPerFrame:0,currentSample:0,sampleEnd:!1,samplesIndex:[],fragIndexes:[],lastPts:BigInt(0),lastDts:BigInt(0),startDts:BigInt(0),startCT:0,lastDuration:0,chunkCount:0,firstWrote:!1,lastStscCount:0,perStreamGrouping:!1,index:0,flags:0}}},85428:(a,e,t)=>{t.d(e,{G:()=>r});var i=t(77231),s=t(44328);function r(a,e){let t,r,n,o,d,c,p=BigInt(0);if(a.streams.forEach((a=>{const e=a.privData;if(!e.samplesIndex||!e.samplesIndex.length)return e.sampleEnd=!0,!0;e.sampleEnd||n&&!(e.samplesIndex[e.currentSample].pos<n.pos)||(n=e.samplesIndex[e.currentSample],o=a),e.sampleEnd||d&&!((0,s.k)(e.samplesIndex[e.currentSample].dts,a.timeBase,i.KR)<p)||(d=e.samplesIndex[e.currentSample],p=(0,s.k)(d.dts,a.timeBase,i.KR),c=a)})),n&&d){const e=(0,s.k)(n.dts,o.timeBase,i.KR),p=(0,s.k)(d.dts,c.timeBase,i.KR);Math.abs(Number(e-p))<1e6||2&a.ioReader.flags?(t=n,r=o):(t=d,r=c)}else n?(t=n,r=o):d&&(t=d,r=c);if(r&&(r.privData.currentSample++,r.privData.currentSample>=r.privData.samplesIndex.length&&(r.privData.sampleEnd=!0)),e.fragment){const t=!!a.streams.find((a=>!1===a.privData.sampleEnd));t||(e.currentFragment=null)}return{sample:t,stream:r}}},74963:(a,e,t)=>{t.d(e,{E6:()=>w,t9:()=>v,wB:()=>h,wZ:()=>z});var i=t(65977),s=t(21071),r=t(68361),n=t(4624),o=t(61179),d=t(98859),c=t(3384),p=t(38106),f=t(37837),l=t(14686),m=t(77231),u="src\\avformat\\formats\\mov\\imov.ts";async function w(a,e,t){const s=a.getPos()+BigInt(Math.floor(t.size));for(e.majorBrand=await a.readUint32(),e.minorVersion=await a.readUint32(),e.majorBrand===(0,i.A)("qt  ")&&(e.isom=!0);a.getPos()<s;)e.compatibleBrand.push(await a.readUint32())}async function g(a,e,t,o){const d=a.getPos()+BigInt(Math.floor(t.size));for(;a.getPos()<d;){const t=await a.readUint32(),d=await a.readUint32();if(t<8)return void n.z3(`invalid box size ${t}`,u,76);if(r.A[d])await r.A[d](a,e,{type:d,size:t-8},o);else if(d===(0,i.A)("mdia")){let n=!1,d=BigInt(0);const c=a.getPos()+BigInt(Math.floor(t-8));for(;a.getPos()<c;){const t=await a.readUint32(),c=await a.readUint32();c===(0,i.A)("hdlr")?(await r.A[c](a,e,{type:c,size:t-8},o),n=!0):c===(0,i.A)("minf")&&n?await g(a,e,{type:c,size:t-8},o):c!==(0,i.A)("minf")||n?r.A[c]?await r.A[c](a,e,{type:c,size:t-8},o):s.gQ.some((a=>(0,i.A)(a)===c))?await g(a,e,{type:c,size:t-8},o):await a.skip(t-8):(d=a.getPos()-BigInt(8),await a.skip(t-8))}if(d){const t=a.getPos();await a.seek(d);const i=await a.readUint32(),s=await a.readUint32();await g(a,e,{type:s,size:i-8},o),await a.seek(t)}}else s.gQ.some((a=>(0,i.A)(a)===d))?await g(a,e,{type:d,size:t-8},o):await a.skip(t-8)}}async function h(a,e,t,s){const o=a.getPos()+BigInt(Math.floor(s.size));for(;a.getPos()<o;){const s=await a.readUint32(),o=await a.readUint32();if(s<8)return void n.z3(`invalid box, type: ${o}, size ${s}`,u,209);if(r.A[o])await r.A[o](a,null,{type:o,size:s-8},t);else if(o===(0,i.A)("trak"))if(!t.foundMoov||t.fragment){const i=e.createStream();if(i.privData=(0,p.A)(),await g(a,i,{type:o,size:s-8},t),t.fragment){const a=i.privData,t=e.streams.find((e=>{const t=e.privData;if(e.index!==i.index&&t.trackId===a.trackId)return!0}));t?(i.sideData[1]&&(t.sideData[1]=i.sideData[1],t.codecpar.extradata&&(0,f.Eb)(t.codecpar.extradata),t.codecpar.extradataSize=t.sideData[1].length,t.codecpar.extradata=(0,f.sY)(t.codecpar.extradataSize),(0,l.lW)(t.codecpar.extradata,t.codecpar.extradataSize,t.sideData[1]),i.codecpar.width===m.N_&&a.width>0&&(t.codecpar.width=a.width),i.codecpar.width===m.N_&&a.height>0&&(t.codecpar.height=a.height)),e.removeStream(i),e.streamIndex--):(i.codecpar.width===m.N_&&a.width>0&&(i.codecpar.width=a.width),i.codecpar.width===m.N_&&a.height>0&&(i.codecpar.height=a.height))}else(0,d.X)(i)}else await a.skip(s-8);else o===(0,i.A)("mvex")?(t.fragment=!0,await g(a,null,{type:o,size:s-8},t)):await a.skip(s-8)}}async function z(a,e,t,s){const d=a.getPos()+BigInt(Math.floor(s.size));for(;a.getPos()<d;){const s=await a.readUint32(),d=await a.readUint32();if(s<8)return void n.z3(`invalid box, type: ${d}, size ${s}`,u,314);if(r.A[d])await r.A[d](a,null,{type:d,size:s-8},t);else if(d===(0,i.A)("traf")){const i=(0,c.A)();t.currentFragment.currentTrack=i,await g(a,null,{type:d,size:s-8},t),t.currentFragment.tracks.push(i),t.currentFragment.currentTrack=null;const r=e.streams.find((a=>a.privData.trackId===i.trackId));if(r){const a=r.privData;i.streamIndex=r.index,(0,o.p)(r,i,t,e.ioReader.flags),a.currentSample=0,a.sampleEnd=!1}}else await a.skip(s-8)}}async function v(a,e,t,s){const r=a.getPos()+BigInt(Math.floor(s.size));for(;a.getPos()<r;){const s=a.getPos(),r=await a.readUint32();if(await a.readUint32()===(0,i.A)("tfra")){const s=await a.readUint8();await a.skip(3);const r=await a.readUint32(),n=await a.readUint32(),o=await a.readUint32(),d=e.streams.find((a=>a.privData.trackId===r));if(d){const r=d.privData;let c,p;for(let e=0;e<o;e++){1===s?(c=await a.readUint64(),p=await a.readUint64()):(c=BigInt(Math.floor(await a.readUint32())),p=BigInt(Math.floor(await a.readUint32()))),r.fragIndexes.push({pos:p,time:c});for(let e=0;e<1+(n>>4&3);e++)await a.skip(1);for(let e=0;e<1+(n>>2&3);e++)await a.skip(1);for(let e=0;e<1+(3&n);e++)await a.skip(1)}if(r.fragIndexes.length){await a.seek(r.fragIndexes[r.fragIndexes.length-1].pos);const s=await a.readUint32(),n=await a.readUint32();if(n===(0,i.A)("moof")&&(t.currentFragment={pos:BigInt(0),size:s,sequence:0,tracks:[],currentTrack:null},await z(a,e,t,{size:s,type:n}),r.samplesIndex.length)){const a=r.samplesIndex[r.samplesIndex.length-1];d.duration=a.pts+BigInt(Math.floor(a.duration)),r.samplesIndex.length=0}}}}await a.seek(s+BigInt(Math.floor(r)),!1,!1)}t.currentFragment=null}},6660:(a,e,t)=>{t.d(e,{Q9:()=>r,f3:()=>n,uf:()=>o,zs:()=>s});var i=t(65977);const s={86018:64,86017:105,86076:173,86028:193,86021:221,12:32,27:33,173:35,196:51,167:177,0:0},r={32:12,33:27,35:173,51:196,177:167,64:86018,102:86018,103:86018,104:86018,105:86017,107:86017,173:86076,193:86028,221:86021,0:0},n={vide:0,soun:1,clcp:3,sbtl:3,subt:3,subp:3,text:3},o={[(0,i.A)("mp4a")]:86018,1836253269:86017,[(0,i.A)("Opus")]:86076,[(0,i.A)("fLaC")]:86028,[(0,i.A)("spex")]:86051,[(0,i.A)("SPXN")]:86051,[(0,i.A)("ac-3")]:86019,[(0,i.A)("sac3")]:86019,[i.A.mp4v]:12,[(0,i.A)("av01")]:225,[(0,i.A)("vp08")]:139,[(0,i.A)("vp09")]:167,[(0,i.A)("avc1")]:27,[(0,i.A)("hev1")]:173,[(0,i.A)("hvc1")]:173,[(0,i.A)("vvc1")]:196,[(0,i.A)("vvi1")]:196,[(0,i.A)("text")]:94213,[(0,i.A)("tx3g")]:94213}},38582:(a,e,t)=>{t.d(e,{A:()=>d});var i=t(4624),s=t(14686),r=t(37837),n=t(90412),o="src\\avformat\\formats\\mov\\parsing\\av1c.ts";async function d(a,e,t,d){const c=a.getPos();if(e.codecpar.codecId=225,t.size<=0)return;const p=(0,r.sY)(t.size),f=await a.readBuffer(t.size,(0,s.JW)(p,t.size));d.foundMoov?(e.sideData[1]=f.slice(),(0,r.Eb)(p)):(e.codecpar.extradata=p,e.codecpar.extradataSize=t.size,e.sideData[1]=f.slice()),n.XC(e,e.sideData[1]);const l=t.size-Number(a.getPos()-c);l>0?await a.skip(l):l<0&&i.z3(`read avcc error, size: ${t.size}, read: ${t.size-l}`,o,67)}},73840:(a,e,t)=>{t.d(e,{A:()=>d});var i=t(37837),s=t(14686),r=t(4624),n=t(20620),o="src\\avformat\\formats\\mov\\parsing\\avcc.ts";async function d(a,e,t,d){const c=a.getPos();if(e.codecpar.codecId=27,t.size<=0)return;const p=(0,i.sY)(t.size),f=await a.readBuffer(t.size,(0,s.JW)(p,t.size));d.foundMoov?(e.sideData[1]=f.slice(),(0,i.Eb)(p)):(e.codecpar.extradata=p,e.codecpar.extradataSize=t.size,e.sideData[1]=f.slice()),n.XC(e,e.sideData[1]);const l=t.size-Number(a.getPos()-c);l>0?await a.skip(l):l<0&&r.z3(`read avcc error, size: ${t.size}, read: ${t.size-l}`,o,67)}},37213:(a,e,t)=>{t.d(e,{A:()=>r});var i=t(4624),s="src\\avformat\\formats\\mov\\parsing\\co64.ts";async function r(a,e,t,r){const n=a.getPos(),o=await a.readUint8();await a.skip(3);const d=[],c=await a.readUint32();if(0===o)for(let e=0;e<c;e++)d.push(await a.readUint64());e.privData.chunkOffsets=d;const p=t.size-Number(a.getPos()-n);p>0?await a.skip(p):p<0&&i.z3(`read co64 error, size: ${t.size}, read: ${t.size-p}`,s,56)}},12869:(a,e,t)=>{t.d(e,{A:()=>r});var i=t(4624),s="src\\avformat\\formats\\mov\\parsing\\colr.ts";async function r(a,e,t,r){const n=a.getPos();let o=await a.readString(4);if("nclx"===o||"nclc"===o||"prof"===o)if("prof"===o){const i=await a.readBuffer(t.size-4);e.sideData[28]=i}else{let t=await a.readUint16(),i=await a.readUint16(),s=await a.readUint16();if("nclx"===o){const t=await a.readUint8()>>7;e.codecpar.colorRange=t?2:1}t>=23&&(t=2),i>=19&&(i=2),s>=15&&(s=2),e.codecpar.colorPrimaries=t,e.codecpar.colorTrc=i,e.codecpar.colorSpace=s}else i.R8(`unsupported color_parameter_type: ${o}`,s,79);const d=t.size-Number(a.getPos()-n);d>0?await a.skip(d):d<0&&i.z3(`read vpcc error, size: ${t.size}, read: ${t.size-d}`,s,87)}},59299:(a,e,t)=>{t.d(e,{A:()=>r});var i=t(4624),s="src\\avformat\\formats\\mov\\parsing\\ctts.ts";async function r(a,e,t,r){const n=a.getPos(),o=e.privData;await a.skip(4);const d=[],c=[],p=await a.readUint32();for(let e=0;e<p;e++)d.push(await a.readUint32()),c.push(await a.readInt32());o.cttsSampleCounts=d,o.cttsSampleOffsets=c;const f=t.size-Number(a.getPos()-n);f>0?await a.skip(f):f<0&&i.z3(`read ctts error, size: ${t.size}, read: ${t.size-f}`,s,59)}},7320:(a,e,t)=>{t.d(e,{A:()=>f});var i=t(61499),s=t(63939),r=t(50932),n=t(4624),o=t(71517),d=t(87771),c=t(99991),p="src\\avformat\\formats\\mov\\parsing\\dac3.ts";async function f(a,e,t,f){const l=a.getPos();if(e.codecpar.codecId=86019,t.size<=0)return;const m=(0,o.E4)(e.codecpar[i.o9]+20,e.codecpar[i.o9]+24,7,4),u=s.f[20](m),w=await a.readUint24(),g=w>>14&7,h=w>>11&7,z=w>>10&1;let v=d.j[h];z&&(v|=8),c.bl(e.codecpar[i.o9]+112),c.ML(e.codecpar[i.o9]+112,v),r.M[15](u,g);const U=t.size-Number(a.getPos()-l);U>0?await a.skip(U):U<0&&n.z3(`read avcc error, size: ${t.size}, read: ${t.size-U}`,p,77)}},36868:(a,e,t)=>{t.d(e,{A:()=>f});var i=t(61499),s=t(63939),r=t(50932),n=t(4624),o=t(71517),d=t(87771),c=t(99991),p="src\\avformat\\formats\\mov\\parsing\\dec3.ts";async function f(a,e,t,f){const l=a.getPos();if(e.codecpar.codecId=86056,t.size<=0)return;const m=(0,o.E4)(e.codecpar[i.o9]+20,e.codecpar[i.o9]+24,7,4),u=s.f[20](m);await a.skip(2);const w=await a.readUint24(),g=w>>12&31,h=w>>9&7,z=w>>8&1;let v=d.j[h];z&&(v|=8),c.bl(e.codecpar[i.o9]+112),c.ML(e.codecpar[i.o9]+112,v),r.M[15](u,g),e.codecpar.chLayout.nbChannels>1&&7==g&&r.M[15](u,8);const U=t.size-Number(a.getPos()-l);U>0?await a.skip(U):U<0&&n.z3(`read avcc error, size: ${t.size}, read: ${t.size-U}`,p,82)}},86528:(a,e,t)=>{t.d(e,{A:()=>o});var i=t(4624),s=t(37837),r=t(14686),n="src\\avformat\\formats\\mov\\parsing\\dfla.ts";async function o(a,e,t,o){const d=a.getPos();e.codecpar.codecId=86028,await a.skip(1),await a.skip(3);const c=await a.readUint8(),p=128&c,f=127&c,l=await a.readUint24();if(0===f&&34===l){const t=(0,s.sY)(l),i=await a.readBuffer(l,(0,r.JW)(t,l));o.foundMoov?(e.sideData[1]=i.slice(),(0,s.Eb)(t)):(e.codecpar.extradata=t,e.codecpar.extradataSize=l)}else i.z3("streaminfo must be first FLACMetadataBlock",n,67);p||i.R8("non streaminfo FLACMetadataBlock(s) ignored",n,71);const m=t.size-Number(a.getPos()-d);m>0?await a.skip(m):m<0&&i.z3(`read vpcc error, size: ${t.size}, read: ${t.size-m}`,n,79)}},41781:(a,e,t)=>{t.d(e,{A:()=>p});var i=t(4624),s=t(37837),r=t(14686),n=t(65451),o=t(31865),d=t(729),c="src\\avformat\\formats\\mov\\parsing\\dops.ts";async function p(a,e,t,p){const f=a.getPos();e.codecpar.codecId=86076,await a.skip(1);const l=(0,s.sY)(t.size+8),m=(0,r.JW)(l,t.size+8),u=new o.A(m),w=new d.A(m,!1);w.writeString("OpusHead"),w.writeUint8(1),await a.readBuffer(t.size-1,(0,r.JW)(l+9,t.size-1)),u.seek(10),w.seek(10),w.writeUint16(u.readUint16()),w.writeUint32(u.readUint32()),w.writeUint16(u.readUint16()),p.foundMoov?(e.sideData[1]=m.slice(),(0,s.Eb)(l)):(e.codecpar.extradata=l,e.codecpar.extradataSize=m.length,n.XC(e,m.slice()));const g=t.size-Number(a.getPos()-f);g>0?await a.skip(g):g<0&&i.z3(`read dops error, size: ${t.size}, read: ${t.size-g}`,c,81)}},28412:(a,e,t)=>{t.d(e,{A:()=>f});var i=t(4624),s=t(6660),r=t(37837),n=t(14686),o=t(58469),d=t(65451),c="src\\avformat\\formats\\mov\\parsing\\esds.ts";async function p(a){let e=0;for(let t=0;t<4;t++){const t=await a.readUint8();if(e=e<<7|127&t,!(128&t))break}return e}async function f(a,e,t,f){const l=a.getPos();await a.skip(4);let m=a.getPos()+BigInt(Math.floor(t.size-4));for(;a.getPos()<m;){let t=await a.readUint8(),l=await p(a);if(0!==l)if(3===t){let m=a.getPos()+BigInt(Math.floor(l));if(await a.skip(2),await a.skip(1),t=await a.readUint8(),l=await p(a),0===l){i.R8("esds invalid ES descriptor size 0, skip",c,85),await a.skip(Number(m-a.getPos()));continue}if(4===t)if(e.codecpar.codecId=s.Q9[await a.readUint8()],await a.skip(1),await a.skip(3),await a.skip(4),await a.skip(4),a.getPos()<m-BigInt(5))if(t=await a.readUint8(),l=await p(a),5===t){const t=(0,r.sY)(l),i=await a.readBuffer(l,(0,n.JW)(t,l));f.foundMoov?(e.sideData[1]=i.slice(),(0,r.Eb)(t)):(e.codecpar.extradata=t,e.codecpar.extradataSize=l,86018===e.codecpar.codecId?o.XC(e,i.slice()):86076===e.codecpar.codecId&&d.XC(e,i.slice()))}else await a.skip(Number(m-a.getPos()));else await a.skip(Number(m-a.getPos()));else await a.skip(Math.min(l,Number(m-a.getPos())))}else await a.skip(Math.min(l,Number(m-a.getPos())));else i.R8("esds invalid descriptor size 0, skip",c,68),await a.skip(Number(m-a.getPos()))}const u=t.size-Number(a.getPos()-l);u>0?await a.skip(u):u<0&&i.z3(`read vpcc error, size: ${t.size}, read: ${t.size-u}`,c,153)}},40179:(a,e,t)=>{t.d(e,{A:()=>o});var i=t(4624),s=t(34677),r=t(6660),n="src\\avformat\\formats\\mov\\parsing\\hdlr.ts";async function o(a,e,t,o){const d=a.getPos(),c=await a.readUint8();if(await a.skip(3),0===c){await a.skip(4);const i=await a.readString(4),n=r.f3[i];(0,s.A)(n)&&(e.codecpar.codecType=n),await a.skip(4),await a.skip(4),await a.skip(4);const d=t.size-24;if(d>0){const t=!o.isom&&await a.peekUint8()===d-1;t&&await a.skip(1),e.metadata.handlerName=await a.readString(d-(t?1:0))}}const p=t.size-Number(a.getPos()-d);p>0?await a.skip(p):p<0&&i.z3(`read hdlr error, size: ${t.size}, read: ${t.size-p}`,n,77)}},31421:(a,e,t)=>{t.d(e,{A:()=>d});var i=t(37837),s=t(14686),r=t(4624),n=t(53e3),o="src\\avformat\\formats\\mov\\parsing\\hvcc.ts";async function d(a,e,t,d){const c=a.getPos();if(e.codecpar.codecId=173,t.size<=0)return;const p=(0,i.sY)(t.size),f=await a.readBuffer(t.size,(0,s.JW)(p,t.size));d.foundMoov?(e.sideData[1]=f.slice(),(0,i.Eb)(p)):(e.codecpar.extradata=p,e.codecpar.extradataSize=t.size,e.sideData[1]=f.slice()),n.XC(e,e.sideData[1]);const l=t.size-Number(a.getPos()-c);l>0?await a.skip(l):l<0&&r.z3(`read hevc error, size: ${t.size}, read: ${t.size-l}`,o,67)}},45248:(a,e,t)=>{t.d(e,{A:()=>r});var i=t(4624),s="src\\avformat\\formats\\mov\\parsing\\mdhd.ts";async function r(a,e,t,r){const n=a.getPos(),o=await a.readUint8();await a.skip(3);let d=BigInt(0),c=BigInt(0),p=0,f=BigInt(0);1===o?(d=await a.readUint64(),c=await a.readUint64(),p=await a.readUint32(),f=await a.readUint64()):(d=BigInt(Math.floor(await a.readUint32())),c=BigInt(Math.floor(await a.readUint32())),p=await a.readUint32(),f=BigInt(Math.floor(await a.readUint32()))),e.duration=f,e.timeBase.den=p,e.timeBase.num=1,e.metadata.creationTime=d,e.metadata.modificationTime=c;const l=await a.readUint16(),m=[];m[0]=l>>10&31,m[1]=l>>5&31,m[2]=31&l;const u=String.fromCharCode(m[0]+96,m[1]+96,m[2]+96);e.metadata.language=l,e.metadata.languageString=u,await a.skip(2);const w=t.size-Number(a.getPos()-n);w>0?await a.skip(w):w<0&&i.z3(`read mdhd error, size: ${t.size}, read: ${t.size-w}`,s,83)}},7018:(a,e,t)=>{t.d(e,{A:()=>r});var i=t(4624),s="src\\avformat\\formats\\mov\\parsing\\mfhd.ts";async function r(a,e,t,r){const n=a.getPos();await a.readUint8(),await a.skip(3),r.currentFragment.sequence=await a.readUint32();const o=t.size-Number(a.getPos()-n);o>0?await a.skip(o):o<0&&i.z3(`read vpcc error, size: ${t.size}, read: ${t.size-o}`,s,49)}},19354:(a,e,t)=>{t.d(e,{A:()=>r});var i=t(4624),s="src\\avformat\\formats\\mov\\parsing\\mvhd.ts";async function r(a,e,t,r){const n=a.getPos(),o=await a.readUint8();await a.skip(3),1===o?(r.creationTime=await a.readUint64(),r.modificationTime=await a.readUint64(),r.timescale=await a.readUint32(),r.duration=await a.readUint64()):(r.creationTime=BigInt(Math.floor(await a.readUint32())),r.modificationTime=BigInt(Math.floor(await a.readUint32())),r.timescale=await a.readUint32(),r.duration=BigInt(Math.floor(await a.readUint32()))),r.rate=await a.readUint32(),r.volume=await a.readUint16()>>>8,await a.skip(10),r.matrix=new Uint32Array(9);for(let e=0;e<9;e++)r.matrix[e]=await a.readUint32();await a.skip(24),r.nextTrackId=await a.readUint32();const d=t.size-Number(a.getPos()-n);d>0?await a.skip(d):d<0&&i.z3(`read mvhd error, size: ${t.size}, read: ${t.size-d}`,s,70)}},68361:(a,e,t)=>{t.d(e,{A:()=>A});var i=t(91635),s=t(59299),r=t(63080),n=t(62831),o=t(6570),d=t(34136),c=t(15692),p=t(37213),f=t(45248),l=t(19354),m=t(27436),u=t(40179),w=t(35173),g=t(25778),h=t(7018),z=t(61807),v=t(67523),U=t(58996),k=t(65977);const A={[(0,k.A)("stts")]:i.A,[(0,k.A)("ctts")]:s.A,[(0,k.A)("stss")]:r.A,[(0,k.A)("stsz")]:n.A,[(0,k.A)("stz2")]:o.A,[(0,k.A)("stsc")]:d.A,[(0,k.A)("stco")]:c.A,[(0,k.A)("co64")]:p.A,[(0,k.A)("mdhd")]:f.A,[(0,k.A)("mvhd")]:l.A,[(0,k.A)("tkhd")]:m.A,[(0,k.A)("hdlr")]:u.A,[(0,k.A)("stsd")]:w.A,[(0,k.A)("trex")]:g.A,[(0,k.A)("mfhd")]:h.A,[(0,k.A)("tfhd")]:z.A,[(0,k.A)("tfdt")]:v.A,[(0,k.A)("trun")]:U.A}},15692:(a,e,t)=>{t.d(e,{A:()=>r});var i=t(4624),s="src\\avformat\\formats\\mov\\parsing\\stco.ts";async function r(a,e,t,r){const n=a.getPos(),o=await a.readUint8();await a.skip(3);const d=[],c=await a.readUint32();if(0===o)for(let e=0;e<c;e++)d.push(BigInt(Math.floor(await a.readUint32())));e.privData.chunkOffsets=d;const p=t.size-Number(a.getPos()-n);p>0?await a.skip(p):p<0&&i.z3(`read stco error, size: ${t.size}, read: ${t.size-p}`,s,56)}},34136:(a,e,t)=>{t.d(e,{A:()=>r});var i=t(4624),s="src\\avformat\\formats\\mov\\parsing\\stsc.ts";async function r(a,e,t,r){const n=a.getPos(),o=await a.readUint8();await a.skip(3);const d=e.privData,c=[],p=[],f=[],l=await a.readUint32();if(0===o)for(let e=0;e<l;e++)c.push(await a.readUint32()),p.push(await a.readUint32()),f.push(await a.readUint32());d.stscFirstChunk=c,d.stscSamplesPerChunk=p,d.stscSampleDescriptionIndex=f;const m=t.size-Number(a.getPos()-n);m>0?await a.skip(m):m<0&&i.z3(`read stsc error, size: ${t.size}, read: ${t.size-m}`,s,65)}},35173:(a,e,t)=>{t.d(e,{A:()=>v});var i=t(4624),s=t(65977),r=t(6660),n=t(73840),o=t(31421),d=t(60703),c=t(83561),p=t(38582),f=t(28412),l=t(28460),m=t(86528),u=t(41781),w=t(12869),g=t(7320),h=t(36868),z="src\\avformat\\formats\\mov\\parsing\\stsd.ts";async function v(a,e,t,v){const U=a.getPos(),k=await a.readUint8();await a.skip(3);const A=e.privData,I=await a.readUint32();for(let t=0;t<I;t++){const t=await a.readUint32(),U=await a.readUint32(),I=a.getPos()+BigInt(Math.floor(t-8));if(r.uf[U]&&(e.codecpar.codecId=r.uf[U]),0===t){i.R8("stsd entry invalid box size 0, skip",z,73),await a.skip(Number(I-a.getPos()));break}if(t>=16?(await a.skip(6),await a.skip(2)):t<=7&&i.h2(`invalid size: ${t} in stsd`,z,86),0===e.codecpar.codecType){await a.skip(2),await a.skip(2),e.metadata.vendorId=await a.readString(4),await a.skip(4),await a.skip(4),e.codecpar.width=await a.readUint16(),e.codecpar.height=await a.readUint16(),await a.skip(4),await a.skip(4),await a.skip(4),await a.skip(2);let t=await a.readUint8();for(t>31&&(t=31),e.metadata.encoder=await a.readString(t),t<31&&await a.skip(31-t),await a.skip(2),await a.skip(2);a.getPos()<I;){const t=await a.readUint32(),r=await a.readUint32();0!==t?r===(0,s.A)("avcC")?await(0,n.A)(a,e,{type:r,size:t-8},v):r===(0,s.A)("hvcC")?await(0,o.A)(a,e,{type:r,size:t-8},v):r===(0,s.A)("vvcC")?await(0,d.A)(a,e,{type:r,size:t-8},v):r===(0,s.A)("av1C")?await(0,p.A)(a,e,{type:r,size:t-8},v):r===(0,s.A)("vpcC")?await(0,c.A)(a,e,{type:r,size:t-8},v):r===(0,s.A)("esds")?await(0,f.A)(a,e,{type:r,size:t-8},v):r===(0,s.A)("wave")?await(0,l.A)(a,e,{type:r,size:t-8},v):r===(0,s.A)("colr")?await(0,w.A)(a,e,{type:r,size:t-8},v):await a.skip(Math.min(t-8,Number(I-a.getPos()))):(i.R8("stsd video invalid box size 0, skip",z,135),await a.skip(Number(I-a.getPos())))}}else if(1===e.codecpar.codecType){const t=await a.readUint16();for(await a.skip(2),e.metadata.vendorId=await a.readString(4),e.codecpar.chLayout.nbChannels=await a.readUint16(),e.codecpar.bitsPerCodedSample=await a.readUint16(),A.audioCid=await a.readUint16(),await a.skip(2),e.codecpar.sampleRate=await a.readUint32()>>>16,(!v.isom||0===k&&t>0)&&(1===t?(A.samplesPerFrame=await a.readUint32(),await a.skip(4),A.bytesPerFrame=await a.readUint32(),await a.skip(4)):2===t&&(await a.skip(4),e.codecpar.sampleRate=Number(await a.readUint64()),e.codecpar.chLayout.nbChannels=await a.readUint32(),await a.skip(4),e.codecpar.bitsPerCodedSample=await a.readUint32(),await a.skip(4),A.bytesPerFrame=await a.readUint32(),A.samplesPerFrame=await a.readUint32()));a.getPos()<I;){const t=await a.readUint32(),r=await a.readUint32();0!==t?r===(0,s.A)("esds")?await(0,f.A)(a,e,{type:r,size:t-8},v):r===(0,s.A)("dfLa")?await(0,m.A)(a,e,{type:r,size:t-8},v):r===(0,s.A)("dOps")?await(0,u.A)(a,e,{type:r,size:t-8},v):r===(0,s.A)("wave")?await(0,l.A)(a,e,{type:r,size:t-8},v):r===(0,s.A)("dac3")?await(0,g.A)(a,e,{type:r,size:t-8},v):r===(0,s.A)("dec3")?await(0,h.A)(a,e,{type:r,size:t-8},v):await a.skip(Math.min(t-8,Number(I-a.getPos()))):(i.R8("stsd audio invalid box size 0, skip",z,282),await a.skip(Number(I-a.getPos())))}}else 3===e.codecpar.codecType?(U===(0,s.A)("stpp")?e.codecpar.codecId=94232:U===(0,s.A)("wvtt")?e.codecpar.codecId=94226:U===(0,s.A)("tx3g")||U===(0,s.A)("text")?e.codecpar.codecId=94213:U===(0,s.A)("c608")&&(e.codecpar.codecId=94218),await a.skip(Math.min(t-8,Number(I-a.getPos())))):await a.skip(Math.min(t-8,Number(I-a.getPos())))}const b=t.size-Number(a.getPos()-U);b>0?await a.skip(b):b<0&&i.z3(`read stsd error, size: ${t.size}, read: ${t.size-b}`,z,383)}},63080:(a,e,t)=>{t.d(e,{A:()=>o});var i=t(80662),s=t.n(i),r=t(4624),n="src\\avformat\\formats\\mov\\parsing\\stss.ts";async function o(a,e,t,i){const o=a.getPos(),d=await a.readUint8();await a.skip(3);const c=new(s()),p=await a.readUint32();if(0===d)for(let e=0;e<p;e++)c.set(await a.readUint32(),!0);e.privData.stssSampleNumbersMap=c;const f=t.size-Number(a.getPos()-o);f>0?await a.skip(f):f<0&&r.z3(`read stss error, size: ${t.size}, read: ${t.size-f}`,n,57)}},62831:(a,e,t)=>{t.d(e,{A:()=>r});var i=t(4624),s="src\\avformat\\formats\\mov\\parsing\\stsz.ts";async function r(a,e,t,r){const n=a.getPos(),o=await a.readUint8();await a.skip(3);const d=[];let c=0,p=0;if(0===o){c=await a.readUint32(),p=await a.readUint32();for(let e=0;e<p;e++)0===c?d.push(await a.readUint32()):d[e]=c}e.privData.sampleSizes=d;const f=t.size-Number(a.getPos()-n);f>0?await a.skip(f):f<0&&i.z3(`read stsz error, size: ${t.size}, read: ${t.size-f}`,s,65)}},91635:(a,e,t)=>{t.d(e,{A:()=>r});var i=t(4624),s="src\\avformat\\formats\\mov\\parsing\\stts.ts";async function r(a,e,t,r){const n=a.getPos(),o=await a.readUint8();await a.skip(3);const d=e.privData,c=[],p=[],f=await a.readUint32();let l=1;if(0===o)for(let e=0;e<f;e++)c.push(await a.readUint32()),l=await a.readInt32(),l<0&&i.R8("File uses negative stts sample delta, using value 1 instead, sync may be lost!",s,53),p.push(l);d.sttsSampleCounts=c,d.sttsSampleDeltas=p;const m=t.size-Number(a.getPos()-n);m>0?await a.skip(m):m<0&&i.z3(`read stts error, size: ${t.size}, read: ${t.size-m}`,s,67)}},6570:(a,e,t)=>{t.d(e,{A:()=>r});var i=t(4624),s="src\\avformat\\formats\\mov\\parsing\\stz2.ts";async function r(a,e,t,r){const n=a.getPos(),o=await a.readUint8();await a.skip(3);const d=[];let c=0,p=0;if(0===o)if(await a.skip(3),p=await a.readUint8(),c=await a.readUint32(),4===p)for(let e=0;e<c;e+=2){const t=await a.readUint8();d[e]=t>>4&15,d[e+1]=15&t}else if(8===p)for(let e=0;e<c;e++)d[e]=await a.readUint8();else if(16===p)for(let e=0;e<c;e++)d[e]=await a.readUint16();else i.z3("Error in length field in stz2 box",s,67);e.privData.sampleSizes=d;const f=t.size-Number(a.getPos()-n);f>0?await a.skip(f):f<0&&i.z3(`read stz2 error, size: ${t.size}, read: ${t.size-f}`,s,78)}},67523:(a,e,t)=>{t.d(e,{A:()=>r});var i=t(4624),s="src\\avformat\\formats\\mov\\parsing\\tfdt.ts";async function r(a,e,t,r){const n=a.getPos(),o=await a.readUint8();await a.skip(3);const d=r.currentFragment.currentTrack;d&&(d.baseMediaDecodeTime=1===o?await a.readUint64():BigInt(Math.floor(await a.readUint32())));const c=t.size-Number(a.getPos()-n);c>0?await a.skip(c):c<0&&i.z3(`read vpcc error, size: ${t.size}, read: ${t.size-c}`,s,57)}},61807:(a,e,t)=>{t.d(e,{A:()=>r});var i=t(4624),s="src\\avformat\\formats\\mov\\parsing\\tfhd.ts";async function r(a,e,t,r){const n=a.getPos(),o=(await a.readUint8(),await a.readUint24()),d=await a.readUint32(),c=r.currentFragment.currentTrack;c.trackId=d,c&&(1&o&&(c.baseDataOffset=await a.readUint64()),2&o&&await a.skip(4),8&o&&(c.defaultSampleDuration=await a.readUint32()),16&o&&(c.defaultSampleSize=await a.readUint32()),32&o&&(c.defaultSampleFlags=await a.readUint32()),131072&o&&(c.baseIsMoof=!0));const p=t.size-Number(a.getPos()-n);p>0?await a.skip(p):p<0&&i.z3(`read vpcc error, size: ${t.size}, read: ${t.size-p}`,s,75)}},27436:(a,e,t)=>{t.d(e,{A:()=>r});var i=t(4624),s="src\\avformat\\formats\\mov\\parsing\\tkhd.ts";async function r(a,e,t,r){const n=e.privData,o=a.getPos(),d=await a.readUint8();n.flags=await a.readUint24(),1&n.flags&&(e.disposition|=1),1===d?(e.metadata.creationTime=await a.readUint64(),e.metadata.modificationTime=await a.readUint64(),n.trackId=await a.readUint32(),await a.skip(4),n.duration=await a.readUint64()):(e.metadata.creationTime=BigInt(Math.floor(await a.readUint32())),e.metadata.modificationTime=BigInt(Math.floor(await a.readUint32())),n.trackId=await a.readUint32(),await a.skip(4),n.duration=BigInt(Math.floor(await a.readUint32()))),await a.skip(8),n.layer=await a.readInt16(),n.alternateGroup=await a.readInt16(),n.volume=await a.readInt16()>>8,await a.skip(2),n.matrix=new Uint32Array(9);for(let e=0;e<9;e++)n.matrix[e]=await a.readUint32();n.width=await a.readUint32()>>16,n.height=await a.readUint32()>>16;const c=t.size-Number(a.getPos()-o);c>0?await a.skip(c):c<0&&i.z3(`read tkhd error, size: ${t.size}, read: ${t.size-c}`,s,82)}},25778:(a,e,t)=>{t.d(e,{A:()=>r});var i=t(4624),s="src\\avformat\\formats\\mov\\parsing\\trex.ts";async function r(a,e,t,r){const n=a.getPos();await a.readUint8(),await a.skip(3);const o=await a.readUint32();await a.skip(4);const d=await a.readUint32(),c=await a.readUint32(),p=await a.readUint32();r.trexs.push({trackId:o,duration:d,size:c,flags:p});const f=t.size-Number(a.getPos()-n);f>0?await a.skip(f):f<0&&i.z3(`read trex error, size: ${t.size}, read: ${t.size-f}`,s,61)}},58996:(a,e,t)=>{t.d(e,{A:()=>r});var i=t(4624),s="src\\avformat\\formats\\mov\\parsing\\trun.ts";async function r(a,e,t,r){const n=a.getPos(),o=await a.readUint8(),d=await a.readUint24(),c=r.currentFragment.currentTrack;if(c){c.sampleCount=await a.readUint32(),1&d&&(c.dataOffset=await a.readInt32()),4&d&&(c.firstSampleFlags=await a.readUint32());for(let e=0;e<c.sampleCount;e++)256&d&&c.sampleDurations.push(await a.readUint32()),512&d&&c.sampleSizes.push(await a.readUint32()),1024&d&&c.sampleFlags.push(await a.readUint32()),2048&d&&(0===o?c.sampleCompositionTimeOffset.push(await a.readUint32()):c.sampleCompositionTimeOffset.push(await a.readInt32()))}const p=t.size-Number(a.getPos()-n);p>0?await a.skip(p):p<0&&i.z3(`read vpcc error, size: ${t.size}, read: ${t.size-p}`,s,79)}},83561:(a,e,t)=>{t.d(e,{A:()=>d});var i=t(37837),s=t(14686),r=t(4624),n=t(58919),o="src\\avformat\\formats\\mov\\parsing\\vpcc.ts";async function d(a,e,t,d){const c=a.getPos();if(await a.readUint8(),await a.skip(3),e.codecpar.codecId=167,t.size-4<=0)return;const p=(0,i.sY)(t.size-4),f=await a.readBuffer(t.size-4,(0,s.JW)(p,t.size-4));d.foundMoov?(e.sideData[1]=f.slice(),(0,i.Eb)(p)):(e.codecpar.extradata=p,e.codecpar.extradataSize=t.size-4,e.sideData[1]=f.slice()),n.XC(e,e.sideData[1]);const l=t.size-Number(a.getPos()-c);l>0?await a.skip(l):l<0&&r.z3(`read vpcc error, size: ${t.size}, read: ${t.size-l}`,o,71)}},60703:(a,e,t)=>{t.d(e,{A:()=>d});var i=t(37837),s=t(14686),r=t(4624),n=t(55611),o="src\\avformat\\formats\\mov\\parsing\\vvcc.ts";async function d(a,e,t,d){const c=a.getPos();if(await a.readUint8(),await a.skip(3),e.codecpar.codecId=196,t.size-4<=0)return;const p=(0,i.sY)(t.size-4),f=await a.readBuffer(t.size-4,(0,s.JW)(p,t.size-4));d.foundMoov?(e.sideData[1]=f.slice(),(0,i.Eb)(p)):(e.codecpar.extradata=p,e.codecpar.extradataSize=t.size-4,e.sideData[1]=f.slice()),n.XC(e,e.sideData[1]);const l=t.size-Number(a.getPos()-c);l>0?await a.skip(l):l<0&&r.z3(`read vvcc error, size: ${t.size}, read: ${t.size-l}`,o,71)}},28460:(a,e,t)=>{t.d(e,{A:()=>o});var i=t(4624),s=t(65977),r=t(28412),n="src\\avformat\\formats\\mov\\parsing\\wave.ts";async function o(a,e,t,o){const d=a.getPos(),c=d+BigInt(Math.floor(t.size));for(;a.getPos()<c;){const t=await a.readUint32(),d=await a.readUint32();0!==t?d===(0,s.A)("esds")?await(0,r.A)(a,e,{type:d,size:t-8},o):await a.skip(Math.min(t-8,Number(c-a.getPos()))):(i.R8("wave invalid box size 0, skip",n,47),await a.skip(Number(c-a.getPos())))}const p=t.size-Number(a.getPos()-d);p>0?await a.skip(p):p<0&&i.z3(`read vpcc error, size: ${t.size}, read: ${t.size-p}`,n,73)}},65977:(a,e,t)=>{t.d(e,{A:()=>r});var i=t(4624),s="src\\avformat\\function\\mktag.ts";function r(a){4!==a.length&&i.R8(`tag length is not 4, tag: ${a}`,s,30);let e=0;for(let t=0;t<4;t++)e=e<<8|a.charCodeAt(t);return e}},null:()=>{}}]);