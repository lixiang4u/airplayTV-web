"use strict";(self.webpackChunkAVPlayer=self.webpackChunkAVPlayer||[]).push([[94],{58469:(e,t,r)=>{r.d(t,{En:()=>u,Ij:()=>p,XC:()=>o,hY:()=>i,uF:()=>s});var a=r(134),n=r(77231),s=(0,a.A)((0,a.A)((0,a.A)((0,a.A)((0,a.A)((0,a.A)({},1,"Main"),2,"LC"),3,"LC"),4,"LC"),5,"HE"),6,"HE"),c={96e3:0,88200:1,64e3:2,48e3:3,44100:4,32e3:5,24e3:6,22050:7,16e3:8,12e3:9,11025:10,8e3:11,7350:12},i=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350,n.N_,n.N_,n.N_],u=[n.N_,1,2,3,4,5,6,7];function o(e,t){if(!t&&e.sideData[1]&&(t=e.sideData[1]),t){var r=function(e){var t,r,a=n.N_,s=n.N_,c=n.N_;return e.length>=2&&(a=e[0]>>3&31,s=null!==(t=i[(7&e[0])<<1|e[1]>>7])&&void 0!==t?t:48e3,c=null!==(r=u[e[1]>>3&15])&&void 0!==r?r:2),{profile:a,sampleRate:s,channels:c}}(t),a=r.profile,s=r.sampleRate,c=r.channels;e.codecpar.profile=a,e.codecpar.sampleRate=s,e.codecpar.chLayout.nbChannels=c}}function p(e){var t=c[e.sampleRate],r=e.chLayout.nbChannels,a=new Uint8Array(2);return a[0]=(31&e.profile)<<3|(14&t)>>1,a[1]=(1&t)<<7|(15&r)<<3,a}},47094:(e,t,r)=>{r.r(t),r.d(t,{default:()=>M});var a=r(88435),n=r.n(a),s=r(25182),c=r(78716),i=r(81570),u=r(77193),o=r(25767),p=r(43070),f=r(31060),d=r(134),k=r(36443),l=r.n(k),x=r(63939),h=r(50932),b=r(4624),m=r(9705),v=r(85947),R=r(14686),y=r(37837),A=r(71517),B=r(44328),g=r(77231),I=r(72739),P=r(58469);function S(e,t,r){return t=(0,o.A)(t),(0,u.A)(e,w()?n()(t,r||[],(0,o.A)(e).constructor):t.apply(e,r))}function w(){try{var e=!Boolean.prototype.valueOf.call(n()(Boolean,[],(function(){})))}catch(e){}return(w=function(){return!!e})()}var z="src/avformat/formats/IAacFormat.ts",M=function(e){function t(){var e;return(0,c.A)(this,t),e=S(this,t),(0,d.A)((0,p.A)(e),"type",12),(0,d.A)((0,p.A)(e),"frameType",void 0),(0,d.A)((0,p.A)(e),"fileSize",void 0),(0,d.A)((0,p.A)(e),"currentPts",void 0),e}var r,a,n,u,o;return(0,f.A)(t,e),(0,i.A)(t,[{key:"init",value:function(e){this.currentPts=BigInt(0)}},{key:"estimateTotalBlock",value:(o=(0,s.A)(l().mark((function e(t){var r,a,n,s,c;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=0,a=t.ioReader.getPos();case 2:return e.prev=3,e.next=6,t.ioReader.peekBuffer(7);case 6:return n=e.sent,s=(3&n[3])<<11|n[4]<<3|(224&n[5])>>>5,c=3&n[6],r+=c+1,e.next=12,t.ioReader.skip(s);case 12:e.next=17;break;case 14:return e.prev=14,e.t0=e.catch(3),e.abrupt("break",19);case 17:e.next=2;break;case 19:return e.next=21,t.ioReader.seek(a);case 21:return e.abrupt("return",r);case 22:case"end":return e.stop()}}),e,null,[[3,14]])}))),function(e){return o.apply(this,arguments)})},{key:"readHeader",value:(u=(0,s.A)(l().mark((function e(t){var r,a,n,s,c,i,u,o;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.ioReader.peekBuffer(4);case 2:return r=e.sent,e.next=5,t.ioReader.fileSize();case 5:if(this.fileSize=e.sent,65!==r[0]||68!==r[1]||73!==r[2]||70!==r[3]){e.next=13;break}(a=t.createStream()).codecpar.codecId=86018,a.codecpar.codecType=1,this.frameType=0,e.next=52;break;case 13:if(255!==r[0]||240&~r[1]){e.next=51;break}return this.frameType=1,(n=t.createStream()).codecpar.codecId=86018,n.codecpar.codecType=1,e.next=20,t.ioReader.peekBuffer(7);case 20:return s=e.sent,c=(192&s[2])>>>6,i=(60&s[2])>>>2,u=(1&s[2])<<2|(192&s[3])>>>6,n.codecpar.profile=c+1,n.codecpar.sampleRate=P.hY[i],n.codecpar.chLayout.nbChannels=P.En[u],o=(0,P.Ij)(n.codecpar),n.codecpar.extradata=(0,y.sY)(o.length),(0,R.lW)(n.codecpar.extradata,o.length,o),n.codecpar.extradataSize=o.length,n.timeBase.den=n.codecpar.sampleRate,n.timeBase.num=1,e.t0=B.k,e.t1=BigInt,e.t2=Math,e.next=38,this.estimateTotalBlock(t);case 38:e.t3=e.sent,e.t4=1024*e.t3,e.t5=n.codecpar.sampleRate,e.t6=e.t4/e.t5,e.t7=g.SF,e.t8=e.t6*e.t7,e.t9=e.t2.floor.call(e.t2,e.t8),e.t10=(0,e.t1)(e.t9),e.t11=g.KR,e.t12=n.timeBase,n.duration=(0,e.t0)(e.t10,e.t11,e.t12),e.next=52;break;case 51:return e.abrupt("return",m.LR);case 52:return e.abrupt("return",0);case 53:case"end":return e.stop()}}),e,this)}))),function(e){return u.apply(this,arguments)})},{key:"readAVPacket",value:(n=(0,s.A)(l().mark((function e(t,r){var a,n,s,c,i,u,o,p,f,d,k;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.streams.find((function(e){return e.codecpar.codecType=1})),e.prev=1,n=t.ioReader.getPos(),0!==this.frameType){e.next=9;break}return e.next=6,t.ioReader.readBuffer(Math.min(1024,0|Number(this.fileSize-n&0xffffffffn)));case 6:s=e.sent,e.next=26;break;case 9:if(1!==this.frameType){e.next=26;break}return e.next=12,t.ioReader.readBuffer(7);case 12:if(c=e.sent,i=1&c[1],u=(3&c[3])<<11|c[4]<<3|(224&c[5])>>>5,o=3&c[6],f=u-(p=1===i?7:9),9!==p){e.next=21;break}return e.next=21,t.ioReader.skip(2);case 21:return d=(0,B.k)(BigInt(Math.floor(1024*(o+1)/a.codecpar.sampleRate*g.SF)),g.KR,a.timeBase),h.M[17](r+48,d),e.next=25,t.ioReader.readBuffer(f);case 25:s=e.sent;case 26:return k=(0,y.sY)(s.length),(0,R.lW)(k,s.length,s),(0,A.NX)(r,k,s.length),h.M[17](r+16,this.currentPts),h.M[17](r+8,this.currentPts),h.M[17](r+56,n),h.M[15](r+32,a.index),h.M[15](r+76,a.timeBase.den),h.M[15](r+72,a.timeBase.num),this.currentPts+=x.f[17](r+48),e.abrupt("return",0);case 38:return e.prev=38,e.t0=e.catch(1),-1048576!==t.ioReader.error&&b.z3(e.t0.message,z,193),e.abrupt("return",t.ioReader.error);case 42:case"end":return e.stop()}}),e,this,[[1,38]])}))),function(e,t){return n.apply(this,arguments)})},{key:"syncFrame",value:(a=(0,s.A)(l().mark((function e(t){var r,a,n,s,c,i,u;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=g.Dh,a=3;case 2:return e.prev=3,e.next=6,t.ioReader.peekUint16();case 6:if(e.t0=e.sent,4095!=e.t0>>>4){e.next=45;break}return r=t.ioReader.getPos(),e.next=12,t.ioReader.peekBuffer(7);case 12:if(n=e.sent,!((s=(3&n[3])<<11|n[4]<<3|(224&n[5])>>>5)>512e3)){e.next=18;break}return e.next=17,t.ioReader.skip(1);case 17:return e.abrupt("continue",2);case 18:return e.next=20,t.ioReader.skip(s);case 20:c=0;case 21:if(c!==a){e.next=24;break}return e.abrupt("break",43);case 24:return e.next=26,t.ioReader.peekUint16();case 26:if(e.t1=e.sent,4095!=e.t1>>>4){e.next=40;break}return c++,e.next=32,t.ioReader.peekBuffer(7);case 32:if(i=e.sent,!((u=(3&i[3])<<11|i[4]<<3|(224&i[5])>>>5)>512e3)){e.next=36;break}return e.abrupt("break",43);case 36:return e.next=38,t.ioReader.skip(u);case 38:e.next=41;break;case 40:return e.abrupt("break",43);case 41:e.next=21;break;case 43:if(c!==a){e.next=45;break}return e.abrupt("break",54);case 45:return e.next=47,t.ioReader.skip(1);case 47:e.next=52;break;case 49:return e.prev=49,e.t2=e.catch(3),e.abrupt("break",54);case 52:e.next=2;break;case 54:if(r===g.Dh){e.next=57;break}return e.next=57,t.ioReader.seek(r);case 57:case"end":return e.stop()}}),e,null,[[3,49]])}))),function(e){return a.apply(this,arguments)})},{key:"seek",value:(r=(0,s.A)(l().mark((function e(t,r,a,n){var s,c,i,u,o,p,f,d;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(1!==this.frameType){e.next=55;break}if(s=t.ioReader.getPos(),!(2&n)){e.next=18;break}return e.next=5,t.ioReader.fileSize();case 5:if(!((c=e.sent)<=BigInt(0))){e.next=8;break}return e.abrupt("return",BigInt(m.E$));case 8:return a<BigInt(0)?a=BigInt(0):a>c&&(a=c),e.next=11,t.ioReader.seek(a);case 11:if(4&n){e.next=15;break}return e.next=14,this.syncFrame(t);case 14:r.duration&&this.fileSize&&(this.currentPts=a/this.fileSize*r.duration);case 15:return e.abrupt("return",s);case 18:if(!r||!r.sampleIndexes.length){e.next=26;break}if(!((i=I.El(r.sampleIndexes,(function(e){return e.pts>a?-1:1})))>0&&(0,B.k)(a-r.sampleIndexes[i-1].pts,r.timeBase,g.i0)<BigInt(5e3))){e.next=26;break}return b.Yz("seek in sampleIndexes, found index: ".concat(i,", pts: ").concat(r.sampleIndexes[i-1].pts,", pos: ").concat(r.sampleIndexes[i-1].pos),z,296),e.next=24,t.ioReader.seek(r.sampleIndexes[i-1].pos);case 24:return this.currentPts=a,e.abrupt("return",s);case 26:if(b.Yz("not found any keyframe index, try to seek in bytes",z,303),!r.duration){e.next=54;break}return e.next=30,t.ioReader.seek(BigInt(0));case 30:u=BigInt(0);case 31:if(e.prev=32,!(u>=a)){e.next=36;break}return this.currentPts=u,e.abrupt("return",s);case 36:return e.next=38,t.ioReader.peekBuffer(7);case 38:return o=e.sent,p=(3&o[3])<<11|o[4]<<3|(224&o[5])>>>5,f=3&o[6],d=(0,B.k)(BigInt(Math.floor(1024*(f+1)/r.codecpar.sampleRate*g.SF)),g.KR,r.timeBase),u+=d,e.next=45,t.ioReader.skip(p);case 45:e.next=50;break;case 47:return e.prev=47,e.t0=e.catch(32),e.abrupt("return",BigInt(m.E$));case 50:e.next=31;break;case 52:e.next=55;break;case 54:case 55:return e.abrupt("return",BigInt(m.E$));case 56:case"end":return e.stop()}}),e,this,[[32,47]])}))),function(e,t,a,n){return r.apply(this,arguments)})},{key:"getAnalyzeStreamsCount",value:function(){return 1}}]),t}(v.A)},85947:(e,t,r)=>{r.d(t,{A:()=>c});var a=r(78716),n=r(81570),s=r(134),c=function(){function e(){(0,a.A)(this,e),(0,s.A)(this,"type",-1),(0,s.A)(this,"onStreamAdd",void 0)}return(0,n.A)(e,[{key:"destroy",value:function(e){}}]),e}()}}]);