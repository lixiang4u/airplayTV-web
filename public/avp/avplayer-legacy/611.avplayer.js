"use strict";(self.webpackChunkAVPlayer=self.webpackChunkAVPlayer||[]).push([[611],{85947:(e,t,n)=>{n.d(t,{A:()=>s});var r=n(78716),i=n(81570),a=n(134),s=function(){function e(){(0,r.A)(this,e),(0,a.A)(this,"type",-1),(0,a.A)(this,"onStreamAdd",void 0)}return(0,i.A)(e,[{key:"destroy",value:function(e){}}]),e}()},85611:(e,t,n)=>{n.r(t),n.d(t,{default:()=>R});var r=n(88435),i=n.n(r),a=n(25182),s=n(78716),u=n(81570),c=n(77193),o=n(25767),f=n(43070),p=n(31060),h=n(134),d=n(36443),l=n.n(d),x=n(50932),k=n(4624),g=n(9705),b=n(85947),m=n(14686),v=n(37837),B=n(71517),A=n(72739),I=n(50011),y=n(54825);function T(e,t,n){return t=(0,o.A)(t),(0,c.A)(e,w()?i()(t,n||[],(0,o.A)(e).constructor):t.apply(e,n))}function w(){try{var e=!Boolean.prototype.valueOf.call(i()(Boolean,[],(function(){})))}catch(e){}return(w=function(){return!!e})()}var q="src/avformat/formats/IWebVttFormat.ts",R=function(e){function t(){var e;return(0,s.A)(this,t),e=T(this,t),(0,h.A)((0,f.A)(e),"type",16),(0,h.A)((0,f.A)(e),"queue",void 0),(0,h.A)((0,f.A)(e),"index",void 0),e}var n,r,i,c;return(0,p.A)(t,e),(0,u.A)(t,[{key:"init",value:function(e){this.queue=[]}},{key:"readChunk",value:(c=(0,a.A)(l().mark((function e(t){var n,r,i;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n="",r=t.ioReader.getPos();case 2:return e.next=5,t.ioReader.readLine();case 5:if(""!==(i=e.sent)){e.next=8;break}return e.abrupt("break",11);case 8:n+=i+"\n",e.next=2;break;case 11:return e.abrupt("return",{chunk:n.trim(),pos:r});case 12:case"end":return e.stop()}}),e)}))),function(e){return c.apply(this,arguments)})},{key:"readHeader",value:(i=(0,a.A)(l().mark((function e(t){var n,r,i,a,s,u,c=this;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.ioReader.peekBuffer(3);case 2:if(239!==(n=e.sent)[0]||187!==n[1]||191!==n[2]){e.next=6;break}return e.next=6,t.ioReader.skip(3);case 6:return e.next=8,t.ioReader.peekString(6);case 8:if("WEBVTT"===e.sent){e.next=12;break}return k.z3("the file format is not vtt",q,89),e.abrupt("return",g.LR);case 12:return(r=t.createStream()).codecpar.codecId=94226,r.codecpar.codecType=3,r.timeBase.den=1e3,r.timeBase.num=1,e.next=19,t.ioReader.readLine();case 19:(i=e.sent).indexOf("-")>0&&(r.metadata.title=i.split("-").pop().trim()),this.index=0,a=[],s=BigInt(0),e.prev=24,u=l().mark((function e(){var n,i,u,o,f,p,h,d,x,k,g;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.readChunk(t);case 2:if(n=e.sent,i=n.chunk,u=n.pos,""!==i&&!/^NOTE/.test(i)){e.next=7;break}return e.abrupt("return",0);case 7:if(/^STYLE/.test(i)&&a.push({style:i.replace(/STYLE[\s|\n]?/,""),pos:u}),-1===(o=i.split("\n"))[0].indexOf("--\x3e")&&(f=o.shift().trim()),h=o.shift().split("--\x3e"),d=(0,y.j)(h.shift()),h=h.shift().trim().split(" "),!((x=(0,y.j)(h.shift()))<=d)){e.next=16;break}return e.abrupt("return",0);case 16:if((h=h.filter((function(e){return""!==e}))).length&&(p=h.join(" ")),k=o.join("\n").trim()){e.next=21;break}return e.abrupt("return",0);case 21:r.nbFrames++,r.duration=x,g={identifier:f,options:p,context:k,startTs:d,endTs:x,pos:u},d>=s?(c.queue.push(g),s=d):A._(c.queue,g,(function(e){return e.startTs<g.startTs?1:-1}));case 25:case"end":return e.stop()}}),e)}));case 26:return e.delegateYield(u(),"t0",28);case 28:if(0!==e.t0){e.next=31;break}return e.abrupt("continue",26);case 31:e.next=26;break;case 33:e.next=39;break;case 35:return e.prev=35,e.t1=e.catch(24),r.metadata.styles=a,e.abrupt("return",0);case 39:case"end":return e.stop()}}),e,this,[[24,35]])}))),function(e){return i.apply(this,arguments)})},{key:"readAVPacket",value:(r=(0,a.A)(l().mark((function e(t,n){var r,i,a,s,u,c,o,f;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.queue.length){e.next=2;break}return e.abrupt("return",g.LR);case 2:if(!(this.index>=this.queue.length)){e.next=4;break}return e.abrupt("return",-1048576);case 4:return r=t.streams.find((function(e){return 3===e.codecpar.codecType})),i=this.queue[this.index++],x.M[15](n+32,r.index),x.M[15](n+76,r.timeBase.den),x.M[15](n+72,r.timeBase.num),x.M[17](n+16,i.startTs),x.M[17](n+8,i.startTs),x.M[17](n+48,i.endTs-i.startTs),i.identifier&&(a=I.encode(i.identifier),s=(0,v.sY)(a.length),(0,m.lW)(s,a.length,a),(0,B.Ow)(n,16,s,a.length)),i.options&&(u=I.encode(i.options),c=(0,v.sY)(u.length),(0,m.lW)(c,u.length,u),(0,B.Ow)(n,17,c,u.length)),o=I.encode(i.context),f=(0,v.sY)(o.length),(0,m.lW)(f,o.length,o),(0,B.NX)(n,f,o.length),e.abrupt("return",0);case 18:case"end":return e.stop()}}),e,this)}))),function(e,t){return r.apply(this,arguments)})},{key:"seek",value:(n=(0,a.A)(l().mark((function e(t,n,r,i){var a;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(2&i)){e.next=2;break}return e.abrupt("return",BigInt(g.E$));case 2:if(!(r<=BigInt(0))){e.next=5;break}return this.index=0,e.abrupt("return",BigInt(0));case 5:if(!((a=A.El(this.queue,(function(e){return e.startTs>r?-1:1})))>=0)){e.next=18;break}k.Yz("seek in cues, found index: ".concat(a,", pts: ").concat(this.queue[a].startTs,", pos: ").concat(this.queue[a].pos),q,256),this.index=Math.max(a-1,0);case 9:if(!(this.index>0)){e.next=17;break}if(!(this.queue[this.index-1].startTs===this.queue[this.index].startTs||this.queue[this.index-1].endTs>r)){e.next=14;break}this.index--,e.next=15;break;case 14:return e.abrupt("break",17);case 15:e.next=9;break;case 17:return e.abrupt("return",BigInt(0));case 18:return e.abrupt("return",BigInt(g.LR));case 19:case"end":return e.stop()}}),e,this)}))),function(e,t,r,i){return n.apply(this,arguments)})},{key:"getAnalyzeStreamsCount",value:function(){return 1}}]),t}(b.A)},54825:(e,t,n)=>{function r(e){if(!(e=e.trim()))return-BigInt(1);var t=e.split(":"),n=BigInt(0);return 3===t.length&&(n+=BigInt(+t.shift().trim())*BigInt(36e5)),n+=BigInt(+t.shift().trim())*BigInt(6e4),t=t.shift().trim().split("."),(n+=BigInt(+t.shift().trim())*BigInt(1e3))+BigInt(+t.shift().trim())}function i(e){if(!(e=e.trim()))return-BigInt(1);var t=e.split(":"),n=BigInt(0);return 3===t.length&&(n+=BigInt(+t.shift().trim())*BigInt(36e5)),n+=BigInt(+t.shift().trim())*BigInt(6e4),t=t.shift().trim().split(","),(n+=BigInt(+t.shift().trim())*BigInt(1e3))+BigInt(+t.shift().trim())}n.d(t,{j:()=>r,t:()=>i})}}]);