(self.webpackChunkAVPlayer=self.webpackChunkAVPlayer||[]).push([[344],{47344:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>E});var n=r(88435),a=r.n(n),s=r(25182),i=r(78716),c=r(81570),u=r(77193),o=r(25767),l=r(43070),f=r(31060),d=r(134),p=r(36443),h=r.n(p),m=r(50932),g=r(4624),b=r(9705),v=r(85947),x=r(14686),k=r(37837),A=r(71517),y=r(72739),w=r(50011),B=r(51785);function I(t,e,r){return e=(0,o.A)(e),(0,u.A)(t,T()?a()(e,r||[],(0,o.A)(t).constructor):e.apply(t,r))}function T(){try{var t=!Boolean.prototype.valueOf.call(a()(Boolean,[],(function(){})))}catch(t){}return(T=function(){return!!t})()}var M="src/avformat/formats/IAssFormat.ts",E=function(t){function e(){var t;return(0,i.A)(this,e),t=I(this,e),(0,d.A)((0,l.A)(t),"type",17),(0,d.A)((0,l.A)(t),"queue",void 0),(0,d.A)((0,l.A)(t),"index",void 0),t}var r,n,a;return(0,f.A)(e,t),(0,c.A)(e,[{key:"init",value:function(t){this.queue=[]}},{key:"readHeader",value:(a=(0,s.A)(h().mark((function t(e){var r,n,a,s,i,c,u,o,l,f,d,p,m=this;return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.ioReader.readLine();case 2:if("[Script Info]"===(r=t.sent).trim()){t.next=6;break}return g.z3("the file format is not ass",M,68),t.abrupt("return",b.LR);case 6:(n=e.createStream()).codecpar.codecId=94230,n.codecpar.codecType=3,n.timeBase.den=1e3,n.timeBase.num=1,a=r+"\n",s=!1,c=0,u=0;case 15:return t.next=18,e.ioReader.readLine();case 18:if(o=t.sent,!/^;/.test(o)){t.next=21;break}return t.abrupt("continue",15);case 21:if("[Events]"===o.trim()&&(s=!0),!/^Format:/.test(o)||!s){t.next=27;break}for(a+=o,i=B.Bp(o.trim()),l=0;l<i.length;l++)"Start"===i[l]?c=l:"End"===i[l]&&(u=l);return t.abrupt("break",30);case 27:a+=o+"\n",t.next=15;break;case 30:f=w.encode(a),n.codecpar.extradata=(0,k.sY)(f.length),n.codecpar.extradataSize=f.length,(0,x.lW)(n.codecpar.extradata,f.length,f),this.index=0,d=BigInt(0),t.prev=36,p=h().mark((function t(){var r,a,s,o,l,f;return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.ioReader.getPos(),t.next=3,e.ioReader.readLine();case 3:if(a=t.sent.trim(),!/^;/.test(a)&&!/^Comment:/.test(a)){t.next=6;break}return t.abrupt("return",1);case 6:s=B.Ew(i,a,c,u),o=s.start,l=s.end,n.nbFrames++,n.duration=l,f={context:a,startTs:o,endTs:l,pos:r},o>=d?(m.queue.push(f),d=o):y._(m.queue,f,(function(t){return t.startTs<f.startTs?1:-1}));case 11:case"end":return t.stop()}}),t)}));case 38:return t.delegateYield(p(),"t0",40);case 40:if(!t.t0){t.next=42;break}return t.abrupt("continue",38);case 42:t.next=38;break;case 44:t.next=49;break;case 46:return t.prev=46,t.t1=t.catch(36),t.abrupt("return",0);case 49:case"end":return t.stop()}}),t,this,[[36,46]])}))),function(t){return a.apply(this,arguments)})},{key:"readAVPacket",value:(n=(0,s.A)(h().mark((function t(e,r){var n,a,s,i;return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.queue.length){t.next=2;break}return t.abrupt("return",b.LR);case 2:if(!(this.index>=this.queue.length)){t.next=4;break}return t.abrupt("return",-1048576);case 4:return n=e.streams.find((function(t){return 3===t.codecpar.codecType})),a=this.queue[this.index++],m.M[15](r+32,n.index),m.M[15](r+76,n.timeBase.den),m.M[15](r+72,n.timeBase.num),m.M[17](r+16,a.startTs),m.M[17](r+8,a.startTs),m.M[17](r+48,a.endTs-a.startTs),s=w.encode(a.context),i=(0,k.sY)(s.length),(0,x.lW)(i,s.length,s),(0,A.NX)(r,i,s.length),t.abrupt("return",0);case 16:case"end":return t.stop()}}),t,this)}))),function(t,e){return n.apply(this,arguments)})},{key:"seek",value:(r=(0,s.A)(h().mark((function t(e,r,n,a){var s;return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(2&a)){t.next=2;break}return t.abrupt("return",BigInt(b.E$));case 2:if(!(n<=BigInt(0))){t.next=5;break}return this.index=0,t.abrupt("return",BigInt(0));case 5:if(!((s=y.El(this.queue,(function(t){return t.startTs>n?-1:1})))>=0)){t.next=18;break}g.Yz("seek in cues, found index: ".concat(s,", pts: ").concat(this.queue[s].startTs,", pos: ").concat(this.queue[s].pos),M,217),this.index=Math.max(s-1,0);case 9:if(!(this.index>0)){t.next=17;break}if(this.queue[this.index-1].startTs!==this.queue[this.index].startTs){t.next=14;break}this.index--,t.next=15;break;case 14:return t.abrupt("break",17);case 15:t.next=9;break;case 17:return t.abrupt("return",BigInt(0));case 18:return t.abrupt("return",BigInt(b.LR));case 19:case"end":return t.stop()}}),t,this)}))),function(t,e,n,a){return r.apply(this,arguments)})},{key:"getAnalyzeStreamsCount",value:function(){return 1}}]),e}(v.A)},85947:(t,e,r)=>{"use strict";r.d(e,{A:()=>i});var n=r(78716),a=r(81570),s=r(134),i=function(){function t(){(0,n.A)(this,t),(0,s.A)(this,"type",-1),(0,s.A)(this,"onStreamAdd",void 0)}return(0,a.A)(t,[{key:"destroy",value:function(t){}}]),t}()},5028:(t,e,r)=>{"use strict";r.d(e,{Q:()=>n});var n=["ReadOrder","Layer","Start","End","Style","Name","MarginL","MarginR","MarginV","Effect","Text"]},51785:(t,e,r)=>{"use strict";r.d(e,{Bp:()=>l,Ew:()=>d,wj:()=>p});var n=r(6550),a=(r(7210),r(4624)),s=r(5028),i=r(54825),c=r(44453),u=r(93935),o="src/avformat/formats/ass/iass.ts";function l(t){return function(t,e){for(var r=e.match(/Format\s*:\s*(.*)/i)[1].split(/\s*,\s*/),n=[],s=function(e){var s=t.find((function(t){return t.toLowerCase()===r[e].toLowerCase()}));s||a.R8("not support ass field(".concat(r[e],")"),o,40),n.push(s||r[e])},i=0;i<r.length;i++)s(i);return n}(s.Q,t)}function f(t,e){var r=e.split(",");if(r.length>t.length){var n=r.slice(t.length-1).join(",");(r=r.slice(0,t.length-1)).push(n)}return r}function d(t,e,r,a){var s=e.match(/^(\w+?)\s*:\s*(.*)/i),c=f(t,(0,n.A)(s,3)[2]);return{start:(0,i.j)(c[r]),end:(0,i.j)(c[a])}}function p(t,e){var r=e.match(/^(\w+?)\s*:\s*(.*)/i),a=(0,n.A)(r,3),s=a[1],o=a[2],l=0;switch(s){case"Comment":l=2;break;case"Dialogue":l=1;break;case"Command":l=6;break;case"Movie":l=5;break;case"Picture":l=3;break;case"Sound":l=4}for(var d=f(t,o),p={type:l},h=0;h<d.length;h++){p[t[h]]=d[h];var m=t[h],g=d[h].trim();switch(m){case"Layer":case"MarginL":case"MarginR":case"MarginV":p[m]=+g;break;case"Start":case"End":p[m]=(0,i.j)(g);break;case"Effect":p[m]=(0,c.d)(g);break;case"Text":p[m]=(0,u.r)(g);break;default:p[m]=g}}return p}},54825:(t,e,r)=>{"use strict";function n(t){if(!(t=t.trim()))return-BigInt(1);var e=t.split(":"),r=BigInt(0);return 3===e.length&&(r+=BigInt(+e.shift().trim())*BigInt(36e5)),r+=BigInt(+e.shift().trim())*BigInt(6e4),e=e.shift().trim().split("."),(r+=BigInt(+e.shift().trim())*BigInt(1e3))+BigInt(+e.shift().trim())}function a(t){if(!(t=t.trim()))return-BigInt(1);var e=t.split(":"),r=BigInt(0);return 3===e.length&&(r+=BigInt(+e.shift().trim())*BigInt(36e5)),r+=BigInt(+e.shift().trim())*BigInt(6e4),e=e.shift().trim().split(","),(r+=BigInt(+e.shift().trim())*BigInt(1e3))+BigInt(+e.shift().trim())}r.d(e,{j:()=>n,t:()=>a})},11837:(t,e,r)=>{r(21489),t.exports=r(46438).Number.isNaN},21489:(t,e,r)=>{var n=r(88535);n(n.S,"Number",{isNaN:function(t){return t!=t}})},7210:(t,e,r)=>{t.exports=r(11837)},27880:(t,e,r)=>{"use strict";function n(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}r.d(e,{A:()=>n})},12812:(t,e,r)=>{"use strict";r.d(e,{A:()=>a});var n=r(37149);function a(t){if(n(t))return t}},92503:(t,e,r)=>{"use strict";r.d(e,{A:()=>s});var n=r(16560),a=r(54220);function s(t,e){var r=null==t?null:void 0!==n&&t[a]||t["@@iterator"];if(null!=r){var s,i,c,u,o=[],l=!0,f=!1;try{if(c=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;l=!1}else for(;!(l=(s=c.call(r)).done)&&(o.push(s.value),o.length!==e);l=!0);}catch(t){f=!0,i=t}finally{try{if(!l&&null!=r.return&&(u=r.return(),Object(u)!==u))return}finally{if(f)throw i}}return o}}},82297:(t,e,r)=>{"use strict";function n(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}r.d(e,{A:()=>n})},6550:(t,e,r)=>{"use strict";r.d(e,{A:()=>c});var n=r(12812),a=r(92503),s=r(60773),i=r(82297);function c(t,e){return(0,n.A)(t)||(0,a.A)(t,e)||(0,s.A)(t,e)||(0,i.A)()}},60773:(t,e,r)=>{"use strict";r.d(e,{A:()=>s});var n=r(74385),a=r(27880);function s(t,e){if(t){if("string"==typeof t)return(0,a.A)(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?n(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?(0,a.A)(t,e):void 0}}},74672:(t,e,r)=>{"use strict";function n(t){return t?t.toLowerCase().replace(/([+-]?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?)/g," $1 ").replace(/([mnlbspc])/g," $1 ").trim().replace(/\s+/g," ").split(/\s(?=[mnlbspc])/).map((t=>t.split(" ").filter(((t,e)=>!(e&&Number.isNaN(1*t)))))):[]}r.d(e,{O:()=>n})},44453:(t,e,r)=>{"use strict";function n(t){const e=t.toLowerCase().trim().split(/\s*;\s*/);return"banner"===e[0]?{name:e[0],delay:1*e[1]||0,leftToRight:1*e[2]||0,fadeAwayWidth:1*e[3]||0}:/^scroll\s/.test(e[0])?{name:e[0],y1:Math.min(1*e[1],1*e[2]),y2:Math.max(1*e[1],1*e[2]),delay:1*e[3]||0,fadeAwayHeight:1*e[4]||0}:""!==t?{name:t}:null}r.d(e,{d:()=>n})},53534:(t,e,r)=>{"use strict";r.d(e,{E:()=>s});var n=r(74672);const a=["b","i","u","s","fsp","k","K","kf","ko","kt","fe","q","p","pbo","a","an","fscx","fscy","fax","fay","frx","fry","frz","fr","be","blur","bord","xbord","ybord","shad","xshad","yshad"].map((t=>({name:t,regex:new RegExp(`^${t}-?\\d`)})));function s(t){const e={};for(let r=0;r<a.length;r++){const{name:n,regex:s}=a[r];if(s.test(t))return e[n]=1*t.slice(n.length),e}if(/^fn/.test(t))e.fn=t.slice(2);else if(/^r/.test(t))e.r=t.slice(1);else if(/^fs[\d+-]/.test(t))e.fs=t.slice(2);else if(/^\d?c&?H?[0-9a-fA-F]+|^\d?c$/.test(t)){const[,r,n]=t.match(/^(\d?)c&?H?(\w*)/);e[`c${r||1}`]=n&&`000000${n}`.slice(-6)}else if(/^\da&?H?[0-9a-fA-F]+/.test(t)){const[,r,n]=t.match(/^(\d)a&?H?([0-9a-f]+)/i);e[`a${r}`]=`00${n}`.slice(-2)}else if(/^alpha&?H?[0-9a-fA-F]+/.test(t))[,e.alpha]=t.match(/^alpha&?H?([0-9a-f]+)/i),e.alpha=`00${e.alpha}`.slice(-2);else if(/^(?:pos|org|move|fad|fade)\([^)]+/.test(t)){const[,r,n]=t.match(/^(\w+)\((.*?)\)?$/);e[r]=n.trim().split(/\s*,\s*/).map(Number)}else if(/^i?clip\([^)]+/.test(t)){const r=t.match(/^i?clip\((.*?)\)?$/)[1].trim().split(/\s*,\s*/);e.clip={inverse:/iclip/.test(t),scale:1,drawing:null,dots:null},1===r.length&&(e.clip.drawing=(0,n.O)(r[0])),2===r.length&&(e.clip.scale=1*r[0],e.clip.drawing=(0,n.O)(r[1])),4===r.length&&(e.clip.dots=r.map(Number))}else if(/^t\(/.test(t)){const r=t.match(/^t\((.*?)\)?$/)[1].trim().replace(/\\.*/,(t=>t.replace(/,/g,"\n"))).split(/\s*,\s*/);if(!r[0])return e;e.t={t1:0,t2:0,accel:1,tags:r[r.length-1].replace(/\n/g,",").split("\\").slice(1).map(s)},2===r.length&&(e.t.accel=1*r[0]),3===r.length&&(e.t.t1=1*r[0],e.t.t2=1*r[1]),4===r.length&&(e.t.t1=1*r[0],e.t.t2=1*r[1],e.t.accel=1*r[2])}return e}},27637:(t,e,r)=>{"use strict";r.d(e,{r:()=>a});var n=r(53534);function a(t){const e=[];let r=0,a="";const s=t.split("\\").slice(1).concat("").join("\\");for(let t=0;t<s.length;t++){const n=s[t];"("===n&&r++,")"===n&&r--,r<0&&(r=0),r||"\\"!==n?a+=n:(a&&e.push(a),a="")}return e.map(n.E)}},93935:(t,e,r)=>{"use strict";r.d(e,{r:()=>s});var n=r(74672),a=r(27637);function s(t){const e=t.split(/{([^{}]*?)}/),r=[];e[0].length&&r.push({tags:[],text:e[0],drawing:[]});for(let t=1;t<e.length;t+=2){const s=(0,a.r)(e[t]),i=s.reduce(((t,e)=>void 0===e.p?t:!!e.p),!1);r.push({tags:s,text:i?"":e[t+1],drawing:i?(0,n.O)(e[t+1]):[]})}return{raw:t,combined:r.map((t=>t.text)).join(""),parsed:r}}}}]);